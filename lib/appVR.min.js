!function(){"use strict";function e(e){let t=atob(e).split("").map(function(e){return e.charCodeAt(0)}),r=new Uint8Array(t),i=pako.inflate(r),n=String.fromCharCode.apply(null,new Uint16Array(i));return JSON.parse(n)}window.parseUserData=function(e,t){let r=new XMLHttpRequest;return r.open("GET",e,!0),r.responseType="json",r.onload=function(e){for(var t in r.response.data?window.file=r.response.data:window.file=r.response,window.file.scene_objs_v2)for(var i in window.file.scene_objs_v2[t].transform){var n=window.file.scene_objs_v2[t].transform[i].split(",");if(3!=n.length)return-1;var o=[parseFloat(n[0]),parseFloat(n[1]),parseFloat(n[2])];window.file.scene_objs_v2[t].transform[i]=o}return window.file},r.send(),r.response},window.getARProjsByUserID=function(t,r,i){if(!t)return-1;r||(r="makarvr");let n=new XMLHttpRequest,o={user_id:r,cid:"20"};if("3.0.0"==serverVersion&&(console.log("%cnetWorkAgent.js: getARProjsByUserID: you shoudnt see this, Fei abandon this function in server V3","color:red"),getResByUserID(t,r,"","",function(){console.log("netWorkAgent.js: getARProjsByUserID: getResByUserID: callback");let e=t+"get_ar_projs",r={ver:"3.0.0",cid:5,data:o},a=JSON.stringify(r);n.open("POST",e,!0),n.setRequestHeader("Content-Type","application/json"),n.responseType="json",n.onload=function(e){let t;console.log("networkAgent.js: getARProjsByUserID,  onload xhr.response = ",n.response),n.response.error?(i&&i(n.response.error),console.log("networkAgent.js: getARProjsByUserID: oops something wrong:",n.response.error)):n.response.data?(t=n.response.data,window.userARData,window.userARData=t,i&&i(t)):i&&i("networkAgent.js:error: no xhr.response.data")},n.send(a)})),"2.0.0"==serverVersion){let r=JSON.stringify(o),a=new FormData;a.append("cmd","get_ar_projs"),a.append("data",r),n.open("POST",t,!0),n.responseType="json",n.onload=function(t){let r;if(console.log("networkAgent.js:getARProjsByUserID:",n.response),n.response.diaoyurar){let t=e(n.response.diaoyurar);t.error?(i&&i(t.error),console.log("networkAgent.js: getARProjsByUserID: oops something wrong:",t.error)):t.data?(r=t.data,window.userARData?(console.log("networkAgent.js: getARProjsByUserID: window.userARData already exist, replace it.."),window.userARData=r):window.userARData=r,i&&i(r)):i&&i("networkAgent.js:error: no jsonData.data")}else n.response.error?(i&&i(n.response.error),console.log("networkAgent.js: getARProjsByUserID: oops something wrong:",n.response.error)):n.response.data?(r=n.response.data,window.userARData,window.userARData=r,i&&i(r)):i&&i("networkAgent.js:error: no xhr.response.data")},n.send(a)}},window.getUserPublishProjsByUserID=function(e,t,r,i,n){if(!e)return-1;t||(t="makarvr"),r||(r=""),i||(i="");let o=new XMLHttpRequest,a={user_id:t};"3.0.0"==serverVersion&&getResByUserID(e,t,r,i,function(t){let r=e+"get_usr_publish_projs",i={ver:"3.0.0",cid:5,data:a},s=JSON.stringify(i);o.open("POST",r,!0),o.setRequestHeader("Content-Type","application/json"),o.responseType="json",o.onload=function(e){let r;o.response.error?(n&&n(o.response.error),console.log("%cnetworkAgent.js: _getUserPublishProjs: oops something wrong: ","color:red",o.response.error)):o.response.data?(r=o.response.data,window.userPublishProjs,window.userPublishProjs=r,n&&n(r,t)):n&&n("networkAgent.js:error: no xhr.response.data")},o.send(s)})},window.getNewestPublishProjs=function(e,t,r){if(!e)return-1;t||(t="ar");let i=new XMLHttpRequest;if("3.0.0"==serverVersion){let r=e+"get_newest_publish_projs",n={ver:"3.0.0",cid:5,data:{proj_type:t}},o=JSON.stringify(n);i.open("POST",r,!0),i.setRequestHeader("Content-Type","application/json"),i.responseType="json",i.onload=function(e){console.log("networkAgent.js: getNewestPublishProjs,  onload xhr.response = ",i.response)},console.log("networkAgent.js: getNewestPublishProjs, jsonReq=",o),i.send(o)}},window.getResByUserID=function(e,r,i,n,o){r||(r="fefe"),i||(i=""),n||(n="");let a=e+"get_res",s=new XMLHttpRequest,l={ver:"3.0.0",cid:5,data:{user_id:r,main_type:i,sub_type:n}},c=JSON.stringify(l);s.open("POST",a,!0),s.setRequestHeader("Content-Type","application/json"),s.responseType="json",s.onload=function(e){s.response.error?console.log("%cnetworkAgent: _getResByUserID,  onload error ","color:red",s.response):(console.log("%cnetworkAgent: _getResByUserID,  onload save ","color:blue",s.response.data.list),s.response.data.list.length>0?t(s.response.data.list,function(e){o&&o(e)}):o&&(console.log("networkAgent: _getResByUserID,  onload  use res is empty "),o("use res is empty")))},s.send(c)};var t=function(e,t){if(!e)return-1;let r={};for(let i=0;i<e.length;i++)r[e[i].res_id]=e[i],i==e.length-1&&(console.log("netWorkAgent.js: createProjResDictFromResList: i == userARResList.length, callback",i,e.length),t&&t(r))};window.getVRSceneByUserID=function(e,t,r){if(!e)return-1;t||(t="makarvr");let n=[];if(n.user_id=t,"3.0.0"==serverVersion){var o=function(t,o){if(console.log("networkAgent.js: getVRSceneByUserID: getUserPublishProjsByUserID: userPublishProjs=",t),"string"!=typeof t){let a=[];for(let e in t.proj_list)"vr"==t.proj_list[e].proj_type&&a.push(t.proj_list[e].proj_id);let s=new XMLHttpRequest,l=e+"get_vr_projs_by_proj_id",c={ver:"3.0.0",cid:5,data:{proj_id_list:a}},u=JSON.stringify(c);s.open("POST",l,!0),s.setRequestHeader("Content-Type","application/json"),s.responseType="json",s.onload=function(t){let a=s.response.data;window.publishVRProjs=a;let l=0;if(a.result&&a.result.length)for(let t=0;t<a.result.length;t++){let s=new XMLHttpRequest,c={user_id:a.result[t].user_id,proj_id:a.result[t].proj_id},u=e+"get_vr_proj_scene",d={ver:"3.0.0",cid:5,data:c},h=JSON.stringify(d);s.open("POST",u,!0),s.setRequestHeader("Content-Type","application/json"),s.responseType="json",s.onload=function(e){l++,n[t]=s.response.data;for(let e=0;e<n[t].scenes.length;e++)if(n[t].scenes[e].scene_objs)for(let r=0;r<n[t].scenes[e].scene_objs.length;r++){let a=n[t].scenes[e].scene_objs[r],s=a.res_id;""==a.res_id?"camera"==a.main_type&&"VR Camera"==a.res_name&&"VRcamera"==a.sub_type||console.log("networkAgentVR.js: _getVRSceneByUserID: _getUSerPublishProjs: res error: ",a,i,t,e):o[s]&&(o[s].res_url==a.res_url||console.log("%cnetworkAgentVR.js: _getVRSceneByUserID: _getUSerPublishProjs: publish.res_url different as res.url, replace it","color:red",i,t,e),"model"==o[s].main_type&&o[s].res_url_fbx&&(a.res_url_fbx=o[s].res_url_fbx))}l==a.result.length&&(window.VRSceneResult=n,window.userProjResDict=o,r&&r(n))},s.send(h)}},s.send(u)}};getPayInfoByUserID(e,t,function(i){let n,a,s,l;!function(e,t){var r,i=new XMLHttpRequest;i.open("GET",e,!0),i.onreadystatechange=function(){if(4===i.readyState&&(200===i.status||0==i.status)){let e=i.responseText;r=e,t&&t(r)}},i.send(null)}("https://s3-ap-northeast-1.amazonaws.com/makar.webar.defaultobject/web_white_list/webVR_UserID_WhiteList.txt",function(c){let u=JSON.parse(c).customizedUserID.list,d=[];for(let e=0;e<u.length;e++)d.push(u[e].name);let h=d.indexOf(t)>-1;if(i.data)switch(i.data.user_type){case"free":if(console.log("networkAgent.js:_getARSceneByUserID:_getPayInfoByUserID: user_type(free)=",i.data),h){getUserPublishProjsByUserID(e,t,"","",o);break}r&&r("this ID is free user, now allow for using webAR ");break;case"proA":if(console.log("networkAgent.js:_getARSceneByUserID:_getPayInfoByUserID: user_type(proA)=",i.data),h){getUserPublishProjsByUserID(e,t,"","",o);break}if((n=i.data.user_type_expire_date)&&(a=n.split(" ")[0])&&(s=a.split("-"))&&3==s.length){var f=((l=new Date(s))-new Date([2020,9,26]))/1e3/60/60/24;if(console.log("networkAgent.js:_getARSceneByUserID:_getPayInfoByUserID: expire_date_ymd_arr=",s,l),console.log("networkAgent.js:_getARSceneByUserID:_getPayInfoByUserID: diffDays=",f),f>1){getUserPublishProjsByUserID(e,t,"","",o);break}r&&r("this ID is unpaid user, now allow for using webAR ");break}r&&r("this ID is unpaid user, now allow for using webAR. ");break;case"proB":case"proC":case"custom":console.log("networkAgent.js:_getARSceneByUserID:_getPayInfoByUserID: user_type(custom/proB/proC)=",i.data),getUserPublishProjsByUserID(e,t,"","",o);break;default:console.log("networkAgent.js:_getARSceneByUserID:_getPayInfoByUserID: user_type(default)=",i.data),r&&r("this ID is not MAKAR user ")}else console.log("networkAgent.js:_getARSceneByUserID:_getPayInfoByUserID: error, userPayInfo=",i),r&&r("this ID have some problem ")})})}},window.getPayInfoByUserID=function(e,t,r){if(!e)return-1;if(!t)return-1;let i=e+"get_pay_info",n=new XMLHttpRequest,o={ver:"3.0.0",cid:5,data:{user_id:t}},a=JSON.stringify(o);n.open("POST",i,!0),n.setRequestHeader("Content-Type","application/json"),n.responseType="json",n.onload=function(e){r&&r(n.response)},n.send(a)},window.getVRDataByUserID=function(t,r,i){if(!t)return-1;r||(r="makarvr");let n=new XMLHttpRequest,o={user_id:r,cid:"20"},a=JSON.stringify(o),s=new FormData;s.append("cmd","get_vr_projs"),s.append("data",a),n.open("POST",t,!0),n.responseType="json",n.onload=function(t){let r;if(n.response.diaoyurar){let t=e(n.response.diaoyurar);t.error?(i&&i(t.error),console.log("networkAgent.js: getVRDataByUserID: oops something wrong:",t.error)):t.data?(r=t.data,window.userVRData?(console.log("networkAgent.js: getVRDataByUserID: window.userARData already exist, replace it.."),window.userVRData=r):(console.log("networkAgent.js: getVRDataByUserID: save window.userARData "),window.userVRData=r),i&&i(r)):i&&i("networkAgent.js:getVRDataByUserID:error: no jsonData.data")}else n.response.error?(i&&i(n.response.error),console.log("networkAgent.js: getVRDataByUserID: oops something wrong:",n.response.error)):n.response.data?(r=n.response.data).proj_list?(window.userVRData?(console.log("networkAgent.js: getVRDataByUserID: window.userARData already exist, replace it.."),window.userVRData=r):(console.log("networkAgent.js: getVRDataByUserID: save window.userARData =",r),window.userVRData=r),i&&i(r)):(console.log("%cnetworkAgent.js:getVRDataByUserID: onload, fail userVRData.proj_list is empty","color:red"),i&&i("the userVRData.proj_list is empty")):i&&i("networkAgent.js:getVRDataByUserID:error: no xhr.response.data")},n.send(s)},window.uploadDataToServer=function(e,t,r){if(!e)return-1;let i=new XMLHttpRequest,n={user_id:userARData.user_id,target_id:userARData.proj_list[t].target_id};if("3.0.0"==serverVersion){let t=e+"add_scan_times",r={ver:"3.0.0",cid:5,data:n},o=JSON.stringify(r);i.open("POST",t,!0),i.setRequestHeader("Content-Type","application/json"),i.responseType="json",i.onload=function(e){},i.send(o)}if("2.0.0"==serverVersion){let t=JSON.stringify(n),r=new FormData;r.append("cmd","add_scan_times"),r.append("data",t),i.open("POST",e,!0),i.responseType="json",i.onload=function(e){console.log("networkAgent: uploadDataToServer, xhr = ",i.response.data)},i.send(r)}},window.testPOST=function(e,t){let r=new XMLHttpRequest,i={ver:"3.0.0",cid:5,data:{user_id:"fefe"},length:8},n=JSON.stringify(i);console.log(" jsonReq ",n);let o=new FormData;o.append("cmd","add_scan_times"),o.append("data",n),r.open("POST","http://60.250.125.146:8081/Makar/get_usr_publish_projs",!0),r.setRequestHeader("Content-Type","application/json"),r.responseType="json",r.onload=function(e){console.log("networkAgent: testPOST,  onload xhr = ",r,r.response)},r.send(n)}}();var key,Module=void 0!==Module?Module:{},moduleOverrides={};for(key in Module)Module.hasOwnProperty(key)&&(moduleOverrides[key]=Module[key]);Module.arguments=[],Module.thisProgram="./this.program",Module.quit=function(e,t){throw t},Module.preRun=[],Module.postRun=[];var nodeFS,nodePath,ENVIRONMENT_IS_WEB=!1,ENVIRONMENT_IS_WORKER=!1,ENVIRONMENT_IS_NODE=!1,ENVIRONMENT_IS_SHELL=!1;if(Module.ENVIRONMENT)if("WEB"===Module.ENVIRONMENT)ENVIRONMENT_IS_WEB=!0;else if("WORKER"===Module.ENVIRONMENT)ENVIRONMENT_IS_WORKER=!0;else if("NODE"===Module.ENVIRONMENT)ENVIRONMENT_IS_NODE=!0;else{if("SHELL"!==Module.ENVIRONMENT)throw new Error("Module['ENVIRONMENT'] value is not valid. must be one of: WEB|WORKER|NODE|SHELL.");ENVIRONMENT_IS_SHELL=!0}else ENVIRONMENT_IS_WEB="object"==typeof window,ENVIRONMENT_IS_WORKER="function"==typeof importScripts,ENVIRONMENT_IS_NODE="object"==typeof process&&"function"==typeof require&&!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_WORKER,ENVIRONMENT_IS_SHELL=!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_NODE&&!ENVIRONMENT_IS_WORKER;for(key in ENVIRONMENT_IS_NODE?(Module.read=function(e,t){var r;return(r=tryParseAsDataURI(e))||(nodeFS||(nodeFS=require("fs")),nodePath||(nodePath=require("path")),e=nodePath.normalize(e),r=nodeFS.readFileSync(e)),t?r:r.toString()},Module.readBinary=function(e){var t=Module.read(e,!0);return t.buffer||(t=new Uint8Array(t)),assert(t.buffer),t},process.argv.length>1&&(Module.thisProgram=process.argv[1].replace(/\\/g,"/")),Module.arguments=process.argv.slice(2),"undefined"!=typeof module&&(module.exports=Module),process.on("uncaughtException",function(e){if(!(e instanceof ExitStatus))throw e}),process.on("unhandledRejection",function(e,t){process.exit(1)}),Module.inspect=function(){return"[Emscripten Module object]"}):ENVIRONMENT_IS_SHELL?("undefined"!=typeof read&&(Module.read=function(e){var t=tryParseAsDataURI(e);return t?intArrayToString(t):read(e)}),Module.readBinary=function(e){var t;return(t=tryParseAsDataURI(e))?t:"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(assert("object"==typeof(t=read(e,"binary"))),t)},"undefined"!=typeof scriptArgs?Module.arguments=scriptArgs:"undefined"!=typeof arguments&&(Module.arguments=arguments),"function"==typeof quit&&(Module.quit=function(e,t){quit(e)})):(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)&&(Module.read=function(e){try{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText}catch(t){var r=tryParseAsDataURI(e);if(r)return intArrayToString(r);throw t}},ENVIRONMENT_IS_WORKER&&(Module.readBinary=function(e){try{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}catch(t){var r=tryParseAsDataURI(e);if(r)return r;throw t}}),Module.readAsync=function(e,t,r){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=function(){if(200==i.status||0==i.status&&i.response)t(i.response);else{var n=tryParseAsDataURI(e);n?t(n.buffer):r()}},i.onerror=r,i.send(null)},"undefined"!=typeof arguments&&(Module.arguments=arguments),Module.setWindowTitle=function(e){document.title=e}),Module.print="undefined"!=typeof console?console.log.bind(console):"undefined"!=typeof print?print:null,Module.printErr="undefined"!=typeof printErr?printErr:"undefined"!=typeof console&&console.warn.bind(console)||Module.print,Module.print=Module.print,Module.printErr=Module.printErr,moduleOverrides)moduleOverrides.hasOwnProperty(key)&&(Module[key]=moduleOverrides[key]);moduleOverrides=void 0;var STACK_ALIGN=16;function staticAlloc(e){assert(!staticSealed);var t=STATICTOP;return STATICTOP=STATICTOP+e+15&-16,t}function dynamicAlloc(e){assert(DYNAMICTOP_PTR);var t=HEAP32[DYNAMICTOP_PTR>>2],r=t+e+15&-16;return HEAP32[DYNAMICTOP_PTR>>2]=r,r>=TOTAL_MEMORY&&!enlargeMemory()?(HEAP32[DYNAMICTOP_PTR>>2]=t,0):t}function alignMemory(e,t){return t||(t=STACK_ALIGN),Math.ceil(e/t)*t}function getNativeTypeSize(e){switch(e){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:if("*"===e[e.length-1])return 4;if("i"===e[0]){var t=parseInt(e.substr(1));return assert(t%8==0),t/8}return 0}}function warnOnce(e){warnOnce.shown||(warnOnce.shown={}),warnOnce.shown[e]||(warnOnce.shown[e]=1,Module.printErr(e))}var jsCallStartIndex=1,functionPointers=new Array(0);function addFunction(e,t){for(var r=0;r<0;r++)if(!functionPointers[r])return functionPointers[r]=e,jsCallStartIndex+r;throw"Finished up all reserved function pointers. Use a higher value for RESERVED_FUNCTION_POINTERS."}function removeFunction(e){functionPointers[e-jsCallStartIndex]=null}var funcWrappers={};function getFuncWrapper(e,t){if(e){assert(t),funcWrappers[t]||(funcWrappers[t]={});var r=funcWrappers[t];return r[e]||(1===t.length?r[e]=function(){return dynCall(t,e)}:2===t.length?r[e]=function(r){return dynCall(t,e,[r])}:r[e]=function(){return dynCall(t,e,Array.prototype.slice.call(arguments))}),r[e]}}function makeBigInt(e,t,r){return r?+(e>>>0)+4294967296*+(t>>>0):+(e>>>0)+4294967296*+(0|t)}function dynCall(e,t,r){return r&&r.length?Module["dynCall_"+e].apply(null,[t].concat(r)):Module["dynCall_"+e].call(null,t)}var Runtime={dynCall:dynCall},GLOBAL_BASE=8,ABORT=0,EXITSTATUS=0;function assert(e,t){e||abort("Assertion failed: "+t)}var globalScope=this;function getCFunc(e){var t=Module["_"+e];return assert(t,"Cannot call unknown function "+e+", make sure it is exported"),t}var JSfuncs={stackSave:function(){stackSave()},stackRestore:function(){stackRestore()},arrayToC:function(e){var t=stackAlloc(e.length);return writeArrayToMemory(e,t),t},stringToC:function(e){var t=0;if(null!=e&&0!==e){var r=1+(e.length<<2);stringToUTF8(e,t=stackAlloc(r),r)}return t}},toC={string:JSfuncs.stringToC,array:JSfuncs.arrayToC};function ccall(e,t,r,i,n){var o=getCFunc(e),a=[],s=0;if(i)for(var l=0;l<i.length;l++){var c=toC[r[l]];c?(0===s&&(s=stackSave()),a[l]=c(i[l])):a[l]=i[l]}var u=o.apply(null,a);return"string"===t&&(u=Pointer_stringify(u)),0!==s&&stackRestore(s),u}function cwrap(e,t,r){r=r||[];var i=getCFunc(e),n=r.every(function(e){return"number"===e});return"string"!==t&&n?i:function(){return ccall(e,t,r,arguments)}}function setValue(e,t,r,i){switch("*"===(r=r||"i8").charAt(r.length-1)&&(r="i32"),r){case"i1":case"i8":HEAP8[e>>0]=t;break;case"i16":HEAP16[e>>1]=t;break;case"i32":HEAP32[e>>2]=t;break;case"i64":tempI64=[t>>>0,(tempDouble=t,+Math_abs(tempDouble)>=1?tempDouble>0?(0|Math_min(+Math_floor(tempDouble/4294967296),4294967295))>>>0:~~+Math_ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],HEAP32[e>>2]=tempI64[0],HEAP32[e+4>>2]=tempI64[1];break;case"float":HEAPF32[e>>2]=t;break;case"double":HEAPF64[e>>3]=t;break;default:abort("invalid type for setValue: "+r)}}function getValue(e,t,r){switch("*"===(t=t||"i8").charAt(t.length-1)&&(t="i32"),t){case"i1":case"i8":return HEAP8[e>>0];case"i16":return HEAP16[e>>1];case"i32":case"i64":return HEAP32[e>>2];case"float":return HEAPF32[e>>2];case"double":return HEAPF64[e>>3];default:abort("invalid type for getValue: "+t)}return null}var ALLOC_NORMAL=0,ALLOC_STACK=1,ALLOC_STATIC=2,ALLOC_DYNAMIC=3,ALLOC_NONE=4;function allocate(e,t,r,i){var n,o;"number"==typeof e?(n=!0,o=e):(n=!1,o=e.length);var a,s="string"==typeof t?t:null;if(a=r==ALLOC_NONE?i:["function"==typeof _malloc?_malloc:staticAlloc,stackAlloc,staticAlloc,dynamicAlloc][void 0===r?ALLOC_STATIC:r](Math.max(o,s?1:t.length)),n){var l;for(i=a,assert(0==(3&a)),l=a+(-4&o);i<l;i+=4)HEAP32[i>>2]=0;for(l=a+o;i<l;)HEAP8[i++>>0]=0;return a}if("i8"===s)return e.subarray||e.slice?HEAPU8.set(e,a):HEAPU8.set(new Uint8Array(e),a),a;for(var c,u,d,h=0;h<o;){var f=e[h];0!==(c=s||t[h])?("i64"==c&&(c="i32"),setValue(a+h,f,c),d!==c&&(u=getNativeTypeSize(c),d=c),h+=u):h++}return a}function getMemory(e){return staticSealed?runtimeInitialized?_malloc(e):dynamicAlloc(e):staticAlloc(e)}function Pointer_stringify(e,t){if(0===t||!e)return"";for(var r,i=0,n=0;i|=r=HEAPU8[e+n>>0],(0!=r||t)&&(n++,!t||n!=t););t||(t=n);var o="";if(i<128){for(var a;t>0;)a=String.fromCharCode.apply(String,HEAPU8.subarray(e,e+Math.min(t,1024))),o=o?o+a:a,e+=1024,t-=1024;return o}return UTF8ToString(e)}function AsciiToString(e){for(var t="";;){var r=HEAP8[e++>>0];if(!r)return t;t+=String.fromCharCode(r)}}function stringToAscii(e,t){return writeAsciiToMemory(e,t,!1)}var UTF8Decoder="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function UTF8ArrayToString(e,t){for(var r=t;e[r];)++r;if(r-t>16&&e.subarray&&UTF8Decoder)return UTF8Decoder.decode(e.subarray(t,r));for(var i,n,o,a,s,l="";;){if(!(i=e[t++]))return l;if(128&i)if(n=63&e[t++],192!=(224&i))if(o=63&e[t++],224==(240&i)?i=(15&i)<<12|n<<6|o:(a=63&e[t++],240==(248&i)?i=(7&i)<<18|n<<12|o<<6|a:(s=63&e[t++],i=248==(252&i)?(3&i)<<24|n<<18|o<<12|a<<6|s:(1&i)<<30|n<<24|o<<18|a<<12|s<<6|63&e[t++])),i<65536)l+=String.fromCharCode(i);else{var c=i-65536;l+=String.fromCharCode(55296|c>>10,56320|1023&c)}else l+=String.fromCharCode((31&i)<<6|n);else l+=String.fromCharCode(i)}}function UTF8ToString(e){return UTF8ArrayToString(HEAPU8,e)}function stringToUTF8Array(e,t,r,i){if(!(i>0))return 0;for(var n=r,o=r+i-1,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s>=55296&&s<=57343&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++a)),s<=127){if(r>=o)break;t[r++]=s}else if(s<=2047){if(r+1>=o)break;t[r++]=192|s>>6,t[r++]=128|63&s}else if(s<=65535){if(r+2>=o)break;t[r++]=224|s>>12,t[r++]=128|s>>6&63,t[r++]=128|63&s}else if(s<=2097151){if(r+3>=o)break;t[r++]=240|s>>18,t[r++]=128|s>>12&63,t[r++]=128|s>>6&63,t[r++]=128|63&s}else if(s<=67108863){if(r+4>=o)break;t[r++]=248|s>>24,t[r++]=128|s>>18&63,t[r++]=128|s>>12&63,t[r++]=128|s>>6&63,t[r++]=128|63&s}else{if(r+5>=o)break;t[r++]=252|s>>30,t[r++]=128|s>>24&63,t[r++]=128|s>>18&63,t[r++]=128|s>>12&63,t[r++]=128|s>>6&63,t[r++]=128|63&s}}return t[r]=0,r-n}function stringToUTF8(e,t,r){return stringToUTF8Array(e,HEAPU8,t,r)}function lengthBytesUTF8(e){for(var t=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=55296&&i<=57343&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++r)),i<=127?++t:t+=i<=2047?2:i<=65535?3:i<=2097151?4:i<=67108863?5:6}return t}var UTF16Decoder="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0;function UTF16ToString(e){for(var t=e,r=t>>1;HEAP16[r];)++r;if((t=r<<1)-e>32&&UTF16Decoder)return UTF16Decoder.decode(HEAPU8.subarray(e,t));for(var i=0,n="";;){var o=HEAP16[e+2*i>>1];if(0==o)return n;++i,n+=String.fromCharCode(o)}}function stringToUTF16(e,t,r){if(void 0===r&&(r=2147483647),r<2)return 0;for(var i=t,n=(r-=2)<2*e.length?r/2:e.length,o=0;o<n;++o){var a=e.charCodeAt(o);HEAP16[t>>1]=a,t+=2}return HEAP16[t>>1]=0,t-i}function lengthBytesUTF16(e){return 2*e.length}function UTF32ToString(e){for(var t=0,r="";;){var i=HEAP32[e+4*t>>2];if(0==i)return r;if(++t,i>=65536){var n=i-65536;r+=String.fromCharCode(55296|n>>10,56320|1023&n)}else r+=String.fromCharCode(i)}}function stringToUTF32(e,t,r){if(void 0===r&&(r=2147483647),r<4)return 0;for(var i=t,n=i+r-4,o=0;o<e.length;++o){var a=e.charCodeAt(o);if(a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o)),HEAP32[t>>2]=a,(t+=4)+4>n)break}return HEAP32[t>>2]=0,t-i}function lengthBytesUTF32(e){for(var t=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=55296&&i<=57343&&++r,t+=4}return t}function allocateUTF8(e){var t=lengthBytesUTF8(e)+1,r=_malloc(t);return r&&stringToUTF8Array(e,HEAP8,r,t),r}function allocateUTF8OnStack(e){var t=lengthBytesUTF8(e)+1,r=stackAlloc(t);return stringToUTF8Array(e,HEAP8,r,t),r}function demangle(e){return e}function demangleAll(e){return e.replace(/__Z[\w\d_]+/g,function(e){var t=demangle(e);return e===t?e:e+" ["+t+"]"})}function jsStackTrace(){var e=new Error;if(!e.stack){try{throw new Error(0)}catch(t){e=t}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}function stackTrace(){var e=jsStackTrace();return Module.extraStackTrace&&(e+="\n"+Module.extraStackTrace()),demangleAll(e)}var HEAP,buffer,HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64,STATIC_BASE,STATICTOP,staticSealed,STACK_BASE,STACKTOP,STACK_MAX,DYNAMIC_BASE,DYNAMICTOP_PTR,PAGE_SIZE=16384,WASM_PAGE_SIZE=65536,ASMJS_PAGE_SIZE=16777216,MIN_TOTAL_MEMORY=16777216;function alignUp(e,t){return e%t>0&&(e+=t-e%t),e}function updateGlobalBuffer(e){Module.buffer=buffer=e}function updateGlobalBufferViews(){Module.HEAP8=HEAP8=new Int8Array(buffer),Module.HEAP16=HEAP16=new Int16Array(buffer),Module.HEAP32=HEAP32=new Int32Array(buffer),Module.HEAPU8=HEAPU8=new Uint8Array(buffer),Module.HEAPU16=HEAPU16=new Uint16Array(buffer),Module.HEAPU32=HEAPU32=new Uint32Array(buffer),Module.HEAPF32=HEAPF32=new Float32Array(buffer),Module.HEAPF64=HEAPF64=new Float64Array(buffer)}function abortOnCannotGrowMemory(){abort("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+TOTAL_MEMORY+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime but prevents some optimizations, (3) set Module.TOTAL_MEMORY to a higher value before the program runs, or (4) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}function enlargeMemory(){abortOnCannotGrowMemory()}STATIC_BASE=STATICTOP=STACK_BASE=STACKTOP=STACK_MAX=DYNAMIC_BASE=DYNAMICTOP_PTR=0,staticSealed=!1;var TOTAL_STACK=Module.TOTAL_STACK||5242880,TOTAL_MEMORY=Module.TOTAL_MEMORY||16777216;function getTotalMemory(){return TOTAL_MEMORY}if(TOTAL_MEMORY<TOTAL_STACK&&Module.printErr("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+TOTAL_MEMORY+"! (TOTAL_STACK="+TOTAL_STACK+")"),Module.buffer?buffer=Module.buffer:(buffer=new ArrayBuffer(TOTAL_MEMORY),Module.buffer=buffer),updateGlobalBufferViews(),HEAP32[0]=1668509029,HEAP16[1]=25459,115!==HEAPU8[2]||99!==HEAPU8[3])throw"Runtime error: expected the system to be little-endian!";function callRuntimeCallbacks(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var r=t.func;"number"==typeof r?void 0===t.arg?Module.dynCall_v(r):Module.dynCall_vi(r,t.arg):r(void 0===t.arg?null:t.arg)}else t()}}var __ATPRERUN__=[],__ATINIT__=[],__ATMAIN__=[],__ATEXIT__=[],__ATPOSTRUN__=[],runtimeInitialized=!1,runtimeExited=!1;function preRun(){if(Module.preRun)for("function"==typeof Module.preRun&&(Module.preRun=[Module.preRun]);Module.preRun.length;)addOnPreRun(Module.preRun.shift());callRuntimeCallbacks(__ATPRERUN__)}function ensureInitRuntime(){runtimeInitialized||(runtimeInitialized=!0,callRuntimeCallbacks(__ATINIT__))}function preMain(){callRuntimeCallbacks(__ATMAIN__)}function exitRuntime(){callRuntimeCallbacks(__ATEXIT__),runtimeExited=!0}function postRun(){if(Module.postRun)for("function"==typeof Module.postRun&&(Module.postRun=[Module.postRun]);Module.postRun.length;)addOnPostRun(Module.postRun.shift());callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(e){__ATPRERUN__.unshift(e)}function addOnInit(e){__ATINIT__.unshift(e)}function addOnPreMain(e){__ATMAIN__.unshift(e)}function addOnExit(e){__ATEXIT__.unshift(e)}function addOnPostRun(e){__ATPOSTRUN__.unshift(e)}function writeStringToMemory(e,t,r){var i,n;warnOnce("writeStringToMemory is deprecated and should not be called! Use stringToUTF8() instead!"),r&&(n=t+lengthBytesUTF8(e),i=HEAP8[n]),stringToUTF8(e,t,1/0),r&&(HEAP8[n]=i)}function writeArrayToMemory(e,t){HEAP8.set(e,t)}function writeAsciiToMemory(e,t,r){for(var i=0;i<e.length;++i)HEAP8[t++>>0]=e.charCodeAt(i);r||(HEAP8[t>>0]=0)}function unSign(e,t,r){return e>=0?e:t<=32?2*Math.abs(1<<t-1)+e:Math.pow(2,t)+e}function reSign(e,t,r){if(e<=0)return e;var i=t<=32?Math.abs(1<<t-1):Math.pow(2,t-1);return e>=i&&(t<=32||e>i)&&(e=-2*i+e),e}var Math_abs=Math.abs,Math_cos=Math.cos,Math_sin=Math.sin,Math_tan=Math.tan,Math_acos=Math.acos,Math_asin=Math.asin,Math_atan=Math.atan,Math_atan2=Math.atan2,Math_exp=Math.exp,Math_log=Math.log,Math_sqrt=Math.sqrt,Math_ceil=Math.ceil,Math_floor=Math.floor,Math_pow=Math.pow,Math_imul=Math.imul,Math_fround=Math.fround,Math_round=Math.round,Math_min=Math.min,Math_max=Math.max,Math_clz32=Math.clz32,Math_trunc=Math.trunc,runDependencies=0,runDependencyWatcher=null,dependenciesFulfilled=null;function getUniqueRunDependency(e){return e}function addRunDependency(e){runDependencies++,Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies)}function removeRunDependency(e){if(runDependencies--,Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies),0==runDependencies&&(null!==runDependencyWatcher&&(clearInterval(runDependencyWatcher),runDependencyWatcher=null),dependenciesFulfilled)){var t=dependenciesFulfilled;dependenciesFulfilled=null,t()}}Module.preloadedImages={},Module.preloadedAudios={};var memoryInitializer=null,dataURIPrefix="data:application/octet-stream;base64,";function isDataURI(e){return String.prototype.startsWith?e.startsWith(dataURIPrefix):0===e.indexOf(dataURIPrefix)}var ASM_CONSTS=[function(e,t){if("undefined"!=typeof window){let e=arguments,t=new Uint8Array(Module.HEAPU8.buffer,e[0],e[1]),r=new TextDecoder("utf-8").decode(t);window.checkHost="yet";let i=new XMLHttpRequest;i.open("GET",r),i.responseType="json",i.onload=function(e){let t=i.response.customizedWebSites;if(void 0!==t){let e=t.list;if(void 0!==e)for(let t in e){if(e[t].name==location.hostname){window.checkHost="correct";break}t==e.length-1&&(window.checkHost="fail")}}},i.send()}}];function _emscripten_asm_const_iii(e,t,r){return ASM_CONSTS[e](t,r)}STATICTOP=(STATIC_BASE=GLOBAL_BASE)+3472,__ATINIT__.push({func:function(){__GLOBAL__sub_I_whiteList_cpp()}},{func:function(){__GLOBAL__sub_I_bind_cpp()}}),memoryInitializer="data:application/octet-stream;base64,jAEAAD8HAACMAQAAfgcAAIwBAAC8BwAAjAEAAAIIAACMAQAAPwgAAIwBAABeCAAAjAEAAH0IAACMAQAAnAgAAIwBAAC7CAAAjAEAANoIAACMAQAA+QgAAIwBAAA2CQAAjAEAAFUJAAD4AQAAaAkAAAAAAAABAAAAiAAAAAAAAACMAQAApwkAAPgBAADNCQAAAAAAAAEAAACIAAAAAAAAAPgBAAAMCgAAAAAAAAEAAACIAAAAAAAAALQBAAADCwAA0AAAAAAAAAC0AQAAsAoAAOAAAAAAAAAAjAEAANEKAAC0AQAA3goAAMAAAAAAAAAAtAEAACULAADQAAAAAAAAANwBAABNCwAA3AEAAE8LAADcAQAAUQsAANwBAABTCwAA3AEAAFULAADcAQAAVwsAANwBAABZCwAA3AEAAFsLAADcAQAAXQsAANwBAABfCwAA3AEAAGELAADcAQAAYwsAANwBAABlCwAAtAEAAGcLAADAAAAAAAAAAEABAAAAAAAAwAAAAAEAAAACAAAAAwAAAAQAAAABAAAAAQAAAAEAAAABAAAAAAAAAOgAAAABAAAABQAAAAMAAAAEAAAAAQAAAAIAAAACAAAAAgAAAAAAAAD4AAAAAQAAAAYAAAADAAAABAAAAAIAAAAAAAAAcAEAAAEAAAAHAAAAAwAAAAQAAAABAAAAAwAAAAMAAAADAAAAaHR0cHM6Ly9zMy1hcC1ub3J0aGVhc3QtMS5hbWF6b25hd3MuY29tL21ha2FyLndlYmFyLmRlZmF1bHRvYmplY3Qvd2ViX3doaXRlX2xpc3Qvd2ViU2l0ZUxpc3QudHh0AHsgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7IGxldCBhID0gYXJndW1lbnRzOyBsZXQgeSA9IG5ldyBVaW50OEFycmF5KCBNb2R1bGUuSEVBUFU4LmJ1ZmZlciwgYVswXSwgYVsxXSApOyBsZXQgbGlzdFVybCA9IG5ldyBUZXh0RGVjb2RlcigidXRmLTgiKS5kZWNvZGUoeSk7IHdpbmRvdy5jaGVja0hvc3QgPSAieWV0IjsgbGV0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOyB4aHIub3BlbiggJ0dFVCcsIGxpc3RVcmwgKTsgeGhyLnJlc3BvbnNlVHlwZSA9ICdqc29uJzsgeGhyLm9ubG9hZCA9IGZ1bmN0aW9uKGUpIHsgbGV0IGN1c3RvbWl6ZWRXZWJTaXRlcyA9IHhoci5yZXNwb25zZS5jdXN0b21pemVkV2ViU2l0ZXM7IGlmICggdHlwZW9mKGN1c3RvbWl6ZWRXZWJTaXRlcykgIT0gInVuZGVmaW5lZCIgKXsgbGV0IGxpc3QgPSBjdXN0b21pemVkV2ViU2l0ZXMubGlzdCA7IGlmICggdHlwZW9mKGxpc3QpICE9ICJ1bmRlZmluZWQiICl7IGZvciAobGV0IGkgaW4gbGlzdCApeyBpZiAoIGxpc3RbaV0ubmFtZSA9PSBsb2NhdGlvbi5ob3N0bmFtZSl7IHdpbmRvdy5jaGVja0hvc3QgPSAiY29ycmVjdCI7IGJyZWFrOyB9IGlmICggaSA9PSBsaXN0Lmxlbmd0aCAtIDEgKXsgd2luZG93LmNoZWNrSG9zdCA9ICJmYWlsIjsgfSB9IH0gfSB9OyB4aHIuc2VuZCgpOyB9IH0AY2hlY2tNaWZseQBpaQB2b2lkAGJvb2wAc3RkOjpzdHJpbmcAc3RkOjpiYXNpY19zdHJpbmc8dW5zaWduZWQgY2hhcj4Ac3RkOjp3c3RyaW5nAGVtc2NyaXB0ZW46OnZhbABlbXNjcmlwdGVuOjptZW1vcnlfdmlldzxzaWduZWQgY2hhcj4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8dW5zaWduZWQgY2hhcj4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8c2hvcnQ+AGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PHVuc2lnbmVkIHNob3J0PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzxpbnQ+AGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PHVuc2lnbmVkIGludD4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8aW50OF90PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzx1aW50OF90PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzxpbnQxNl90PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzx1aW50MTZfdD4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8aW50MzJfdD4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8dWludDMyX3Q+AGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PGxvbmcgZG91YmxlPgBOMTBlbXNjcmlwdGVuMTFtZW1vcnlfdmlld0llRUUAZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8ZG91YmxlPgBOMTBlbXNjcmlwdGVuMTFtZW1vcnlfdmlld0lkRUUAZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8ZmxvYXQ+AE4xMGVtc2NyaXB0ZW4xMW1lbW9yeV92aWV3SWZFRQBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzx1bnNpZ25lZCBsb25nPgBOMTBlbXNjcmlwdGVuMTFtZW1vcnlfdmlld0ltRUUAZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8bG9uZz4ATjEwZW1zY3JpcHRlbjExbWVtb3J5X3ZpZXdJbEVFAE4xMGVtc2NyaXB0ZW4xMW1lbW9yeV92aWV3SWpFRQBOMTBlbXNjcmlwdGVuMTFtZW1vcnlfdmlld0lpRUUATjEwZW1zY3JpcHRlbjExbWVtb3J5X3ZpZXdJdEVFAE4xMGVtc2NyaXB0ZW4xMW1lbW9yeV92aWV3SXNFRQBOMTBlbXNjcmlwdGVuMTFtZW1vcnlfdmlld0loRUUATjEwZW1zY3JpcHRlbjExbWVtb3J5X3ZpZXdJYUVFAGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PGNoYXI+AE4xMGVtc2NyaXB0ZW4xMW1lbW9yeV92aWV3SWNFRQBOMTBlbXNjcmlwdGVuM3ZhbEUATlN0M19fMjEyYmFzaWNfc3RyaW5nSXdOU18xMWNoYXJfdHJhaXRzSXdFRU5TXzlhbGxvY2F0b3JJd0VFRUUATlN0M19fMjIxX19iYXNpY19zdHJpbmdfY29tbW9uSUxiMUVFRQBOU3QzX18yMTJiYXNpY19zdHJpbmdJaE5TXzExY2hhcl90cmFpdHNJaEVFTlNfOWFsbG9jYXRvckloRUVFRQBOU3QzX18yMTJiYXNpY19zdHJpbmdJY05TXzExY2hhcl90cmFpdHNJY0VFTlNfOWFsbG9jYXRvckljRUVFRQBkb3VibGUAZmxvYXQAdW5zaWduZWQgbG9uZwBsb25nAHVuc2lnbmVkIGludABpbnQAdW5zaWduZWQgc2hvcnQAc2hvcnQAdW5zaWduZWQgY2hhcgBzaWduZWQgY2hhcgBjaGFyAE4xMF9fY3h4YWJpdjExNl9fc2hpbV90eXBlX2luZm9FAFN0OXR5cGVfaW5mbwBOMTBfX2N4eGFiaXYxMjBfX3NpX2NsYXNzX3R5cGVfaW5mb0UATjEwX19jeHhhYml2MTE3X19jbGFzc190eXBlX2luZm9FAE4xMF9fY3h4YWJpdjEyM19fZnVuZGFtZW50YWxfdHlwZV9pbmZvRQB2AGIAYwBoAGEAcwB0AGkAagBsAG0AZgBkAE4xMF9fY3h4YWJpdjEyMV9fdm1pX2NsYXNzX3R5cGVfaW5mb0U=";var tempDoublePtr=STATICTOP;function copyTempFloat(e){HEAP8[tempDoublePtr]=HEAP8[e],HEAP8[tempDoublePtr+1]=HEAP8[e+1],HEAP8[tempDoublePtr+2]=HEAP8[e+2],HEAP8[tempDoublePtr+3]=HEAP8[e+3]}function copyTempDouble(e){HEAP8[tempDoublePtr]=HEAP8[e],HEAP8[tempDoublePtr+1]=HEAP8[e+1],HEAP8[tempDoublePtr+2]=HEAP8[e+2],HEAP8[tempDoublePtr+3]=HEAP8[e+3],HEAP8[tempDoublePtr+4]=HEAP8[e+4],HEAP8[tempDoublePtr+5]=HEAP8[e+5],HEAP8[tempDoublePtr+6]=HEAP8[e+6],HEAP8[tempDoublePtr+7]=HEAP8[e+7]}function __ZSt18uncaught_exceptionv(){return!!__ZSt18uncaught_exceptionv.uncaught_exception}STATICTOP+=16;var EXCEPTIONS={last:0,caught:[],infos:{},deAdjust:function(e){if(!e||EXCEPTIONS.infos[e])return e;for(var t in EXCEPTIONS.infos)if(EXCEPTIONS.infos[t].adjusted===e)return t;return e},addRef:function(e){e&&EXCEPTIONS.infos[e].refcount++},decRef:function(e){if(e){var t=EXCEPTIONS.infos[e];assert(t.refcount>0),t.refcount--,0!==t.refcount||t.rethrown||(t.destructor&&Module.dynCall_vi(t.destructor,e),delete EXCEPTIONS.infos[e],___cxa_free_exception(e))}},clearRef:function(e){e&&(EXCEPTIONS.infos[e].refcount=0)}};function ___resumeException(e){throw EXCEPTIONS.last||(EXCEPTIONS.last=e),e+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch."}function ___cxa_find_matching_catch(){var e=EXCEPTIONS.last;if(!e)return 0|(setTempRet0(0),0);var t=EXCEPTIONS.infos[e],r=t.type;if(!r)return 0|(setTempRet0(0),e);var i=Array.prototype.slice.call(arguments);Module.___cxa_is_pointer_type(r),___cxa_find_matching_catch.buffer||(___cxa_find_matching_catch.buffer=_malloc(4)),HEAP32[___cxa_find_matching_catch.buffer>>2]=e,e=___cxa_find_matching_catch.buffer;for(var n=0;n<i.length;n++)if(i[n]&&Module.___cxa_can_catch(i[n],r,e))return e=HEAP32[e>>2],t.adjusted=e,0|(setTempRet0(i[n]),e);return e=HEAP32[e>>2],0|(setTempRet0(r),e)}function ___gxx_personality_v0(){}function getShiftFromSize(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}function embind_init_charCodes(){for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);embind_charCodes=e}var embind_charCodes=void 0;function readLatin1String(e){for(var t="",r=e;HEAPU8[r];)t+=embind_charCodes[HEAPU8[r++]];return t}var awaitingDependencies={},registeredTypes={},typeDependencies={},char_0=48,char_9=57;function makeLegalFunctionName(e){if(void 0===e)return"_unknown";var t=(e=e.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return t>=char_0&&t<=char_9?"_"+e:e}function createNamedFunction(e,t){return e=makeLegalFunctionName(e),new Function("body","return function "+e+'() {\n    "use strict";    return body.apply(this, arguments);\n};\n')(t)}function extendError(e,t){var r=createNamedFunction(t,function(e){this.name=t,this.message=e;var r=new Error(e).stack;void 0!==r&&(this.stack=this.toString()+"\n"+r.replace(/^Error(:[^\n]*)?\n/,""))});return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},r}var BindingError=void 0;function throwBindingError(e){throw new BindingError(e)}var InternalError=void 0;function throwInternalError(e){throw new InternalError(e)}function whenDependentTypesAreResolved(e,t,r){function i(t){var i=r(t);i.length!==e.length&&throwInternalError("Mismatched type converter count");for(var n=0;n<e.length;++n)registerType(e[n],i[n])}e.forEach(function(e){typeDependencies[e]=t});var n=new Array(t.length),o=[],a=0;t.forEach(function(e,t){registeredTypes.hasOwnProperty(e)?n[t]=registeredTypes[e]:(o.push(e),awaitingDependencies.hasOwnProperty(e)||(awaitingDependencies[e]=[]),awaitingDependencies[e].push(function(){n[t]=registeredTypes[e],++a===o.length&&i(n)}))}),0===o.length&&i(n)}function registerType(e,t,r){if(r=r||{},!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var i=t.name;if(e||throwBindingError('type "'+i+'" must have a positive integer typeid pointer'),registeredTypes.hasOwnProperty(e)){if(r.ignoreDuplicateRegistrations)return;throwBindingError("Cannot register type '"+i+"' twice")}if(registeredTypes[e]=t,delete typeDependencies[e],awaitingDependencies.hasOwnProperty(e)){var n=awaitingDependencies[e];delete awaitingDependencies[e],n.forEach(function(e){e()})}}function __embind_register_bool(e,t,r,i,n){var o=getShiftFromSize(r);registerType(e,{name:t=readLatin1String(t),fromWireType:function(e){return!!e},toWireType:function(e,t){return t?i:n},argPackAdvance:8,readValueFromPointer:function(e){var i;if(1===r)i=HEAP8;else if(2===r)i=HEAP16;else{if(4!==r)throw new TypeError("Unknown boolean type size: "+t);i=HEAP32}return this.fromWireType(i[e>>o])},destructorFunction:null})}var emval_free_list=[],emval_handle_array=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function __emval_decref(e){e>4&&0==--emval_handle_array[e].refcount&&(emval_handle_array[e]=void 0,emval_free_list.push(e))}function count_emval_handles(){for(var e=0,t=5;t<emval_handle_array.length;++t)void 0!==emval_handle_array[t]&&++e;return e}function get_first_emval(){for(var e=5;e<emval_handle_array.length;++e)if(void 0!==emval_handle_array[e])return emval_handle_array[e];return null}function init_emval(){Module.count_emval_handles=count_emval_handles,Module.get_first_emval=get_first_emval}function __emval_register(e){switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var t=emval_free_list.length?emval_free_list.pop():emval_handle_array.length;return emval_handle_array[t]={refcount:1,value:e},t}}function simpleReadValueFromPointer(e){return this.fromWireType(HEAPU32[e>>2])}function __embind_register_emval(e,t){registerType(e,{name:t=readLatin1String(t),fromWireType:function(e){var t=emval_handle_array[e].value;return __emval_decref(e),t},toWireType:function(e,t){return __emval_register(t)},argPackAdvance:8,readValueFromPointer:simpleReadValueFromPointer,destructorFunction:null})}function _embind_repr(e){if(null===e)return"null";var t=typeof e;return"object"===t||"array"===t||"function"===t?e.toString():""+e}function floatReadValueFromPointer(e,t){switch(t){case 2:return function(e){return this.fromWireType(HEAPF32[e>>2])};case 3:return function(e){return this.fromWireType(HEAPF64[e>>3])};default:throw new TypeError("Unknown float type: "+e)}}function __embind_register_float(e,t,r){var i=getShiftFromSize(r);registerType(e,{name:t=readLatin1String(t),fromWireType:function(e){return e},toWireType:function(e,t){if("number"!=typeof t&&"boolean"!=typeof t)throw new TypeError('Cannot convert "'+_embind_repr(t)+'" to '+this.name);return t},argPackAdvance:8,readValueFromPointer:floatReadValueFromPointer(t,i),destructorFunction:null})}function new_(e,t){if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+typeof e+" which is not a function");var r=createNamedFunction(e.name||"unknownFunctionName",function(){});r.prototype=e.prototype;var i=new r,n=e.apply(i,t);return n instanceof Object?n:i}function runDestructors(e){for(;e.length;){var t=e.pop();e.pop()(t)}}function craftInvokerFunction(e,t,r,i,n){var o=t.length;o<2&&throwBindingError("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var a=null!==t[1]&&null!==r,s=!1,l=1;l<t.length;++l)if(null!==t[l]&&void 0===t[l].destructorFunction){s=!0;break}var c="void"!==t[0].name,u="",d="";for(l=0;l<o-2;++l)u+=(0!==l?", ":"")+"arg"+l,d+=(0!==l?", ":"")+"arg"+l+"Wired";var h="return function "+makeLegalFunctionName(e)+"("+u+") {\nif (arguments.length !== "+(o-2)+") {\nthrowBindingError('function "+e+" called with ' + arguments.length + ' arguments, expected "+(o-2)+" args!');\n}\n";s&&(h+="var destructors = [];\n");var f=s?"destructors":"null",p=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],m=[throwBindingError,i,n,runDestructors,t[0],t[1]];for(a&&(h+="var thisWired = classParam.toWireType("+f+", this);\n"),l=0;l<o-2;++l)h+="var arg"+l+"Wired = argType"+l+".toWireType("+f+", arg"+l+"); // "+t[l+2].name+"\n",p.push("argType"+l),m.push(t[l+2]);if(a&&(d="thisWired"+(d.length>0?", ":"")+d),h+=(c?"var rv = ":"")+"invoker(fn"+(d.length>0?", ":"")+d+");\n",s)h+="runDestructors(destructors);\n";else for(l=a?1:2;l<t.length;++l){var v=1===l?"thisWired":"arg"+(l-2)+"Wired";null!==t[l].destructorFunction&&(h+=v+"_dtor("+v+"); // "+t[l].name+"\n",p.push(v+"_dtor"),m.push(t[l].destructorFunction))}return c&&(h+="var ret = retType.fromWireType(rv);\nreturn ret;\n"),h+="}\n",p.push(h),new_(Function,p).apply(null,m)}function ensureOverloadTable(e,t,r){if(void 0===e[t].overloadTable){var i=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||throwBindingError("Function '"+r+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[t].overloadTable+")!"),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[i.argCount]=i}}function exposePublicSymbol(e,t,r){Module.hasOwnProperty(e)?((void 0===r||void 0!==Module[e].overloadTable&&void 0!==Module[e].overloadTable[r])&&throwBindingError("Cannot register public name '"+e+"' twice"),ensureOverloadTable(Module,e,e),Module.hasOwnProperty(r)&&throwBindingError("Cannot register multiple overloads of a function with the same number of arguments ("+r+")!"),Module[e].overloadTable[r]=t):(Module[e]=t,void 0!==r&&(Module[e].numArguments=r))}function heap32VectorToArray(e,t){for(var r=[],i=0;i<e;i++)r.push(HEAP32[(t>>2)+i]);return r}function replacePublicSymbol(e,t,r){Module.hasOwnProperty(e)||throwInternalError("Replacing nonexistant public symbol"),void 0!==Module[e].overloadTable&&void 0!==r?Module[e].overloadTable[r]=t:(Module[e]=t,Module[e].argCount=r)}function embind__requireFunction(e,t){var r;if(e=readLatin1String(e),void 0!==Module["FUNCTION_TABLE_"+e])r=Module["FUNCTION_TABLE_"+e][t];else if("undefined"!=typeof FUNCTION_TABLE)r=FUNCTION_TABLE[t];else{var i=Module.asm["dynCall_"+e];void 0===i&&void 0===(i=Module.asm["dynCall_"+e.replace(/f/g,"d")])&&throwBindingError("No dynCall invoker for signature: "+e),r=function(r){for(var i=[],n=1;n<e.length;++n)i.push("a"+n);var o="return function dynCall_"+e+"_"+t+"("+i.join(", ")+") {\n";return o+="    return dynCall(rawFunction"+(i.length?", ":"")+i.join(", ")+");\n",o+="};\n",new Function("dynCall","rawFunction",o)(r,t)}(i)}return"function"!=typeof r&&throwBindingError("unknown function pointer with signature "+e+": "+t),r}var UnboundTypeError=void 0;function getTypeName(e){var t=___getTypeName(e),r=readLatin1String(t);return _free(t),r}function throwUnboundTypeError(e,t){var r=[],i={};throw t.forEach(function e(t){i[t]||registeredTypes[t]||(typeDependencies[t]?typeDependencies[t].forEach(e):(r.push(t),i[t]=!0))}),new UnboundTypeError(e+": "+r.map(getTypeName).join([", "]))}function __embind_register_function(e,t,r,i,n,o){var a=heap32VectorToArray(t,r);e=readLatin1String(e),n=embind__requireFunction(i,n),exposePublicSymbol(e,function(){throwUnboundTypeError("Cannot call "+e+" due to unbound types",a)},t-1),whenDependentTypesAreResolved([],a,function(r){var i=[r[0],null].concat(r.slice(1));return replacePublicSymbol(e,craftInvokerFunction(e,i,null,n,o),t-1),[]})}function integerReadValueFromPointer(e,t,r){switch(t){case 0:return r?function(e){return HEAP8[e]}:function(e){return HEAPU8[e]};case 1:return r?function(e){return HEAP16[e>>1]}:function(e){return HEAPU16[e>>1]};case 2:return r?function(e){return HEAP32[e>>2]}:function(e){return HEAPU32[e>>2]};default:throw new TypeError("Unknown integer type: "+e)}}function __embind_register_integer(e,t,r,i,n){t=readLatin1String(t),-1===n&&(n=4294967295);var o=getShiftFromSize(r),a=function(e){return e};if(0===i){var s=32-8*r;a=function(e){return e<<s>>>s}}var l=-1!=t.indexOf("unsigned");registerType(e,{name:t,fromWireType:a,toWireType:function(e,r){if("number"!=typeof r&&"boolean"!=typeof r)throw new TypeError('Cannot convert "'+_embind_repr(r)+'" to '+this.name);if(r<i||r>n)throw new TypeError('Passing a number "'+_embind_repr(r)+'" from JS side to C/C++ side to an argument of type "'+t+'", which is outside the valid range ['+i+", "+n+"]!");return l?r>>>0:0|r},argPackAdvance:8,readValueFromPointer:integerReadValueFromPointer(t,o,0!==i),destructorFunction:null})}function __embind_register_memory_view(e,t,r){var i=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][t];function n(e){var t=HEAPU32,r=t[e>>=2],n=t[e+1];return new i(t.buffer,n,r)}registerType(e,{name:r=readLatin1String(r),fromWireType:n,argPackAdvance:8,readValueFromPointer:n},{ignoreDuplicateRegistrations:!0})}function __embind_register_std_string(e,t){registerType(e,{name:t=readLatin1String(t),fromWireType:function(e){for(var t=HEAPU32[e>>2],r=new Array(t),i=0;i<t;++i)r[i]=String.fromCharCode(HEAPU8[e+4+i]);return _free(e),r.join("")},toWireType:function(e,t){function r(e,t){return e[t]}var i;t instanceof ArrayBuffer&&(t=new Uint8Array(t)),t instanceof Uint8Array?i=r:t instanceof Uint8ClampedArray?i=r:t instanceof Int8Array?i=r:"string"==typeof t?i=function(e,t){return e.charCodeAt(t)}:throwBindingError("Cannot pass non-string to std::string");var n=t.length,o=_malloc(4+n);HEAPU32[o>>2]=n;for(var a=0;a<n;++a){var s=i(t,a);s>255&&(_free(o),throwBindingError("String has UTF-16 code units that do not fit in 8 bits")),HEAPU8[o+4+a]=s}return null!==e&&e.push(_free,o),o},argPackAdvance:8,readValueFromPointer:simpleReadValueFromPointer,destructorFunction:function(e){_free(e)}})}function __embind_register_std_wstring(e,t,r){var i,n;r=readLatin1String(r),2===t?(i=function(){return HEAPU16},n=1):4===t&&(i=function(){return HEAPU32},n=2),registerType(e,{name:r,fromWireType:function(e){for(var t=i(),r=HEAPU32[e>>2],o=new Array(r),a=e+4>>n,s=0;s<r;++s)o[s]=String.fromCharCode(t[a+s]);return _free(e),o.join("")},toWireType:function(e,r){var o=i(),a=r.length,s=_malloc(4+a*t);HEAPU32[s>>2]=a;for(var l=s+4>>n,c=0;c<a;++c)o[l+c]=r.charCodeAt(c);return null!==e&&e.push(_free,s),s},argPackAdvance:8,readValueFromPointer:simpleReadValueFromPointer,destructorFunction:function(e){_free(e)}})}function __embind_register_void(e,t){registerType(e,{isVoid:!0,name:t=readLatin1String(t),argPackAdvance:0,fromWireType:function(){},toWireType:function(e,t){}})}var _emscripten_asm_const_int=!0;function _emscripten_memcpy_big(e,t,r){return HEAPU8.set(HEAPU8.subarray(t,t+r),e),e}function ___setErrNo(e){return Module.___errno_location&&(HEAP32[Module.___errno_location()>>2]=e),e}embind_init_charCodes(),BindingError=Module.BindingError=extendError(Error,"BindingError"),InternalError=Module.InternalError=extendError(Error,"InternalError"),init_emval(),UnboundTypeError=Module.UnboundTypeError=extendError(Error,"UnboundTypeError"),DYNAMICTOP_PTR=staticAlloc(4),STACK_BASE=STACKTOP=alignMemory(STATICTOP),DYNAMIC_BASE=alignMemory(STACK_MAX=STACK_BASE+TOTAL_STACK),HEAP32[DYNAMICTOP_PTR>>2]=DYNAMIC_BASE,staticSealed=!0;var ASSERTIONS=!1;function intArrayFromString(e,t,r){var i=r>0?r:lengthBytesUTF8(e)+1,n=new Array(i),o=stringToUTF8Array(e,n,0,n.length);return t&&(n.length=o),n}function intArrayToString(e){for(var t=[],r=0;r<e.length;r++){var i=e[r];i>255&&(ASSERTIONS&&assert(!1,"Character code "+i+" ("+String.fromCharCode(i)+")  at offset "+r+" not in 0x00-0xFF."),i&=255),t.push(String.fromCharCode(i))}return t.join("")}var decodeBase64="function"==typeof atob?atob:function(e){var t,r,i,n,o,a,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="",c=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{t=s.indexOf(e.charAt(c++))<<2|(n=s.indexOf(e.charAt(c++)))>>4,r=(15&n)<<4|(o=s.indexOf(e.charAt(c++)))>>2,i=(3&o)<<6|(a=s.indexOf(e.charAt(c++))),l+=String.fromCharCode(t),64!==o&&(l+=String.fromCharCode(r)),64!==a&&(l+=String.fromCharCode(i))}while(c<e.length);return l};function intArrayFromBase64(e){if("boolean"==typeof ENVIRONMENT_IS_NODE&&ENVIRONMENT_IS_NODE){var t;try{t=Buffer.from(e,"base64")}catch(r){t=new Buffer(e,"base64")}return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}try{for(var r=decodeBase64(e),i=new Uint8Array(r.length),n=0;n<r.length;++n)i[n]=r.charCodeAt(n);return i}catch(e){throw new Error("Converting base64 string to bytes failed.")}}function tryParseAsDataURI(e){if(isDataURI(e))return intArrayFromBase64(e.slice(dataURIPrefix.length))}function invoke_i(e){try{return Module.dynCall_i(e)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_ii(e,t){try{return Module.dynCall_ii(e,t)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_iiii(e,t,r,i){try{return Module.dynCall_iiii(e,t,r,i)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_vi(e,t){try{Module.dynCall_vi(e,t)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_viiii(e,t,r,i,n){try{Module.dynCall_viiii(e,t,r,i,n)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_viiiii(e,t,r,i,n,o){try{Module.dynCall_viiiii(e,t,r,i,n,o)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_viiiiii(e,t,r,i,n,o,a){try{Module.dynCall_viiiiii(e,t,r,i,n,o,a)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}Module.asmGlobalArg={Math:Math,Int8Array:Int8Array,Int16Array:Int16Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:1/0},Module.asmLibraryArg={abort:abort,assert:assert,enlargeMemory:enlargeMemory,getTotalMemory:getTotalMemory,abortOnCannotGrowMemory:abortOnCannotGrowMemory,invoke_i:invoke_i,invoke_ii:invoke_ii,invoke_iiii:invoke_iiii,invoke_vi:invoke_vi,invoke_viiii:invoke_viiii,invoke_viiiii:invoke_viiiii,invoke_viiiiii:invoke_viiiiii,__ZSt18uncaught_exceptionv:__ZSt18uncaught_exceptionv,___cxa_find_matching_catch:___cxa_find_matching_catch,___gxx_personality_v0:___gxx_personality_v0,___resumeException:___resumeException,___setErrNo:___setErrNo,__embind_register_bool:__embind_register_bool,__embind_register_emval:__embind_register_emval,__embind_register_float:__embind_register_float,__embind_register_function:__embind_register_function,__embind_register_integer:__embind_register_integer,__embind_register_memory_view:__embind_register_memory_view,__embind_register_std_string:__embind_register_std_string,__embind_register_std_wstring:__embind_register_std_wstring,__embind_register_void:__embind_register_void,__emval_decref:__emval_decref,__emval_register:__emval_register,_embind_repr:_embind_repr,_emscripten_asm_const_iii:_emscripten_asm_const_iii,_emscripten_memcpy_big:_emscripten_memcpy_big,count_emval_handles:count_emval_handles,craftInvokerFunction:craftInvokerFunction,createNamedFunction:createNamedFunction,embind__requireFunction:embind__requireFunction,embind_init_charCodes:embind_init_charCodes,ensureOverloadTable:ensureOverloadTable,exposePublicSymbol:exposePublicSymbol,extendError:extendError,floatReadValueFromPointer:floatReadValueFromPointer,getShiftFromSize:getShiftFromSize,getTypeName:getTypeName,get_first_emval:get_first_emval,heap32VectorToArray:heap32VectorToArray,init_emval:init_emval,integerReadValueFromPointer:integerReadValueFromPointer,makeLegalFunctionName:makeLegalFunctionName,new_:new_,readLatin1String:readLatin1String,registerType:registerType,replacePublicSymbol:replacePublicSymbol,runDestructors:runDestructors,simpleReadValueFromPointer:simpleReadValueFromPointer,throwBindingError:throwBindingError,throwInternalError:throwInternalError,throwUnboundTypeError:throwUnboundTypeError,whenDependentTypesAreResolved:whenDependentTypesAreResolved,DYNAMICTOP_PTR:DYNAMICTOP_PTR,tempDoublePtr:tempDoublePtr,ABORT:ABORT,STACKTOP:STACKTOP,STACK_MAX:STACK_MAX};var initialStackTop,asm=function(e,t,r){"use asm";var i=new e.Int8Array(r);var n=new e.Int16Array(r);var o=new e.Int32Array(r);var a=new e.Uint8Array(r);var s=new e.Uint16Array(r);var l=new e.Uint32Array(r);var c=new e.Float32Array(r);var u=new e.Float64Array(r);var d=t.DYNAMICTOP_PTR|0;var h=t.tempDoublePtr|0;var f=t.ABORT|0;var p=t.STACKTOP|0;var m=t.STACK_MAX|0;var v=0;var g=0;var y=0;var b=0;var E=e.NaN,A=e.Infinity;var _=0,w=0,T=0,R=0,k=0.0;var M=0;var x=e.Math.floor;var S=e.Math.abs;var C=e.Math.sqrt;var I=e.Math.pow;var N=e.Math.cos;var D=e.Math.sin;var O=e.Math.tan;var P=e.Math.acos;var H=e.Math.asin;var j=e.Math.atan;var L=e.Math.atan2;var F=e.Math.exp;var B=e.Math.log;var V=e.Math.ceil;var U=e.Math.imul;var z=e.Math.min;var G=e.Math.max;var W=e.Math.clz32;var K=t.abort;var X=t.assert;var q=t.enlargeMemory;var Z=t.getTotalMemory;var Y=t.abortOnCannotGrowMemory;var J=t.invoke_i;var Q=t.invoke_ii;var $=t.invoke_iiii;var ee=t.invoke_vi;var te=t.invoke_viiii;var re=t.invoke_viiiii;var ie=t.invoke_viiiiii;var ne=t.__ZSt18uncaught_exceptionv;var oe=t.___cxa_find_matching_catch;var ae=t.___gxx_personality_v0;var se=t.___resumeException;var le=t.___setErrNo;var ce=t.__embind_register_bool;var ue=t.__embind_register_emval;var de=t.__embind_register_float;var he=t.__embind_register_function;var fe=t.__embind_register_integer;var pe=t.__embind_register_memory_view;var me=t.__embind_register_std_string;var ve=t.__embind_register_std_wstring;var ge=t.__embind_register_void;var ye=t.__emval_decref;var be=t.__emval_register;var Ee=t._embind_repr;var Ae=t._emscripten_asm_const_iii;var _e=t._emscripten_memcpy_big;var we=t.count_emval_handles;var Te=t.craftInvokerFunction;var Re=t.createNamedFunction;var ke=t.embind__requireFunction;var Me=t.embind_init_charCodes;var xe=t.ensureOverloadTable;var Se=t.exposePublicSymbol;var Ce=t.extendError;var Ie=t.floatReadValueFromPointer;var Ne=t.getShiftFromSize;var De=t.getTypeName;var Oe=t.get_first_emval;var Pe=t.heap32VectorToArray;var He=t.init_emval;var je=t.integerReadValueFromPointer;var Le=t.makeLegalFunctionName;var Fe=t.new_;var Be=t.readLatin1String;var Ve=t.registerType;var Ue=t.replacePublicSymbol;var ze=t.runDestructors;var Ge=t.simpleReadValueFromPointer;var We=t.throwBindingError;var Ke=t.throwInternalError;var Xe=t.throwUnboundTypeError;var qe=t.whenDependentTypesAreResolved;var Ze=0.0;function Ye(e){e=e|0;var t=0;t=p;p=p+e|0;p=p+15&-16;return t|0}function Je(){return p|0}function Qe(e){e=e|0;p=e}function $e(e,t){e=e|0;t=t|0;p=e;m=t}function et(e,t){e=e|0;t=t|0;if((v|0)==0){v=e;g=t}}function tt(e){e=e|0;M=e}function rt(){return M|0}function it(){var e=0,t=0,r=0;r=p;e=Ae(0,536|0,96)|0;return 1}function nt(){var e=0,t=0;t=p;it()|0;return}function ot(){var e=0,t=0;t=p;at(0);return}function at(e){e=e|0;var t=0,r=0;r=p;st(1307,1);return}function st(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,o=0,a=0,s=0;s=p;p=p+16|0;r=s;i=ct(r)|0;n=ut(r)|0;o=ft()|0;he(e|0,i|0,n|0,o|0,1|0,t|0);p=s;return}function lt(e){e=e|0;var t=0,r=0,i=0,n=0,a=0;a=p;p=p+16|0;t=a;r=zi[e&1]()|0;o[t>>2]=r;i=dt(t)|0;p=a;return i|0}function ct(e){e=e|0;var t=0,r=0;r=p;return 1}function ut(e){e=e|0;var t=0,r=0,i=0;i=p;t=ht()|0;return t|0}function dt(e){e=e|0;var t=0,r=0,i=0;i=p;t=o[e>>2]|0;return t|0}function ht(){var e=0,t=0;t=p;return 384|0}function ft(){var e=0,t=0;t=p;return 1318|0}function pt(){var e=0,t=0;t=p;nt();ot();return}function mt(){var e=0,t=0;t=p;vt();return}function vt(){var e=0,t=0;t=p;gt(0);return}function gt(e){e=e|0;var t=0,r=0,i=0,n=0,o=0,a=0,s=0,l=0;l=p;t=yt()|0;ge(t|0,1321|0);r=bt()|0;ce(r|0,1326|0,1,1,0);Et();At();_t();wt();Tt();Rt();kt();Mt();xt();St();Ct();i=It()|0;me(i|0,1331|0);n=Nt()|0;me(n|0,1343|0);o=Dt()|0;ve(o|0,4,1376|0);a=Ot()|0;ue(a|0,1389|0);Pt();Ht(1405);jt(1442);Lt(1481);Ft(1512);Bt(1552);Vt(1581);Ut();zt();Ht(1619);jt(1651);Lt(1684);Ft(1717);Bt(1751);Vt(1784);Gt();Wt();Kt();return}function yt(){var e=0,t=0,r=0;r=p;e=Gr()|0;return e|0}function bt(){var e=0,t=0,r=0;r=p;e=zr()|0;return e|0}function Et(){var e=0,t=0,r=0;r=p;e=Vr()|0;fe(e|0,2731|0,1,-128,127);return}function At(){var e=0,t=0,r=0;r=p;e=Fr()|0;fe(e|0,2719|0,1,-128,127);return}function _t(){var e=0,t=0,r=0;r=p;e=jr()|0;fe(e|0,2705|0,1,0,255);return}function wt(){var e=0,t=0,r=0;r=p;e=Pr()|0;fe(e|0,2699|0,2,-32768,32767);return}function Tt(){var e=0,t=0,r=0;r=p;e=Dr()|0;fe(e|0,2684|0,2,0,65535);return}function Rt(){var e=0,t=0,r=0;r=p;e=Ir()|0;fe(e|0,2680|0,4,-2147483648,2147483647);return}function kt(){var e=0,t=0,r=0;r=p;e=Sr()|0;fe(e|0,2667|0,4,0,-1);return}function Mt(){var e=0,t=0,r=0;r=p;e=Mr()|0;fe(e|0,2662|0,4,-2147483648,2147483647);return}function xt(){var e=0,t=0,r=0;r=p;e=Rr()|0;fe(e|0,2648|0,4,0,-1);return}function St(){var e=0,t=0,r=0;r=p;e=wr()|0;de(e|0,2642|0,4);return}function Ct(){var e=0,t=0,r=0;r=p;e=Ar()|0;de(e|0,2635|0,8);return}function It(){var e=0,t=0,r=0;r=p;e=Er()|0;return e|0}function Nt(){var e=0,t=0,r=0;r=p;e=br()|0;return e|0}function Dt(){var e=0,t=0,r=0;r=p;e=yr()|0;return e|0}function Ot(){var e=0,t=0,r=0;r=p;e=gr()|0;return e|0}function Pt(){var e=0,t=0,r=0;r=p;e=mr()|0;pe(e|0,0,2328|0);return}function Ht(e){e=e|0;var t=0,r=0,i=0;i=p;t=fr()|0;pe(t|0,0,e|0);return}function jt(e){e=e|0;var t=0,r=0,i=0;i=p;t=dr()|0;pe(t|0,1,e|0);return}function Lt(e){e=e|0;var t=0,r=0,i=0;i=p;t=cr()|0;pe(t|0,2,e|0);return}function Ft(e){e=e|0;var t=0,r=0,i=0;i=p;t=sr()|0;pe(t|0,3,e|0);return}function Bt(e){e=e|0;var t=0,r=0,i=0;i=p;t=or()|0;pe(t|0,4,e|0);return}function Vt(e){e=e|0;var t=0,r=0,i=0;i=p;t=ir()|0;pe(t|0,5,e|0);return}function Ut(){var e=0,t=0,r=0;r=p;e=tr()|0;pe(e|0,4,2081|0);return}function zt(){var e=0,t=0,r=0;r=p;e=$t()|0;pe(e|0,5,2011|0);return}function Gt(){var e=0,t=0,r=0;r=p;e=Jt()|0;pe(e|0,6,1949|0);return}function Wt(){var e=0,t=0,r=0;r=p;e=Zt()|0;pe(e|0,7,1886|0);return}function Kt(){var e=0,t=0,r=0;r=p;e=Xt()|0;pe(e|0,7,1818|0);return}function Xt(){var e=0,t=0,r=0;r=p;e=qt()|0;return e|0}function qt(){var e=0,t=0;t=p;return 8|0}function Zt(){var e=0,t=0,r=0;r=p;e=Yt()|0;return e|0}function Yt(){var e=0,t=0;t=p;return 16|0}function Jt(){var e=0,t=0,r=0;r=p;e=Qt()|0;return e|0}function Qt(){var e=0,t=0;t=p;return 24|0}function $t(){var e=0,t=0,r=0;r=p;e=er()|0;return e|0}function er(){var e=0,t=0;t=p;return 32|0}function tr(){var e=0,t=0,r=0;r=p;e=rr()|0;return e|0}function rr(){var e=0,t=0;t=p;return 40|0}function ir(){var e=0,t=0,r=0;r=p;e=nr()|0;return e|0}function nr(){var e=0,t=0;t=p;return 48|0}function or(){var e=0,t=0,r=0;r=p;e=ar()|0;return e|0}function ar(){var e=0,t=0;t=p;return 56|0}function sr(){var e=0,t=0,r=0;r=p;e=lr()|0;return e|0}function lr(){var e=0,t=0;t=p;return 64|0}function cr(){var e=0,t=0,r=0;r=p;e=ur()|0;return e|0}function ur(){var e=0,t=0;t=p;return 72|0}function dr(){var e=0,t=0,r=0;r=p;e=hr()|0;return e|0}function hr(){var e=0,t=0;t=p;return 80|0}function fr(){var e=0,t=0,r=0;r=p;e=pr()|0;return e|0}function pr(){var e=0,t=0;t=p;return 88|0}function mr(){var e=0,t=0,r=0;r=p;e=vr()|0;return e|0}function vr(){var e=0,t=0;t=p;return 96|0}function gr(){var e=0,t=0;t=p;return 104|0}function yr(){var e=0,t=0;t=p;return 112|0}function br(){var e=0,t=0;t=p;return 144|0}function Er(){var e=0,t=0;t=p;return 168|0}function Ar(){var e=0,t=0,r=0;r=p;e=_r()|0;return e|0}function _r(){var e=0,t=0;t=p;return 360|0}function wr(){var e=0,t=0,r=0;r=p;e=Tr()|0;return e|0}function Tr(){var e=0,t=0;t=p;return 352|0}function Rr(){var e=0,t=0,r=0;r=p;e=kr()|0;return e|0}function kr(){var e=0,t=0;t=p;return 344|0}function Mr(){var e=0,t=0,r=0;r=p;e=xr()|0;return e|0}function xr(){var e=0,t=0;t=p;return 336|0}function Sr(){var e=0,t=0,r=0;r=p;e=Cr()|0;return e|0}function Cr(){var e=0,t=0;t=p;return 328|0}function Ir(){var e=0,t=0,r=0;r=p;e=Nr()|0;return e|0}function Nr(){var e=0,t=0;t=p;return 320|0}function Dr(){var e=0,t=0,r=0;r=p;e=Or()|0;return e|0}function Or(){var e=0,t=0;t=p;return 312|0}function Pr(){var e=0,t=0,r=0;r=p;e=Hr()|0;return e|0}function Hr(){var e=0,t=0;t=p;return 304|0}function jr(){var e=0,t=0,r=0;r=p;e=Lr()|0;return e|0}function Lr(){var e=0,t=0;t=p;return 288|0}function Fr(){var e=0,t=0,r=0;r=p;e=Br()|0;return e|0}function Br(){var e=0,t=0;t=p;return 296|0}function Vr(){var e=0,t=0,r=0;r=p;e=Ur()|0;return e|0}function Ur(){var e=0,t=0;t=p;return 280|0}function zr(){var e=0,t=0;t=p;return 272|0}function Gr(){var e=0,t=0;t=p;return 264|0}function Wr(e){e=e|0;var t=0,r=0,i=0,n=0,a=0;a=p;t=e+4|0;r=o[t>>2]|0;i=Yr(r)|0;return i|0}function Kr(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,s=0,l=0,c=0,u=0,d=0,h=0,f=0,m=0,v=0,g=0,y=0,b=0,E=0,A=0,_=0;var w=0,T=0,R=0,k=0,M=0,x=0,S=0,C=0,I=0,N=0,D=0,O=0,P=0,H=0,j=0,L=0,F=0,B=0,V=0,U=0;var z=0,G=0,W=0,K=0,X=0,q=0,Z=0,Y=0,J=0,Q=0,$=0,ee=0,te=0,re=0,ie=0,ne=0,oe=0,ae=0,se=0,le=0;var ce=0,ue=0,de=0,he=0,fe=0,pe=0,me=0,ve=0,ge=0,ye=0,be=0,Ee=0,Ae=0,_e=0,we=0,Te=0,Re=0,ke=0,Me=0,xe=0;var Se=0,Ce=0,Ie=0,Ne=0,De=0,Oe=0,Pe=0,He=0,je=0,Le=0,Fe=0,Be=0,Ve=0,Ue=0,ze=0,Ge=0,We=0,Ke=0,Xe=0,qe=0;var Ze=0,Ye=0,Je=0,Qe=0,$e=0,et=0,tt=0,rt=0,it=0,nt=0,ot=0,at=0,st=0,lt=0,ct=0,ut=0,dt=0,ht=0,ft=0,pt=0;var mt=0,vt=0,gt=0,yt=0,bt=0,Et=0,At=0,_t=0,wt=0,Tt=0,Rt=0,kt=0,Mt=0,xt=0,St=0,Ct=0,It=0,Nt=0,Dt=0,Ot=0;var Pt=0,Ht=0,jt=0,Lt=0,Ft=0,Bt=0,Vt=0,Ut=0,zt=0,Gt=0,Wt=0,Kt=0,Xt=0,qt=0,Zt=0,Yt=0,Jt=0,Qt=0,$t=0,er=0;var tr=0,rr=0,ir=0,nr=0,or=0,ar=0,sr=0,lr=0,cr=0,ur=0,dr=0,hr=0,fr=0,pr=0,mr=0,vr=0,gr=0,yr=0,br=0,Er=0;var Ar=0,_r=0,wr=0,Tr=0,Rr=0,kr=0,Mr=0,xr=0,Sr=0,Cr=0,Ir=0,Nr=0,Dr=0,Or=0,Pr=0,Hr=0,jr=0,Lr=0,Fr=0,Br=0;var Vr=0,Ur=0,zr=0,Gr=0,Wr=0,Kr=0,Xr=0,Zr=0,Yr=0,Jr=0,Qr=0,$r=0,ei=0,ti=0,ri=0,ii=0,ni=0,oi=0,ai=0,si=0;var li=0,ci=0,ui=0,di=0,hi=0,fi=0,pi=0,mi=0,vi=0,gi=0,yi=0,bi=0,Ei=0,Ai=0,_i=0,wi=0,Ti=0,Ri=0,ki=0,Mi=0;var Si=0,Ci=0,Ii=0,Ni=0,Di=0,Oi=0,Pi=0,Hi=0,ji=0,Li=0,Fi=0,Bi=0,Vi=0,Ui=0,zi=0,Gi=0,Wi=0,Ki=0,Xi=0,qi=0;var Zi=0,Yi=0,Ji=0,Qi=0,$i=0,en=0,tn=0,rn=0,nn=0,on=0,an=0,sn=0,ln=0,cn=0,un=0,dn=0,hn=0,fn=0,pn=0,mn=0;var vn=0,gn=0,yn=0,bn=0,En=0,An=0,_n=0,wn=0,Tn=0,Rn=0,kn=0,Mn=0,xn=0,Sn=0,Cn=0,In=0,Nn=0,Dn=0,On=0,Pn=0;var Hn=0,jn=0,Ln=0,Fn=0,Bn=0,Vn=0,Un=0,zn=0,Gn=0,Wn=0,Kn=0,Xn=0,qn=0,Zn=0,Yn=0,Jn=0,Qn=0,$n=0,eo=0,to=0;var ro=0,io=0,no=0,oo=0,ao=0,so=0,lo=0,co=0,uo=0,ho=0,fo=0,po=0,mo=0,vo=0,go=0,yo=0,bo=0,Eo=0,Ao=0,_o=0;var wo=0,To=0,Ro=0,ko=0,Mo=0,xo=0,So=0,Co=0,Io=0,No=0,Do=0,Oo=0,Po=0,Ho=0,jo=0,Lo=0,Fo=0,Bo=0,Vo=0,Uo=0;var zo=0,Go=0,Wo=0,Ko=0,Xo=0,qo=0,Zo=0,Yo=0,Jo=0,Qo=0,$o=0,ea=0,ta=0,ra=0,ia=0,na=0,oa=0,aa=0,sa=0,la=0;var ca=0,ua=0,da=0,ha=0,fa=0,pa=0,ma=0,va=0,ga=0,ya=0,ba=0,Ea=0,Aa=0,_a=0,wa=0,Ta=0,Ra=0,ka=0,Ma=0,xa=0;var Sa=0,Ca=0,Ia=0,Na=0,Da=0,Oa=0,Pa=0,Ha=0,ja=0,La=0,Fa=0,Ba=0,Va=0,Ua=0,za=0,Ga=0,Wa=0,Ka=0,Xa=0,qa=0;var Za=0,Ya=0,Ja=0,Qa=0,$a=0,es=0,ts=0,rs=0,is=0,ns=0,os=0,as=0,ss=0,ls=0,cs=0,us=0,ds=0,hs=0,fs=0,ps=0;var ms=0,vs=0,gs=0,ys=0,bs=0,Es=0,As=0,_s=0,ws=0,Ts=0,Rs=0,ks=0,Ms=0,xs=0,Ss=0,Cs=0,Is=0,Ns=0,Ds=0,Os=0;var Ps=0,Hs=0,js=0,Ls=0,Fs=0,Bs=0,Vs=0,Us=0,zs=0,Gs=0,Ws=0,Ks=0,Xs=0,qs=0,Zs=0,Ys=0,Js=0,Qs=0,$s=0,el=0;var tl=0,rl=0,il=0,nl=0,ol=0,al=0,sl=0,ll=0,cl=0,ul=0,dl=0,hl=0,fl=0,pl=0,ml=0,vl=0,gl=0,yl=0,bl=0,El=0;var Al=0,_l=0,wl=0,Tl=0,Rl=0,kl=0,Ml=0,xl=0,Sl=0,Cl=0,Il=0,Nl=0,Dl=0,Ol=0,Pl=0,Hl=0,jl=0,Ll=0,Fl=0,Bl=0;var Vl=0,Ul=0,zl=0,Gl=0,Wl=0,Kl=0,Xl=0,ql=0,Zl=0,Yl=0,Jl=0,Ql=0,$l=0,ec=0,tc=0,rc=0,ic=0,nc=0,oc=0,ac=0;var sc=0,lc=0,cc=0,uc=0,dc=0,hc=0,fc=0,pc=0,mc=0,vc=0,gc=0,yc=0,bc=0,Ec=0,Ac=0,_c=0,wc=0,Tc=0,Rc=0,kc=0;var Mc=0,xc=0,Sc=0,Cc=0,Ic=0,Nc=0,Dc=0,Oc=0,Pc=0,Hc=0,jc=0,Lc=0,Fc=0,Bc=0,Vc=0,Uc=0,zc=0,Gc=0,Wc=0,Kc=0;var Xc=0,qc=0,Zc=0,Yc=0,Jc=0,Qc=0,$c=0,eu=0,tu=0,ru=0,iu=0,nu=0,ou=0,au=0,su=0,lu=0,cu=0,uu=0,du=0,hu=0;var fu=0,pu=0,mu=0,vu=0,gu=0,yu=0,bu=0,Eu=0,Au=0,_u=0,wu=0,Tu=0,Ru=0,ku=0,Mu=0,xu=0,Su=0,Cu=0,Iu=0,Nu=0;var Du=0,Ou=0,Pu=0,Hu=0,ju=0,Lu=0,Fu=0,Bu=0,Vu=0,Uu=0,zu=0,Gu=0,Wu=0,Ku=0,Xu=0,qu=0,Zu=0,Yu=0,Ju=0,Qu=0;var $u=0,ed=0,td=0,rd=0,id=0,nd=0,od=0,ad=0,sd=0,ld=0,cd=0,ud=0,dd=0,hd=0,fd=0,pd=0,md=0,vd=0,gd=0,yd=0;var bd=0,Ed=0,Ad=0,_d=0,wd=0,Td=0,Rd=0,kd=0,Md=0,xd=0,Sd=0,Cd=0,Id=0,Nd=0,Dd=0,Od=0,Pd=0,Hd=0,jd=0,Ld=0;var Fd=0,Bd=0,Vd=0,Ud=0,zd=0,Gd=0,Wd=0,Kd=0,Xd=0,qd=0,Zd=0,Yd=0,Jd=0,Qd=0,$d=0,eh=0,th=0,rh=0,ih=0,nh=0;var oh=0,ah=0,sh=0,lh=0,ch=0,uh=0,dh=0,hh=0,fh=0,ph=0,mh=0,vh=0,gh=0,yh=0,bh=0,Eh=0,Ah=0,_h=0,wh=0,Th=0;var Rh=0,kh=0,Mh=0,xh=0,Sh=0,Ch=0,Ih=0,Nh=0,Dh=0,Oh=0,Ph=0,Hh=0,jh=0,Lh=0,Fh=0,Bh=0,Vh=0,Uh=0,zh=0,Gh=0;var Wh=0,Kh=0,Xh=0,qh=0,Zh=0,Yh=0,Jh=0,Qh=0,$h=0,ef=0,tf=0,rf=0,nf=0,of=0,af=0,sf=0,lf=0,cf=0,uf=0,df=0;var hf=0,ff=0,pf=0,mf=0,vf=0,gf=0,yf=0,bf=0,Ef=0,Af=0,_f=0,wf=0,Tf=0,Rf=0,kf=0,Mf=0,xf=0,Sf=0,Cf=0,If=0;var Nf=0,Df=0,Of=0,Pf=0,Hf=0,jf=0,Lf=0,Ff=0,Bf=0,Vf=0,Uf=0,zf=0,Gf=0,Wf=0,Kf=0,Xf=0,qf=0,Zf=0,Yf=0,Jf=0;var Qf=0,$f=0,ep=0,tp=0,rp=0,ip=0,np=0,op=0,ap=0,sp=0,lp=0,cp=0,up=0,dp=0,hp=0,fp=0,pp=0,mp=0,vp=0,gp=0;var yp=0,bp=0,Ep=0,Ap=0,_p=0,wp=0,Tp=0,Rp=0,kp=0,Mp=0,xp=0,Sp=0,Cp=0,Ip=0,Np=0,Dp=0,Op=0,Pp=0,Hp=0,jp=0;var Lp=0,Fp=0,Bp=0,Vp=0,Up=0,zp=0,Gp=0,Wp=0,Kp=0,Xp=0,qp=0,Zp=0,Yp=0,Jp=0,Qp=0,$p=0,em=0,tm=0,rm=0,im=0;var nm=0,om=0,am=0,sm=0,lm=0,cm=0,um=0,dm=0,hm=0,fm=0,pm=0,mm=0,vm=0,gm=0,ym=0,bm=0,Em=0,Am=0,_m=0,wm=0;var Tm=0,Rm=0,km=0,Mm=0,xm=0,Sm=0,Cm=0,Im=0,Nm=0,Dm=0,Om=0,Pm=0,Hm=0,jm=0,Lm=0,Fm=0,Bm=0,Vm=0,Um=0,zm=0;var Gm=0,Wm=0,Km=0,Xm=0,qm=0,Zm=0,Ym=0,Jm=0,Qm=0,$m=0,ev=0,tv=0,rv=0,iv=0,nv=0,ov=0,av=0,sv=0,lv=0,cv=0;var uv=0,dv=0,hv=0,fv=0,pv=0,mv=0,vv=0,gv=0,yv=0,bv=0,Ev=0,Av=0,_v=0,wv=0,Tv=0,Rv=0,kv=0,Mv=0,xv=0,Sv=0;var Cv=0,Iv=0,Nv=0,Dv=0,Ov=0,Pv=0,Hv=0,jv=0,Lv=0,Fv=0,Bv=0,Vv=0,Uv=0,zv=0,Gv=0,Wv=0,Kv=0,Xv=0,qv=0,Zv=0;var Yv=0,Jv=0,Qv=0,$v=0,eg=0,tg=0,rg=0,ig=0,ng=0,og=0,ag=0,sg=0,lg=0,cg=0,ug=0,dg=0,hg=0,fg=0,pg=0,mg=0;var vg=0,gg=0,yg=0,bg=0,Eg=0,Ag=0,_g=0,wg=0,Tg=0,Rg=0,kg=0,Mg=0,xg=0,Sg=0,Cg=0,Ig=0,Ng=0,Dg=0,Og=0,Pg=0;var Hg=0,jg=0,Lg=0,Fg=0,Bg=0,Vg=0,Ug=0,zg=0,Gg=0,Wg=0,Kg=0,Xg=0,qg=0,Zg=0,Yg=0,Jg=0,Qg=0,$g=0,ey=0,ty=0;var ry=0,iy=0,ny=0,oy=0,ay=0,sy=0,ly=0,cy=0,uy=0,dy=0,hy=0,fy=0,py=0,my=0,vy=0,gy=0,yy=0,by=0,Ey=0,Ay=0;var _y=0,wy=0,Ty=0,Ry=0,ky=0,My=0,xy=0,Sy=0,Cy=0,Iy=0,Ny=0,Dy=0,Oy=0,Py=0,Hy=0,jy=0,Ly=0,Fy=0,By=0,Vy=0;var Uy=0,zy=0,Gy=0,Wy=0,Ky=0,Xy=0,qy=0,Zy=0,Yy=0,Jy=0,Qy=0,$y=0,eb=0,tb=0,rb=0;rb=p;p=p+16|0;De=rb;Hr=e>>>0<245;do{if(Hr){Un=e>>>0<11;Ka=e+11|0;Zl=Ka&-8;Qu=Un?16:Zl;tf=Qu>>>3;om=o[740]|0;lg=om>>>tf;Oe=lg&3;We=(Oe|0)==0;if(!We){rt=lg&1;ft=rt^1;Tt=ft+tf|0;Pt=Tt<<1;Kt=3000+(Pt<<2)|0;ir=Kt+8|0;pr=o[ir>>2]|0;Rr=pr+8|0;jr=o[Rr>>2]|0;Zr=(jr|0)==(Kt|0);if(Zr){ai=1<<Tt;gi=ai^-1;Si=om&gi;o[740]=Si}else{Bi=jr+12|0;o[Bi>>2]=Kt;o[ir>>2]=jr}Ji=Tt<<3;cn=Ji|3;En=pr+4|0;o[En>>2]=cn;In=pr+Ji|0;zn=In+4|0;eo=o[zn>>2]|0;ho=eo|1;o[zn>>2]=ho;s=Rr;p=rb;return s|0}wo=o[2968>>2]|0;Oo=Qu>>>0>wo>>>0;if(Oo){Wo=(lg|0)==0;if(!Wo){ra=lg<<tf;fa=2<<tf;Ta=0-fa|0;Pa=fa|Ta;Xa=ra&Pa;ns=0-Xa|0;ms=Xa&ns;ks=ms+-1|0;js=ks>>>12;qs=js&16;ol=ks>>>qs;vl=ol>>>5;Ml=vl&8;Ll=Ml|qs;Yl=ol>>>Ml;sc=Yl>>>2;yc=sc&4;Sc=Ll|yc;Bc=Yl>>>yc;Jc=Bc>>>1;lu=Jc&2;bu=Sc|lu;Cu=Bc>>>lu;Vu=Cu>>>1;$u=Vu&1;ud=bu|$u;Ad=Cu>>>$u;Nd=ud+Ad|0;zd=Nd<<1;eh=3000+(zd<<2)|0;dh=eh+8|0;_h=o[dh>>2]|0;Dh=_h+8|0;Gh=o[Dh>>2]|0;rf=(Gh|0)==(eh|0);if(rf){pf=1<<Nd;Rf=pf^-1;Hf=om&Rf;o[740]=Hf;cg=Hf}else{Xf=Gh+12|0;o[Xf>>2]=eh;o[dh>>2]=Gh;cg=om}np=Nd<<3;mp=np-Qu|0;kp=Qu|3;jp=_h+4|0;o[jp>>2]=kp;qp=_h+Qu|0;am=mp|1;gm=qp+4|0;o[gm>>2]=am;xm=_h+np|0;o[xm>>2]=mp;Fm=(wo|0)==0;if(!Fm){Ym=o[2980>>2]|0;sv=wo>>>3;yv=sv<<1;Sv=3000+(yv<<2)|0;Bv=1<<sv;Jv=cg&Bv;Eg=(Jv|0)==0;if(Eg){Ig=cg|Bv;o[740]=Ig;ve=Sv+8|0;y=Sv;ke=ve}else{Ug=Sv+8|0;$g=o[Ug>>2]|0;y=$g;ke=Ug}o[ke>>2]=Ym;uy=y+12|0;o[uy>>2]=Ym;Ay=Ym+8|0;o[Ay>>2]=y;Ny=Ym+12|0;o[Ny>>2]=Sv}o[2968>>2]=mp;o[2980>>2]=qp;s=Dh;p=rb;return s|0}Py=o[2964>>2]|0;Hy=(Py|0)==0;if(Hy){g=Qu}else{Pe=0-Py|0;He=Py&Pe;je=He+-1|0;Le=je>>>12;Fe=Le&16;Be=je>>>Fe;Ve=Be>>>5;Ue=Ve&8;ze=Ue|Fe;Ge=Be>>>Ue;Ke=Ge>>>2;Xe=Ke&4;qe=ze|Xe;Ze=Ge>>>Xe;Ye=Ze>>>1;Je=Ye&2;Qe=qe|Je;$e=Ze>>>Je;et=$e>>>1;tt=et&1;it=Qe|tt;nt=$e>>>tt;ot=it+nt|0;at=3264+(ot<<2)|0;st=o[at>>2]|0;lt=st+4|0;ct=o[lt>>2]|0;ut=ct&-8;dt=ut-Qu|0;ht=st+16|0;pt=o[ht>>2]|0;mt=(pt|0)==(0|0);Se=mt&1;vt=(st+16|0)+(Se<<2)|0;gt=o[vt>>2]|0;yt=(gt|0)==(0|0);if(yt){h=st;m=dt}else{f=st;v=dt;Et=gt;while(1){bt=Et+4|0;At=o[bt>>2]|0;_t=At&-8;wt=_t-Qu|0;Rt=wt>>>0<v>>>0;r=Rt?wt:v;t=Rt?Et:f;kt=Et+16|0;Mt=o[kt>>2]|0;xt=(Mt|0)==(0|0);Me=xt&1;St=(Et+16|0)+(Me<<2)|0;Ct=o[St>>2]|0;It=(Ct|0)==(0|0);if(It){h=t;m=r;break}else{f=t;v=r;Et=Ct}}}Nt=h+Qu|0;Dt=Nt>>>0>h>>>0;if(Dt){Ot=h+24|0;Ht=o[Ot>>2]|0;jt=h+12|0;Lt=o[jt>>2]|0;Ft=(Lt|0)==(h|0);do{if(Ft){Gt=h+20|0;Wt=o[Gt>>2]|0;Xt=(Wt|0)==(0|0);if(Xt){qt=h+16|0;Zt=o[qt>>2]|0;Yt=(Zt|0)==(0|0);if(Yt){ee=0;break}else{B=Zt;V=qt}}else{B=Wt;V=Gt}while(1){Jt=B+20|0;Qt=o[Jt>>2]|0;$t=(Qt|0)==(0|0);if(!$t){B=Qt;V=Jt;continue}er=B+16|0;tr=o[er>>2]|0;rr=(tr|0)==(0|0);if(rr){break}else{B=tr;V=er}}o[V>>2]=0;ee=B}else{Bt=h+8|0;Vt=o[Bt>>2]|0;Ut=Vt+12|0;o[Ut>>2]=Lt;zt=Lt+8|0;o[zt>>2]=Vt;ee=Lt}}while(0);nr=(Ht|0)==(0|0);do{if(!nr){or=h+28|0;ar=o[or>>2]|0;sr=3264+(ar<<2)|0;lr=o[sr>>2]|0;cr=(h|0)==(lr|0);if(cr){o[sr>>2]=ee;jy=(ee|0)==(0|0);if(jy){ur=1<<ar;dr=ur^-1;hr=Py&dr;o[2964>>2]=hr;break}}else{fr=Ht+16|0;mr=o[fr>>2]|0;vr=(mr|0)!=(h|0);Ce=vr&1;gr=(Ht+16|0)+(Ce<<2)|0;o[gr>>2]=ee;yr=(ee|0)==(0|0);if(yr){break}}br=ee+24|0;o[br>>2]=Ht;Er=h+16|0;Ar=o[Er>>2]|0;_r=(Ar|0)==(0|0);if(!_r){wr=ee+16|0;o[wr>>2]=Ar;Tr=Ar+24|0;o[Tr>>2]=ee}kr=h+20|0;Mr=o[kr>>2]|0;xr=(Mr|0)==(0|0);if(!xr){Sr=ee+20|0;o[Sr>>2]=Mr;Cr=Mr+24|0;o[Cr>>2]=ee}}}while(0);Ir=m>>>0<16;if(Ir){Nr=m+Qu|0;Dr=Nr|3;Or=h+4|0;o[Or>>2]=Dr;Pr=h+Nr|0;Lr=Pr+4|0;Fr=o[Lr>>2]|0;Br=Fr|1;o[Lr>>2]=Br}else{Vr=Qu|3;Ur=h+4|0;o[Ur>>2]=Vr;zr=m|1;Gr=Nt+4|0;o[Gr>>2]=zr;Wr=Nt+m|0;o[Wr>>2]=m;Kr=(wo|0)==0;if(!Kr){Xr=o[2980>>2]|0;Yr=wo>>>3;Jr=Yr<<1;Qr=3000+(Jr<<2)|0;$r=1<<Yr;ei=om&$r;ti=(ei|0)==0;if(ti){ri=om|$r;o[740]=ri;ge=Qr+8|0;l=Qr;Re=ge}else{ii=Qr+8|0;ni=o[ii>>2]|0;l=ni;Re=ii}o[Re>>2]=Xr;oi=l+12|0;o[oi>>2]=Xr;si=Xr+8|0;o[si>>2]=l;li=Xr+12|0;o[li>>2]=Qr}o[2968>>2]=m;o[2980>>2]=Nt}ci=h+8|0;s=ci;p=rb;return s|0}else{g=Qu}}}else{g=Qu}}else{ui=e>>>0>4294967231;if(ui){g=-1}else{di=e+11|0;hi=di&-8;fi=o[2964>>2]|0;pi=(fi|0)==0;if(pi){g=hi}else{mi=0-hi|0;vi=di>>>8;yi=(vi|0)==0;if(yi){O=0}else{bi=hi>>>0>16777215;if(bi){O=31}else{Ei=vi+1048320|0;Ai=Ei>>>16;_i=Ai&8;wi=vi<<_i;Ti=wi+520192|0;Ri=Ti>>>16;ki=Ri&4;Mi=ki|_i;Ci=wi<<ki;Ii=Ci+245760|0;Ni=Ii>>>16;Di=Ni&2;Oi=Mi|Di;Pi=14-Oi|0;Hi=Ci<<Di;ji=Hi>>>15;Li=Pi+ji|0;Fi=Li<<1;Vi=Li+7|0;Ui=hi>>>Vi;zi=Ui&1;Gi=zi|Fi;O=Gi}}Wi=3264+(O<<2)|0;Ki=o[Wi>>2]|0;Xi=(Ki|0)==(0|0);e:do{if(Xi){$=0;re=0;ie=mi;tb=57}else{qi=(O|0)==31;Zi=O>>>1;Yi=25-Zi|0;Qi=qi?0:Yi;$i=hi<<Qi;S=0;N=mi;D=Ki;H=$i;L=0;while(1){en=D+4|0;tn=o[en>>2]|0;rn=tn&-8;nn=rn-hi|0;on=nn>>>0<N>>>0;if(on){an=(nn|0)==0;if(an){ce=0;he=D;fe=D;tb=61;break e}else{W=D;K=nn}}else{W=S;K=N}sn=D+20|0;ln=o[sn>>2]|0;un=H>>>31;dn=(D+16|0)+(un<<2)|0;hn=o[dn>>2]|0;fn=(ln|0)==(0|0);pn=(ln|0)==(hn|0);Wy=fn|pn;X=Wy?L:ln;mn=(hn|0)==(0|0);Vy=mn^1;vn=Vy&1;P=H<<vn;if(mn){$=X;re=W;ie=K;tb=57;break}else{S=W;N=K;D=hn;H=P;L=X}}}}while(0);if((tb|0)==57){gn=($|0)==(0|0);yn=(re|0)==(0|0);zy=gn&yn;if(zy){bn=2<<O;An=0-bn|0;_n=bn|An;wn=fi&_n;Tn=(wn|0)==0;if(Tn){g=hi;break}Rn=0-wn|0;kn=wn&Rn;Mn=kn+-1|0;xn=Mn>>>12;Sn=xn&16;Cn=Mn>>>Sn;Nn=Cn>>>5;Dn=Nn&8;On=Dn|Sn;Pn=Cn>>>Dn;Hn=Pn>>>2;jn=Hn&4;Ln=On|jn;Fn=Pn>>>jn;Bn=Fn>>>1;Vn=Bn&2;Gn=Ln|Vn;Wn=Fn>>>Vn;Kn=Wn>>>1;Xn=Kn&1;qn=Gn|Xn;Zn=Wn>>>Xn;Yn=qn+Zn|0;Jn=3264+(Yn<<2)|0;Qn=o[Jn>>2]|0;ae=0;de=Qn}else{ae=re;de=$}$n=(de|0)==(0|0);if($n){oe=ae;le=ie}else{ce=ie;he=de;fe=ae;tb=61}}if((tb|0)==61){while(1){tb=0;to=he+4|0;ro=o[to>>2]|0;io=ro&-8;no=io-hi|0;oo=no>>>0<ce>>>0;n=oo?no:ce;ue=oo?he:fe;ao=he+16|0;so=o[ao>>2]|0;lo=(so|0)==(0|0);Ie=lo&1;co=(he+16|0)+(Ie<<2)|0;uo=o[co>>2]|0;fo=(uo|0)==(0|0);if(fo){oe=ue;le=n;break}else{ce=n;he=uo;fe=ue;tb=61}}}po=(oe|0)==(0|0);if(po){g=hi}else{mo=o[2968>>2]|0;vo=mo-hi|0;go=le>>>0<vo>>>0;if(go){yo=oe+hi|0;bo=yo>>>0>oe>>>0;if(!bo){s=0;p=rb;return s|0}Eo=oe+24|0;Ao=o[Eo>>2]|0;_o=oe+12|0;To=o[_o>>2]|0;Ro=(To|0)==(oe|0);do{if(Ro){Co=oe+20|0;Io=o[Co>>2]|0;No=(Io|0)==(0|0);if(No){Do=oe+16|0;Po=o[Do>>2]|0;Ho=(Po|0)==(0|0);if(Ho){ne=0;break}else{q=Po;Z=Do}}else{q=Io;Z=Co}while(1){jo=q+20|0;Lo=o[jo>>2]|0;Fo=(Lo|0)==(0|0);if(!Fo){q=Lo;Z=jo;continue}Bo=q+16|0;Vo=o[Bo>>2]|0;Uo=(Vo|0)==(0|0);if(Uo){break}else{q=Vo;Z=Bo}}o[Z>>2]=0;ne=q}else{ko=oe+8|0;Mo=o[ko>>2]|0;xo=Mo+12|0;o[xo>>2]=To;So=To+8|0;o[So>>2]=Mo;ne=To}}while(0);zo=(Ao|0)==(0|0);do{if(zo){xs=fi}else{Go=oe+28|0;Ko=o[Go>>2]|0;Xo=3264+(Ko<<2)|0;qo=o[Xo>>2]|0;Zo=(oe|0)==(qo|0);if(Zo){o[Xo>>2]=ne;Fy=(ne|0)==(0|0);if(Fy){Yo=1<<Ko;Jo=Yo^-1;Qo=fi&Jo;o[2964>>2]=Qo;xs=Qo;break}}else{$o=Ao+16|0;ea=o[$o>>2]|0;ta=(ea|0)!=(oe|0);Ne=ta&1;ia=(Ao+16|0)+(Ne<<2)|0;o[ia>>2]=ne;na=(ne|0)==(0|0);if(na){xs=fi;break}}oa=ne+24|0;o[oa>>2]=Ao;aa=oe+16|0;sa=o[aa>>2]|0;la=(sa|0)==(0|0);if(!la){ca=ne+16|0;o[ca>>2]=sa;ua=sa+24|0;o[ua>>2]=ne}da=oe+20|0;ha=o[da>>2]|0;pa=(ha|0)==(0|0);if(pa){xs=fi}else{ma=ne+20|0;o[ma>>2]=ha;va=ha+24|0;o[va>>2]=ne;xs=fi}}}while(0);ga=le>>>0<16;do{if(ga){ya=le+hi|0;ba=ya|3;Ea=oe+4|0;o[Ea>>2]=ba;Aa=oe+ya|0;_a=Aa+4|0;wa=o[_a>>2]|0;Ra=wa|1;o[_a>>2]=Ra}else{ka=hi|3;Ma=oe+4|0;o[Ma>>2]=ka;xa=le|1;Sa=yo+4|0;o[Sa>>2]=xa;Ca=yo+le|0;o[Ca>>2]=le;Ia=le>>>3;Na=le>>>0<256;if(Na){Da=Ia<<1;Oa=3000+(Da<<2)|0;Ha=o[740]|0;ja=1<<Ia;La=Ha&ja;Fa=(La|0)==0;if(Fa){Ba=Ha|ja;o[740]=Ba;Ae=Oa+8|0;F=Oa;Te=Ae}else{Va=Oa+8|0;Ua=o[Va>>2]|0;F=Ua;Te=Va}o[Te>>2]=yo;za=F+12|0;o[za>>2]=yo;Ga=yo+8|0;o[Ga>>2]=F;Wa=yo+12|0;o[Wa>>2]=Oa;break}qa=le>>>8;Za=(qa|0)==0;if(Za){j=0}else{Ya=le>>>0>16777215;if(Ya){j=31}else{Ja=qa+1048320|0;Qa=Ja>>>16;$a=Qa&8;es=qa<<$a;ts=es+520192|0;rs=ts>>>16;is=rs&4;os=is|$a;as=es<<is;ss=as+245760|0;ls=ss>>>16;cs=ls&2;us=os|cs;ds=14-us|0;hs=as<<cs;fs=hs>>>15;ps=ds+fs|0;vs=ps<<1;gs=ps+7|0;ys=le>>>gs;bs=ys&1;Es=bs|vs;j=Es}}As=3264+(j<<2)|0;_s=yo+28|0;o[_s>>2]=j;ws=yo+16|0;Ts=ws+4|0;o[Ts>>2]=0;o[ws>>2]=0;Rs=1<<j;Ms=xs&Rs;Ss=(Ms|0)==0;if(Ss){Cs=xs|Rs;o[2964>>2]=Cs;o[As>>2]=yo;Is=yo+24|0;o[Is>>2]=As;Ns=yo+12|0;o[Ns>>2]=yo;Ds=yo+8|0;o[Ds>>2]=yo;break}Os=o[As>>2]|0;Ps=(j|0)==31;Hs=j>>>1;Ls=25-Hs|0;Fs=Ps?0:Ls;Bs=le<<Fs;C=Bs;I=Os;while(1){Vs=I+4|0;Us=o[Vs>>2]|0;zs=Us&-8;Gs=(zs|0)==(le|0);if(Gs){tb=97;break}Ws=C>>>31;Ks=(I+16|0)+(Ws<<2)|0;Xs=C<<1;Zs=o[Ks>>2]|0;Ys=(Zs|0)==(0|0);if(Ys){tb=96;break}else{C=Xs;I=Zs}}if((tb|0)==96){o[Ks>>2]=yo;Js=yo+24|0;o[Js>>2]=I;Qs=yo+12|0;o[Qs>>2]=yo;$s=yo+8|0;o[$s>>2]=yo;break}else if((tb|0)==97){el=I+8|0;tl=o[el>>2]|0;rl=tl+12|0;o[rl>>2]=yo;o[el>>2]=yo;il=yo+8|0;o[il>>2]=tl;nl=yo+12|0;o[nl>>2]=I;al=yo+24|0;o[al>>2]=0;break}}}while(0);sl=oe+8|0;s=sl;p=rb;return s|0}else{g=hi}}}}}}while(0);ll=o[2968>>2]|0;cl=ll>>>0<g>>>0;if(!cl){ul=ll-g|0;dl=o[2980>>2]|0;hl=ul>>>0>15;if(hl){fl=dl+g|0;o[2980>>2]=fl;o[2968>>2]=ul;pl=ul|1;ml=fl+4|0;o[ml>>2]=pl;gl=dl+ll|0;o[gl>>2]=ul;yl=g|3;bl=dl+4|0;o[bl>>2]=yl}else{o[2968>>2]=0;o[2980>>2]=0;El=ll|3;Al=dl+4|0;o[Al>>2]=El;_l=dl+ll|0;wl=_l+4|0;Tl=o[wl>>2]|0;Rl=Tl|1;o[wl>>2]=Rl}kl=dl+8|0;s=kl;p=rb;return s|0}xl=o[2972>>2]|0;Sl=xl>>>0>g>>>0;if(Sl){Cl=xl-g|0;o[2972>>2]=Cl;Il=o[2984>>2]|0;Nl=Il+g|0;o[2984>>2]=Nl;Dl=Cl|1;Ol=Nl+4|0;o[Ol>>2]=Dl;Pl=g|3;Hl=Il+4|0;o[Hl>>2]=Pl;jl=Il+8|0;s=jl;p=rb;return s|0}Fl=o[858]|0;Bl=(Fl|0)==0;if(Bl){o[3440>>2]=4096;o[3436>>2]=4096;o[3444>>2]=-1;o[3448>>2]=-1;o[3452>>2]=0;o[3404>>2]=0;Vl=De;Ul=Vl&-16;zl=Ul^1431655768;o[858]=zl;Xl=4096}else{Ee=o[3440>>2]|0;Xl=Ee}Gl=g+48|0;Wl=g+47|0;Kl=Xl+Wl|0;ql=0-Xl|0;Jl=Kl&ql;Ql=Jl>>>0>g>>>0;if(!Ql){s=0;p=rb;return s|0}$l=o[3400>>2]|0;ec=($l|0)==0;if(!ec){tc=o[3392>>2]|0;rc=tc+Jl|0;ic=rc>>>0<=tc>>>0;nc=rc>>>0>$l>>>0;Gy=ic|nc;if(Gy){s=0;p=rb;return s|0}}oc=o[3404>>2]|0;ac=oc&4;lc=(ac|0)==0;e:do{if(lc){cc=o[2984>>2]|0;uc=(cc|0)==(0|0);t:do{if(uc){tb=118}else{d=3408;while(1){dc=o[d>>2]|0;hc=dc>>>0>cc>>>0;if(!hc){fc=d+4|0;pc=o[fc>>2]|0;mc=dc+pc|0;vc=mc>>>0>cc>>>0;if(vc){break}}gc=d+8|0;bc=o[gc>>2]|0;Ec=(bc|0)==(0|0);if(Ec){tb=118;break t}else{d=bc}}Wc=Kl-xl|0;Kc=Wc&ql;Xc=Kc>>>0<2147483647;if(Xc){qc=xi(Kc|0)|0;Zc=o[d>>2]|0;Yc=o[fc>>2]|0;Qc=Zc+Yc|0;$c=(qc|0)==(Qc|0);if($c){eu=(qc|0)==(-1|0);if(eu){Y=Kc}else{pe=Kc;me=qc;tb=135;break e}}else{J=qc;Q=Kc;tb=126}}else{Y=0}}}while(0);do{if((tb|0)==118){Ac=xi(0)|0;_c=(Ac|0)==(-1|0);if(_c){Y=0}else{wc=Ac;Tc=o[3436>>2]|0;Rc=Tc+-1|0;kc=Rc&wc;Mc=(kc|0)==0;xc=Rc+wc|0;Cc=0-Tc|0;Ic=xc&Cc;Nc=Ic-wc|0;Dc=Mc?0:Nc;a=Dc+Jl|0;Oc=o[3392>>2]|0;Pc=a+Oc|0;Hc=a>>>0>g>>>0;jc=a>>>0<2147483647;Uy=Hc&jc;if(Uy){Lc=o[3400>>2]|0;Fc=(Lc|0)==0;if(!Fc){Vc=Pc>>>0<=Oc>>>0;Uc=Pc>>>0>Lc>>>0;Yy=Vc|Uc;if(Yy){Y=0;break}}zc=xi(a|0)|0;Gc=(zc|0)==(Ac|0);if(Gc){pe=a;me=Ac;tb=135;break e}else{J=zc;Q=a;tb=126}}else{Y=0}}}}while(0);do{if((tb|0)==126){tu=0-Q|0;ru=(J|0)!=(-1|0);iu=Q>>>0<2147483647;eb=iu&ru;nu=Gl>>>0>Q>>>0;Ky=nu&eb;if(!Ky){mu=(J|0)==(-1|0);if(mu){Y=0;break}else{pe=Q;me=J;tb=135;break e}}ou=o[3440>>2]|0;au=Wl-Q|0;su=au+ou|0;cu=0-ou|0;uu=su&cu;du=uu>>>0<2147483647;if(!du){pe=Q;me=J;tb=135;break e}hu=xi(uu|0)|0;fu=(hu|0)==(-1|0);if(fu){xi(tu|0)|0;Y=0;break}else{pu=uu+Q|0;pe=pu;me=J;tb=135;break e}}}while(0);vu=o[3404>>2]|0;gu=vu|4;o[3404>>2]=gu;se=Y;tb=133}else{se=0;tb=133}}while(0);if((tb|0)==133){yu=Jl>>>0<2147483647;if(yu){Eu=xi(Jl|0)|0;Au=xi(0)|0;_u=(Eu|0)!=(-1|0);wu=(Au|0)!=(-1|0);Qy=_u&wu;Tu=Eu>>>0<Au>>>0;Xy=Tu&Qy;Ru=Au;ku=Eu;Mu=Ru-ku|0;xu=g+40|0;Su=Mu>>>0>xu>>>0;i=Su?Mu:se;qy=Xy^1;Iu=(Eu|0)==(-1|0);By=Su^1;Nu=Iu|By;Jy=Nu|qy;if(!Jy){pe=i;me=Eu;tb=135}}}if((tb|0)==135){Du=o[3392>>2]|0;Ou=Du+pe|0;o[3392>>2]=Ou;Pu=o[3396>>2]|0;Hu=Ou>>>0>Pu>>>0;if(Hu){o[3396>>2]=Ou}ju=o[2984>>2]|0;Lu=(ju|0)==(0|0);do{if(Lu){Fu=o[2976>>2]|0;Bu=(Fu|0)==(0|0);Uu=me>>>0<Fu>>>0;Zy=Bu|Uu;if(Zy){o[2976>>2]=me}o[3408>>2]=me;o[3412>>2]=pe;o[3420>>2]=0;zu=o[858]|0;o[2996>>2]=zu;o[2992>>2]=-1;o[3012>>2]=3e3;o[3008>>2]=3e3;o[3020>>2]=3008;o[3016>>2]=3008;o[3028>>2]=3016;o[3024>>2]=3016;o[3036>>2]=3024;o[3032>>2]=3024;o[3044>>2]=3032;o[3040>>2]=3032;o[3052>>2]=3040;o[3048>>2]=3040;o[3060>>2]=3048;o[3056>>2]=3048;o[3068>>2]=3056;o[3064>>2]=3056;o[3076>>2]=3064;o[3072>>2]=3064;o[3084>>2]=3072;o[3080>>2]=3072;o[3092>>2]=3080;o[3088>>2]=3080;o[3100>>2]=3088;o[3096>>2]=3088;o[3108>>2]=3096;o[3104>>2]=3096;o[3116>>2]=3104;o[3112>>2]=3104;o[3124>>2]=3112;o[3120>>2]=3112;o[3132>>2]=3120;o[3128>>2]=3120;o[3140>>2]=3128;o[3136>>2]=3128;o[3148>>2]=3136;o[3144>>2]=3136;o[3156>>2]=3144;o[3152>>2]=3144;o[3164>>2]=3152;o[3160>>2]=3152;o[3172>>2]=3160;o[3168>>2]=3160;o[3180>>2]=3168;o[3176>>2]=3168;o[3188>>2]=3176;o[3184>>2]=3176;o[3196>>2]=3184;o[3192>>2]=3184;o[3204>>2]=3192;o[3200>>2]=3192;o[3212>>2]=3200;o[3208>>2]=3200;o[3220>>2]=3208;o[3216>>2]=3208;o[3228>>2]=3216;o[3224>>2]=3216;o[3236>>2]=3224;o[3232>>2]=3224;o[3244>>2]=3232;o[3240>>2]=3232;o[3252>>2]=3240;o[3248>>2]=3240;o[3260>>2]=3248;o[3256>>2]=3248;Gu=pe+-40|0;Wu=me+8|0;Ku=Wu;Xu=Ku&7;qu=(Xu|0)==0;Zu=0-Ku|0;Yu=Zu&7;Ju=qu?0:Yu;ed=me+Ju|0;td=Gu-Ju|0;o[2984>>2]=ed;o[2972>>2]=td;rd=td|1;id=ed+4|0;o[id>>2]=rd;nd=me+Gu|0;od=nd+4|0;o[od>>2]=40;ad=o[3448>>2]|0;o[2988>>2]=ad}else{w=3408;while(1){sd=o[w>>2]|0;ld=w+4|0;cd=o[ld>>2]|0;dd=sd+cd|0;hd=(me|0)==(dd|0);if(hd){tb=143;break}fd=w+8|0;pd=o[fd>>2]|0;md=(pd|0)==(0|0);if(md){break}else{w=pd}}if((tb|0)==143){vd=w+12|0;gd=o[vd>>2]|0;yd=gd&8;bd=(yd|0)==0;if(bd){Ed=sd>>>0<=ju>>>0;_d=me>>>0>ju>>>0;$y=_d&Ed;if($y){wd=cd+pe|0;o[ld>>2]=wd;Td=o[2972>>2]|0;Rd=Td+pe|0;kd=ju+8|0;Md=kd;xd=Md&7;Sd=(xd|0)==0;Cd=0-Md|0;Id=Cd&7;Dd=Sd?0:Id;Od=ju+Dd|0;Pd=Rd-Dd|0;o[2984>>2]=Od;o[2972>>2]=Pd;Hd=Pd|1;jd=Od+4|0;o[jd>>2]=Hd;Ld=ju+Rd|0;Fd=Ld+4|0;o[Fd>>2]=40;Bd=o[3448>>2]|0;o[2988>>2]=Bd;break}}}Vd=o[2976>>2]|0;Ud=me>>>0<Vd>>>0;if(Ud){o[2976>>2]=me}Gd=me+pe|0;U=3408;while(1){Wd=o[U>>2]|0;Kd=(Wd|0)==(Gd|0);if(Kd){tb=151;break}Xd=U+8|0;qd=o[Xd>>2]|0;Zd=(qd|0)==(0|0);if(Zd){u=3408;break}else{U=qd}}if((tb|0)==151){Yd=U+12|0;Jd=o[Yd>>2]|0;Qd=Jd&8;$d=(Qd|0)==0;if($d){o[U>>2]=me;th=U+4|0;rh=o[th>>2]|0;ih=rh+pe|0;o[th>>2]=ih;nh=me+8|0;oh=nh;ah=oh&7;sh=(ah|0)==0;lh=0-oh|0;ch=lh&7;uh=sh?0:ch;hh=me+uh|0;fh=Gd+8|0;ph=fh;mh=ph&7;vh=(mh|0)==0;gh=0-ph|0;yh=gh&7;bh=vh?0:yh;Eh=Gd+bh|0;Ah=Eh;wh=hh;Th=Ah-wh|0;Rh=hh+g|0;kh=Th-g|0;Mh=g|3;xh=hh+4|0;o[xh>>2]=Mh;Sh=(ju|0)==(Eh|0);do{if(Sh){Ch=o[2972>>2]|0;Ih=Ch+kh|0;o[2972>>2]=Ih;o[2984>>2]=Rh;Nh=Ih|1;Oh=Rh+4|0;o[Oh>>2]=Nh}else{Ph=o[2980>>2]|0;Hh=(Ph|0)==(Eh|0);if(Hh){jh=o[2968>>2]|0;Lh=jh+kh|0;o[2968>>2]=Lh;o[2980>>2]=Rh;Fh=Lh|1;Bh=Rh+4|0;o[Bh>>2]=Fh;Vh=Rh+Lh|0;o[Vh>>2]=Lh;break}Uh=Eh+4|0;zh=o[Uh>>2]|0;Wh=zh&3;Kh=(Wh|0)==1;if(Kh){Xh=zh&-8;qh=zh>>>3;Zh=zh>>>0<256;e:do{if(Zh){Yh=Eh+8|0;Jh=o[Yh>>2]|0;Qh=Eh+12|0;$h=o[Qh>>2]|0;ef=($h|0)==(Jh|0);if(ef){nf=1<<qh;of=nf^-1;af=o[740]|0;sf=af&of;o[740]=sf;break}else{lf=Jh+12|0;o[lf>>2]=$h;cf=$h+8|0;o[cf>>2]=Jh;break}}else{uf=Eh+24|0;df=o[uf>>2]|0;hf=Eh+12|0;ff=o[hf>>2]|0;mf=(ff|0)==(Eh|0);do{if(mf){Ef=Eh+16|0;Af=Ef+4|0;_f=o[Af>>2]|0;wf=(_f|0)==(0|0);if(wf){Tf=o[Ef>>2]|0;kf=(Tf|0)==(0|0);if(kf){te=0;break}else{z=Tf;G=Ef}}else{z=_f;G=Af}while(1){Mf=z+20|0;xf=o[Mf>>2]|0;Sf=(xf|0)==(0|0);if(!Sf){z=xf;G=Mf;continue}Cf=z+16|0;If=o[Cf>>2]|0;Nf=(If|0)==(0|0);if(Nf){break}else{z=If;G=Cf}}o[G>>2]=0;te=z}else{vf=Eh+8|0;gf=o[vf>>2]|0;yf=gf+12|0;o[yf>>2]=ff;bf=ff+8|0;o[bf>>2]=gf;te=ff}}while(0);Df=(df|0)==(0|0);if(Df){break}Of=Eh+28|0;Pf=o[Of>>2]|0;jf=3264+(Pf<<2)|0;Lf=o[jf>>2]|0;Ff=(Lf|0)==(Eh|0);do{if(Ff){o[jf>>2]=te;Ly=(te|0)==(0|0);if(!Ly){break}Bf=1<<Pf;Vf=Bf^-1;Uf=o[2964>>2]|0;zf=Uf&Vf;o[2964>>2]=zf;break e}else{Gf=df+16|0;Wf=o[Gf>>2]|0;Kf=(Wf|0)!=(Eh|0);xe=Kf&1;qf=(df+16|0)+(xe<<2)|0;o[qf>>2]=te;Zf=(te|0)==(0|0);if(Zf){break e}}}while(0);Yf=te+24|0;o[Yf>>2]=df;Jf=Eh+16|0;Qf=o[Jf>>2]|0;$f=(Qf|0)==(0|0);if(!$f){ep=te+16|0;o[ep>>2]=Qf;tp=Qf+24|0;o[tp>>2]=te}rp=Jf+4|0;ip=o[rp>>2]|0;op=(ip|0)==(0|0);if(op){break}ap=te+20|0;o[ap>>2]=ip;sp=ip+24|0;o[sp>>2]=te}}while(0);lp=Eh+Xh|0;cp=Xh+kh|0;c=lp;T=cp}else{c=Eh;T=kh}up=c+4|0;dp=o[up>>2]|0;hp=dp&-2;o[up>>2]=hp;fp=T|1;pp=Rh+4|0;o[pp>>2]=fp;vp=Rh+T|0;o[vp>>2]=T;gp=T>>>3;yp=T>>>0<256;if(yp){bp=gp<<1;Ep=3000+(bp<<2)|0;Ap=o[740]|0;_p=1<<gp;wp=Ap&_p;Tp=(wp|0)==0;if(Tp){Rp=Ap|_p;o[740]=Rp;be=Ep+8|0;M=Ep;we=be}else{Mp=Ep+8|0;xp=o[Mp>>2]|0;M=xp;we=Mp}o[we>>2]=Rh;Sp=M+12|0;o[Sp>>2]=Rh;Cp=Rh+8|0;o[Cp>>2]=M;Ip=Rh+12|0;o[Ip>>2]=Ep;break}Np=T>>>8;Dp=(Np|0)==0;do{if(Dp){x=0}else{Op=T>>>0>16777215;if(Op){x=31;break}Pp=Np+1048320|0;Hp=Pp>>>16;Lp=Hp&8;Fp=Np<<Lp;Bp=Fp+520192|0;Vp=Bp>>>16;Up=Vp&4;zp=Up|Lp;Gp=Fp<<Up;Wp=Gp+245760|0;Kp=Wp>>>16;Xp=Kp&2;Zp=zp|Xp;Yp=14-Zp|0;Jp=Gp<<Xp;Qp=Jp>>>15;$p=Yp+Qp|0;em=$p<<1;tm=$p+7|0;rm=T>>>tm;im=rm&1;nm=im|em;x=nm}}while(0);sm=3264+(x<<2)|0;lm=Rh+28|0;o[lm>>2]=x;cm=Rh+16|0;um=cm+4|0;o[um>>2]=0;o[cm>>2]=0;dm=o[2964>>2]|0;hm=1<<x;fm=dm&hm;pm=(fm|0)==0;if(pm){mm=dm|hm;o[2964>>2]=mm;o[sm>>2]=Rh;vm=Rh+24|0;o[vm>>2]=sm;ym=Rh+12|0;o[ym>>2]=Rh;bm=Rh+8|0;o[bm>>2]=Rh;break}Em=o[sm>>2]|0;Am=(x|0)==31;_m=x>>>1;wm=25-_m|0;Tm=Am?0:wm;Rm=T<<Tm;R=Rm;k=Em;while(1){km=k+4|0;Mm=o[km>>2]|0;Sm=Mm&-8;Cm=(Sm|0)==(T|0);if(Cm){tb=192;break}Im=R>>>31;Nm=(k+16|0)+(Im<<2)|0;Dm=R<<1;Om=o[Nm>>2]|0;Pm=(Om|0)==(0|0);if(Pm){tb=191;break}else{R=Dm;k=Om}}if((tb|0)==191){o[Nm>>2]=Rh;Hm=Rh+24|0;o[Hm>>2]=k;jm=Rh+12|0;o[jm>>2]=Rh;Lm=Rh+8|0;o[Lm>>2]=Rh;break}else if((tb|0)==192){Bm=k+8|0;Vm=o[Bm>>2]|0;Um=Vm+12|0;o[Um>>2]=Rh;o[Bm>>2]=Rh;zm=Rh+8|0;o[zm>>2]=Vm;Gm=Rh+12|0;o[Gm>>2]=k;Wm=Rh+24|0;o[Wm>>2]=0;break}}}while(0);_y=hh+8|0;s=_y;p=rb;return s|0}else{u=3408}}while(1){Km=o[u>>2]|0;Xm=Km>>>0>ju>>>0;if(!Xm){qm=u+4|0;Zm=o[qm>>2]|0;Jm=Km+Zm|0;Qm=Jm>>>0>ju>>>0;if(Qm){break}}$m=u+8|0;ev=o[$m>>2]|0;u=ev}tv=Jm+-47|0;rv=tv+8|0;iv=rv;nv=iv&7;ov=(nv|0)==0;av=0-iv|0;lv=av&7;cv=ov?0:lv;uv=tv+cv|0;dv=ju+16|0;hv=uv>>>0<dv>>>0;fv=hv?ju:uv;pv=fv+8|0;mv=fv+24|0;vv=pe+-40|0;gv=me+8|0;bv=gv;Ev=bv&7;Av=(Ev|0)==0;_v=0-bv|0;wv=_v&7;Tv=Av?0:wv;Rv=me+Tv|0;kv=vv-Tv|0;o[2984>>2]=Rv;o[2972>>2]=kv;Mv=kv|1;xv=Rv+4|0;o[xv>>2]=Mv;Cv=me+vv|0;Iv=Cv+4|0;o[Iv>>2]=40;Nv=o[3448>>2]|0;o[2988>>2]=Nv;Dv=fv+4|0;o[Dv>>2]=27;o[pv>>2]=o[3408>>2]|0;o[pv+4>>2]=o[3408+4>>2]|0;o[pv+8>>2]=o[3408+8>>2]|0;o[pv+12>>2]=o[3408+12>>2]|0;o[3408>>2]=me;o[3412>>2]=pe;o[3420>>2]=0;o[3416>>2]=pv;Pv=mv;while(1){Ov=Pv+4|0;o[Ov>>2]=7;Hv=Pv+8|0;jv=Hv>>>0<Jm>>>0;if(jv){Pv=Ov}else{break}}Lv=(fv|0)==(ju|0);if(!Lv){Fv=fv;Vv=ju;Uv=Fv-Vv|0;zv=o[Dv>>2]|0;Gv=zv&-2;o[Dv>>2]=Gv;Wv=Uv|1;Kv=ju+4|0;o[Kv>>2]=Wv;o[fv>>2]=Uv;Xv=Uv>>>3;qv=Uv>>>0<256;if(qv){Zv=Xv<<1;Yv=3000+(Zv<<2)|0;Qv=o[740]|0;$v=1<<Xv;eg=Qv&$v;tg=(eg|0)==0;if(tg){rg=Qv|$v;o[740]=rg;ye=Yv+8|0;A=Yv;_e=ye}else{ig=Yv+8|0;ng=o[ig>>2]|0;A=ng;_e=ig}o[_e>>2]=ju;og=A+12|0;o[og>>2]=ju;ag=ju+8|0;o[ag>>2]=A;sg=ju+12|0;o[sg>>2]=Yv;break}ug=Uv>>>8;dg=(ug|0)==0;if(dg){_=0}else{hg=Uv>>>0>16777215;if(hg){_=31}else{fg=ug+1048320|0;pg=fg>>>16;mg=pg&8;vg=ug<<mg;gg=vg+520192|0;yg=gg>>>16;bg=yg&4;Ag=bg|mg;_g=vg<<bg;wg=_g+245760|0;Tg=wg>>>16;Rg=Tg&2;kg=Ag|Rg;Mg=14-kg|0;xg=_g<<Rg;Sg=xg>>>15;Cg=Mg+Sg|0;Ng=Cg<<1;Dg=Cg+7|0;Og=Uv>>>Dg;Pg=Og&1;Hg=Pg|Ng;_=Hg}}jg=3264+(_<<2)|0;Lg=ju+28|0;o[Lg>>2]=_;Fg=ju+20|0;o[Fg>>2]=0;o[dv>>2]=0;Bg=o[2964>>2]|0;Vg=1<<_;zg=Bg&Vg;Gg=(zg|0)==0;if(Gg){Wg=Bg|Vg;o[2964>>2]=Wg;o[jg>>2]=ju;Kg=ju+24|0;o[Kg>>2]=jg;Xg=ju+12|0;o[Xg>>2]=ju;qg=ju+8|0;o[qg>>2]=ju;break}Zg=o[jg>>2]|0;Yg=(_|0)==31;Jg=_>>>1;Qg=25-Jg|0;ey=Yg?0:Qg;ty=Uv<<ey;b=ty;E=Zg;while(1){ry=E+4|0;iy=o[ry>>2]|0;ny=iy&-8;oy=(ny|0)==(Uv|0);if(oy){tb=213;break}ay=b>>>31;sy=(E+16|0)+(ay<<2)|0;ly=b<<1;cy=o[sy>>2]|0;dy=(cy|0)==(0|0);if(dy){tb=212;break}else{b=ly;E=cy}}if((tb|0)==212){o[sy>>2]=ju;hy=ju+24|0;o[hy>>2]=E;fy=ju+12|0;o[fy>>2]=ju;py=ju+8|0;o[py>>2]=ju;break}else if((tb|0)==213){my=E+8|0;vy=o[my>>2]|0;gy=vy+12|0;o[gy>>2]=ju;o[my>>2]=ju;yy=ju+8|0;o[yy>>2]=vy;by=ju+12|0;o[by>>2]=E;Ey=ju+24|0;o[Ey>>2]=0;break}}}}while(0);wy=o[2972>>2]|0;Ty=wy>>>0>g>>>0;if(Ty){Ry=wy-g|0;o[2972>>2]=Ry;ky=o[2984>>2]|0;My=ky+g|0;o[2984>>2]=My;xy=Ry|1;Sy=My+4|0;o[Sy>>2]=xy;Cy=g|3;Iy=ky+4|0;o[Iy>>2]=Cy;Dy=ky+8|0;s=Dy;p=rb;return s|0}}Oy=qr()|0;o[Oy>>2]=12;s=0;p=rb;return s|0}function Xr(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,s=0,l=0,c=0,u=0,d=0,h=0,f=0,m=0,v=0,g=0,y=0,b=0,E=0,A=0,_=0;var w=0,T=0,R=0,k=0,M=0,x=0,S=0,C=0,I=0,N=0,D=0,O=0,P=0,H=0,j=0,L=0,F=0,B=0,V=0,U=0;var z=0,G=0,W=0,K=0,X=0,q=0,Z=0,Y=0,J=0,Q=0,$=0,ee=0,te=0,re=0,ie=0,ne=0,oe=0,ae=0,se=0,le=0;var ce=0,ue=0,de=0,he=0,fe=0,pe=0,me=0,ve=0,ge=0,ye=0,be=0,Ee=0,Ae=0,_e=0,we=0,Te=0,Re=0,ke=0,Me=0,xe=0;var Se=0,Ce=0,Ie=0,Ne=0,De=0,Oe=0,Pe=0,He=0,je=0,Le=0,Fe=0,Be=0,Ve=0,Ue=0,ze=0,Ge=0,We=0,Ke=0,Xe=0,qe=0;var Ze=0,Ye=0,Je=0,Qe=0,$e=0,et=0,tt=0,rt=0,it=0,nt=0,ot=0,at=0,st=0,lt=0,ct=0,ut=0,dt=0,ht=0,ft=0,pt=0;var mt=0,vt=0,gt=0,yt=0,bt=0,Et=0,At=0,_t=0,wt=0,Tt=0,Rt=0,kt=0,Mt=0,xt=0,St=0,Ct=0,It=0,Nt=0,Dt=0,Ot=0;var Pt=0,Ht=0,jt=0,Lt=0,Ft=0,Bt=0,Vt=0,Ut=0,zt=0,Gt=0,Wt=0,Kt=0,Xt=0,qt=0,Zt=0,Yt=0,Jt=0,Qt=0,$t=0,er=0;var tr=0,rr=0,ir=0,nr=0,or=0,ar=0,sr=0,lr=0,cr=0,ur=0,dr=0,hr=0,fr=0,pr=0,mr=0,vr=0,gr=0,yr=0,br=0,Er=0;var Ar=0,_r=0,wr=0,Tr=0,Rr=0,kr=0,Mr=0,xr=0,Sr=0,Cr=0,Ir=0,Nr=0,Dr=0,Or=0,Pr=0,Hr=0,jr=0,Lr=0,Fr=0,Br=0;var Vr=0,Ur=0,zr=0,Gr=0,Wr=0,Kr=0,Xr=0,qr=0,Zr=0,Yr=0,Jr=0,Qr=0,$r=0,ei=0,ti=0,ri=0,ii=0,ni=0,oi=0,ai=0;var si=0,li=0,ci=0,ui=0,di=0,hi=0,fi=0,pi=0,mi=0,vi=0,gi=0,yi=0,bi=0,Ei=0,Ai=0,_i=0,wi=0,Ti=0,Ri=0,ki=0;var Mi=0,xi=0,Si=0,Ci=0,Ii=0,Ni=0,Di=0,Oi=0,Pi=0,Hi=0,ji=0,Li=0,Fi=0,Bi=0,Vi=0,Ui=0,zi=0,Gi=0,Wi=0,Ki=0;var Xi=0,qi=0,Zi=0,Yi=0,Ji=0,Qi=0,$i=0,en=0,tn=0,rn=0,nn=0,on=0,an=0,sn=0,ln=0,cn=0,un=0,dn=0,hn=0,fn=0;var pn=0,mn=0,vn=0;vn=p;_=(e|0)==(0|0);if(_){return}Rt=e+-8|0;zr=o[2976>>2]|0;ei=e+-4|0;di=o[ei>>2]|0;_i=di&-8;Di=Rt+_i|0;Gi=di&1;tn=(Gi|0)==0;do{if(tn){w=o[Rt>>2]|0;O=di&3;W=(O|0)==0;if(W){return}re=0-w|0;fe=Rt+re|0;Te=w+_i|0;Pe=fe>>>0<zr>>>0;if(Pe){return}Ke=o[2980>>2]|0;it=(Ke|0)==(fe|0);if(it){zi=Di+4|0;Wi=o[zi>>2]|0;Ki=Wi&3;Xi=(Ki|0)==3;if(!Xi){l=fe;c=Te;Qi=fe;break}o[2968>>2]=Te;qi=Wi&-2;o[zi>>2]=qi;Zi=Te|1;Yi=fe+4|0;o[Yi>>2]=Zi;Ji=fe+Te|0;o[Ji>>2]=Te;return}pt=w>>>3;kt=w>>>0<256;if(kt){jt=fe+8|0;qt=o[jt>>2]|0;or=fe+12|0;vr=o[or>>2]|0;Mr=(vr|0)==(qt|0);if(Mr){Lr=1<<pt;Br=Lr^-1;Vr=o[740]|0;Ur=Vr&Br;o[740]=Ur;l=fe;c=Te;Qi=fe;break}else{Gr=qt+12|0;o[Gr>>2]=vr;Wr=vr+8|0;o[Wr>>2]=qt;l=fe;c=Te;Qi=fe;break}}Kr=fe+24|0;Xr=o[Kr>>2]|0;qr=fe+12|0;Zr=o[qr>>2]|0;Yr=(Zr|0)==(fe|0);do{if(Yr){ri=fe+16|0;ii=ri+4|0;ni=o[ii>>2]|0;oi=(ni|0)==(0|0);if(oi){ai=o[ri>>2]|0;si=(ai|0)==(0|0);if(si){v=0;break}else{u=ai;d=ri}}else{u=ni;d=ii}while(1){li=u+20|0;ci=o[li>>2]|0;ui=(ci|0)==(0|0);if(!ui){u=ci;d=li;continue}hi=u+16|0;fi=o[hi>>2]|0;pi=(fi|0)==(0|0);if(pi){break}else{u=fi;d=hi}}o[d>>2]=0;v=u}else{Jr=fe+8|0;Qr=o[Jr>>2]|0;$r=Qr+12|0;o[$r>>2]=Zr;ti=Zr+8|0;o[ti>>2]=Qr;v=Zr}}while(0);mi=(Xr|0)==(0|0);if(mi){l=fe;c=Te;Qi=fe}else{vi=fe+28|0;gi=o[vi>>2]|0;yi=3264+(gi<<2)|0;bi=o[yi>>2]|0;Ei=(bi|0)==(fe|0);if(Ei){o[yi>>2]=v;fn=(v|0)==(0|0);if(fn){Ai=1<<gi;wi=Ai^-1;Ti=o[2964>>2]|0;Ri=Ti&wi;o[2964>>2]=Ri;l=fe;c=Te;Qi=fe;break}}else{ki=Xr+16|0;Mi=o[ki>>2]|0;xi=(Mi|0)!=(fe|0);E=xi&1;Si=(Xr+16|0)+(E<<2)|0;o[Si>>2]=v;Ci=(v|0)==(0|0);if(Ci){l=fe;c=Te;Qi=fe;break}}Ii=v+24|0;o[Ii>>2]=Xr;Ni=fe+16|0;Oi=o[Ni>>2]|0;Pi=(Oi|0)==(0|0);if(!Pi){Hi=v+16|0;o[Hi>>2]=Oi;ji=Oi+24|0;o[ji>>2]=v}Li=Ni+4|0;Fi=o[Li>>2]|0;Bi=(Fi|0)==(0|0);if(Bi){l=fe;c=Te;Qi=fe}else{Vi=v+20|0;o[Vi>>2]=Fi;Ui=Fi+24|0;o[Ui>>2]=v;l=fe;c=Te;Qi=fe}}}else{l=Rt;c=_i;Qi=Rt}}while(0);$i=Qi>>>0<Di>>>0;if(!$i){return}en=Di+4|0;rn=o[en>>2]|0;nn=rn&1;on=(nn|0)==0;if(on){return}an=rn&2;sn=(an|0)==0;if(sn){ln=o[2984>>2]|0;cn=(ln|0)==(Di|0);if(cn){un=o[2972>>2]|0;dn=un+c|0;o[2972>>2]=dn;o[2984>>2]=l;hn=dn|1;T=l+4|0;o[T>>2]=hn;R=o[2980>>2]|0;k=(l|0)==(R|0);if(!k){return}o[2980>>2]=0;o[2968>>2]=0;return}M=o[2980>>2]|0;x=(M|0)==(Di|0);if(x){S=o[2968>>2]|0;C=S+c|0;o[2968>>2]=C;o[2980>>2]=Qi;I=C|1;N=l+4|0;o[N>>2]=I;D=Qi+C|0;o[D>>2]=C;return}P=rn&-8;H=P+c|0;j=rn>>>3;L=rn>>>0<256;do{if(L){F=Di+8|0;B=o[F>>2]|0;V=Di+12|0;U=o[V>>2]|0;z=(U|0)==(B|0);if(z){G=1<<j;K=G^-1;X=o[740]|0;q=X&K;o[740]=q;break}else{Z=B+12|0;o[Z>>2]=U;Y=U+8|0;o[Y>>2]=B;break}}else{J=Di+24|0;Q=o[J>>2]|0;$=Di+12|0;ee=o[$>>2]|0;te=(ee|0)==(Di|0);do{if(te){se=Di+16|0;le=se+4|0;ce=o[le>>2]|0;ue=(ce|0)==(0|0);if(ue){de=o[se>>2]|0;he=(de|0)==(0|0);if(he){g=0;break}else{h=de;f=se}}else{h=ce;f=le}while(1){pe=h+20|0;me=o[pe>>2]|0;ve=(me|0)==(0|0);if(!ve){h=me;f=pe;continue}ge=h+16|0;ye=o[ge>>2]|0;be=(ye|0)==(0|0);if(be){break}else{h=ye;f=ge}}o[f>>2]=0;g=h}else{ie=Di+8|0;ne=o[ie>>2]|0;oe=ne+12|0;o[oe>>2]=ee;ae=ee+8|0;o[ae>>2]=ne;g=ee}}while(0);Ee=(Q|0)==(0|0);if(!Ee){Ae=Di+28|0;_e=o[Ae>>2]|0;we=3264+(_e<<2)|0;Re=o[we>>2]|0;ke=(Re|0)==(Di|0);if(ke){o[we>>2]=g;pn=(g|0)==(0|0);if(pn){Me=1<<_e;xe=Me^-1;Se=o[2964>>2]|0;Ce=Se&xe;o[2964>>2]=Ce;break}}else{Ie=Q+16|0;Ne=o[Ie>>2]|0;De=(Ne|0)!=(Di|0);A=De&1;Oe=(Q+16|0)+(A<<2)|0;o[Oe>>2]=g;He=(g|0)==(0|0);if(He){break}}je=g+24|0;o[je>>2]=Q;Le=Di+16|0;Fe=o[Le>>2]|0;Be=(Fe|0)==(0|0);if(!Be){Ve=g+16|0;o[Ve>>2]=Fe;Ue=Fe+24|0;o[Ue>>2]=g}ze=Le+4|0;Ge=o[ze>>2]|0;We=(Ge|0)==(0|0);if(!We){Xe=g+20|0;o[Xe>>2]=Ge;qe=Ge+24|0;o[qe>>2]=g}}}}while(0);Ze=H|1;Ye=l+4|0;o[Ye>>2]=Ze;Je=Qi+H|0;o[Je>>2]=H;Qe=o[2980>>2]|0;$e=(l|0)==(Qe|0);if($e){o[2968>>2]=H;return}else{m=H}}else{et=rn&-2;o[en>>2]=et;tt=c|1;rt=l+4|0;o[rt>>2]=tt;nt=Qi+c|0;o[nt>>2]=c;m=c}ot=m>>>3;at=m>>>0<256;if(at){st=ot<<1;lt=3000+(st<<2)|0;ct=o[740]|0;ut=1<<ot;dt=ct&ut;ht=(dt|0)==0;if(ht){ft=ct|ut;o[740]=ft;y=lt+8|0;s=lt;b=y}else{mt=lt+8|0;vt=o[mt>>2]|0;s=vt;b=mt}o[b>>2]=l;gt=s+12|0;o[gt>>2]=l;yt=l+8|0;o[yt>>2]=s;bt=l+12|0;o[bt>>2]=lt;return}Et=m>>>8;At=(Et|0)==0;if(At){a=0}else{_t=m>>>0>16777215;if(_t){a=31}else{wt=Et+1048320|0;Tt=wt>>>16;Mt=Tt&8;xt=Et<<Mt;St=xt+520192|0;Ct=St>>>16;It=Ct&4;Nt=It|Mt;Dt=xt<<It;Ot=Dt+245760|0;Pt=Ot>>>16;Ht=Pt&2;Lt=Nt|Ht;Ft=14-Lt|0;Bt=Dt<<Ht;Vt=Bt>>>15;Ut=Ft+Vt|0;zt=Ut<<1;Gt=Ut+7|0;Wt=m>>>Gt;Kt=Wt&1;Xt=Kt|zt;a=Xt}}Zt=3264+(a<<2)|0;Yt=l+28|0;o[Yt>>2]=a;Jt=l+16|0;Qt=l+20|0;o[Qt>>2]=0;o[Jt>>2]=0;$t=o[2964>>2]|0;er=1<<a;tr=$t&er;rr=(tr|0)==0;do{if(rr){ir=$t|er;o[2964>>2]=ir;o[Zt>>2]=l;nr=l+24|0;o[nr>>2]=Zt;ar=l+12|0;o[ar>>2]=l;sr=l+8|0;o[sr>>2]=l}else{lr=o[Zt>>2]|0;cr=(a|0)==31;ur=a>>>1;dr=25-ur|0;hr=cr?0:dr;fr=m<<hr;i=fr;n=lr;while(1){pr=n+4|0;mr=o[pr>>2]|0;gr=mr&-8;yr=(gr|0)==(m|0);if(yr){mn=73;break}br=i>>>31;Er=(n+16|0)+(br<<2)|0;Ar=i<<1;_r=o[Er>>2]|0;wr=(_r|0)==(0|0);if(wr){mn=72;break}else{i=Ar;n=_r}}if((mn|0)==72){o[Er>>2]=l;Tr=l+24|0;o[Tr>>2]=n;Rr=l+12|0;o[Rr>>2]=l;kr=l+8|0;o[kr>>2]=l;break}else if((mn|0)==73){xr=n+8|0;Sr=o[xr>>2]|0;Cr=Sr+12|0;o[Cr>>2]=l;o[xr>>2]=l;Ir=l+8|0;o[Ir>>2]=Sr;Nr=l+12|0;o[Nr>>2]=n;Dr=l+24|0;o[Dr>>2]=0;break}}}while(0);Or=o[2992>>2]|0;Pr=Or+-1|0;o[2992>>2]=Pr;Hr=(Pr|0)==0;if(Hr){r=3416}else{return}while(1){t=o[r>>2]|0;jr=(t|0)==(0|0);Fr=t+8|0;if(jr){break}else{r=Fr}}o[2992>>2]=-1;return}function qr(){var e=0,t=0;t=p;return 3456|0}function Zr(e){e=e|0;var t=0,r=0,n=0,a=0,s=0,l=0,c=0,u=0,d=0,h=0,f=0,m=0,v=0,g=0,y=0,b=0,E=0,A=0,_=0,w=0;var T=0,R=0,k=0,M=0,x=0,S=0,C=0,I=0,N=0,D=0,O=0,P=0;P=p;u=e;_=u&3;M=(_|0)==0;e:do{if(M){r=e;O=4}else{n=e;k=u;while(1){x=i[n>>0]|0;S=x<<24>>24==0;if(S){c=k;break e}C=n+1|0;I=C;N=I&3;D=(N|0)==0;if(D){r=C;O=4;break}else{n=C;k=I}}}}while(0);if((O|0)==4){t=r;while(1){d=o[t>>2]|0;h=d+-16843009|0;f=d&-2139062144;m=f^-2139062144;v=m&h;g=(v|0)==0;y=t+4|0;if(g){t=y}else{break}}b=d&255;E=b<<24>>24==0;if(E){a=t}else{s=t;while(1){A=s+1|0;l=i[A>>0]|0;w=l<<24>>24==0;if(w){a=A;break}else{s=A}}}T=a;c=T}R=c-u|0;return R|0}function Yr(e){e=e|0;var t=0,r=0,i=0,n=0,o=0,a=0,s=0;s=p;r=Zr(e)|0;i=r+1|0;n=Kr(i)|0;o=(n|0)==(0|0);if(o){t=0}else{ki(n|0,e|0,i|0)|0;t=n}return t|0}function Jr(e){e=e|0;var t=0,r=0;r=p;return}function Qr(e){e=e|0;var t=0,r=0;r=p;Jr(e);pi(e);return}function $r(e){e=e|0;var t=0,r=0;r=p;return}function ei(e){e=e|0;var t=0,r=0;r=p;return}function ti(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0,a=0,s=0,l=0,c=0,u=0,d=0,h=0,f=0,m=0,v=0,g=0,y=0,b=0,E=0,A=0,_=0,w=0,T=0;var R=0,k=0,M=0,x=0;M=p;p=p+64|0;y=M;b=oi(e,t,0)|0;if(b){n=1}else{E=(t|0)==(0|0);if(E){n=0}else{A=ci(t,208,192,0)|0;_=(A|0)==(0|0);if(_){n=0}else{w=y+4|0;R=w;x=R+52|0;do{o[R>>2]=0|0;R=R+4|0}while((R|0)<(x|0));o[y>>2]=A;T=y+8|0;o[T>>2]=e;a=y+12|0;o[a>>2]=-1;s=y+48|0;o[s>>2]=1;l=o[A>>2]|0;c=l+28|0;u=o[c>>2]|0;d=o[r>>2]|0;Xi[u&3](A,y,d,1);h=y+24|0;f=o[h>>2]|0;m=(f|0)==1;if(m){v=y+16|0;g=o[v>>2]|0;o[r>>2]=g;i=1}else{i=0}n=i}}}p=M;return n|0}function ri(e,t,r,i,n,a){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;var s=0,l=0,c=0,u=0,d=0;d=p;s=t+8|0;l=o[s>>2]|0;c=oi(e,l,a)|0;if(c){li(0,t,r,i,n)}return}function ii(e,t,r,n,a){e=e|0;t=t|0;r=r|0;n=n|0;a=a|0;var s=0,l=0,c=0,u=0,d=0,h=0,f=0,m=0,v=0,g=0,y=0,b=0,E=0,A=0,_=0,w=0,T=0,R=0,k=0,M=0;var x=0,S=0,C=0,I=0,N=0,D=0,O=0;O=p;x=t+8|0;S=o[x>>2]|0;C=oi(e,S,a)|0;do{if(C){si(0,t,r,n)}else{I=o[t>>2]|0;N=oi(e,I,a)|0;if(N){s=t+16|0;l=o[s>>2]|0;c=(l|0)==(r|0);if(!c){u=t+20|0;d=o[u>>2]|0;h=(d|0)==(r|0);if(!h){v=t+32|0;o[v>>2]=n;o[u>>2]=r;g=t+40|0;y=o[g>>2]|0;b=y+1|0;o[g>>2]=b;E=t+36|0;A=o[E>>2]|0;_=(A|0)==1;if(_){w=t+24|0;T=o[w>>2]|0;R=(T|0)==2;if(R){k=t+54|0;i[k>>0]=1}}M=t+44|0;o[M>>2]=4;break}}f=(n|0)==1;if(f){m=t+32|0;o[m>>2]=1}}}}while(0);return}function ni(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0,s=0,l=0,c=0;c=p;n=t+8|0;a=o[n>>2]|0;s=oi(e,a,0)|0;if(s){ai(0,t,r,i)}return}function oi(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0,o=0;o=p;i=(e|0)==(t|0);return i|0}function ai(e,t,r,n){e=e|0;t=t|0;r=r|0;n=n|0;var a=0,s=0,l=0,c=0,u=0,d=0,h=0,f=0,m=0,v=0,g=0,y=0,b=0,E=0,A=0,_=0;_=p;m=t+16|0;v=o[m>>2]|0;g=(v|0)==(0|0);do{if(g){o[m>>2]=r;y=t+24|0;o[y>>2]=n;b=t+36|0;o[b>>2]=1}else{E=(v|0)==(r|0);if(!E){c=t+36|0;u=o[c>>2]|0;d=u+1|0;o[c>>2]=d;h=t+24|0;o[h>>2]=2;f=t+54|0;i[f>>0]=1;break}a=t+24|0;s=o[a>>2]|0;l=(s|0)==2;if(l){o[a>>2]=n}}}while(0);return}function si(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0,s=0,l=0,c=0,u=0,d=0,h=0;h=p;n=t+4|0;a=o[n>>2]|0;s=(a|0)==(r|0);if(s){l=t+28|0;c=o[l>>2]|0;u=(c|0)==1;if(!u){o[l>>2]=i}}return}function li(e,t,r,n,a){e=e|0;t=t|0;r=r|0;n=n|0;a=a|0;var s=0,l=0,c=0,u=0,d=0,h=0,f=0,m=0,v=0,g=0,y=0,b=0,E=0,A=0,_=0,w=0,T=0,R=0,k=0,M=0;var x=0,S=0,C=0,I=0,N=0,D=0,O=0,P=0,H=0,j=0,L=0,F=0,B=0;B=p;N=t+53|0;i[N>>0]=1;D=t+4|0;O=o[D>>2]|0;P=(O|0)==(n|0);do{if(P){H=t+52|0;i[H>>0]=1;s=t+16|0;l=o[s>>2]|0;c=(l|0)==(0|0);if(c){o[s>>2]=r;u=t+24|0;o[u>>2]=a;d=t+36|0;o[d>>2]=1;h=t+48|0;f=o[h>>2]|0;m=(f|0)==1;v=(a|0)==1;j=m&v;if(!j){break}g=t+54|0;i[g>>0]=1;break}y=(l|0)==(r|0);if(!y){x=t+36|0;S=o[x>>2]|0;C=S+1|0;o[x>>2]=C;I=t+54|0;i[I>>0]=1;break}b=t+24|0;E=o[b>>2]|0;A=(E|0)==2;if(A){o[b>>2]=a;R=a}else{R=E}_=t+48|0;w=o[_>>2]|0;T=(w|0)==1;k=(R|0)==1;L=T&k;if(L){M=t+54|0;i[M>>0]=1}}}while(0);return}function ci(e,t,r,a){e=e|0;t=t|0;r=r|0;a=a|0;var s=0,l=0,c=0,u=0,d=0,h=0,f=0,m=0,v=0,g=0,y=0,b=0,E=0,A=0,_=0,w=0,T=0,R=0,k=0,M=0;var x=0,S=0,C=0,I=0,N=0,D=0,O=0,P=0,H=0,j=0,L=0,F=0,B=0,V=0,U=0,z=0,G=0,W=0,K=0,X=0;var q=0,Z=0,Y=0,J=0,Q=0,$=0,ee=0,te=0,re=0,ie=0,ne=0,oe=0,ae=0,se=0,le=0;se=p;p=p+64|0;V=se;Y=o[e>>2]|0;J=Y+-8|0;Q=o[J>>2]|0;$=e+Q|0;ee=Y+-4|0;u=o[ee>>2]|0;o[V>>2]=r;d=V+4|0;o[d>>2]=e;h=V+8|0;o[h>>2]=t;f=V+12|0;o[f>>2]=a;m=V+16|0;v=V+20|0;g=V+24|0;y=V+28|0;b=V+32|0;E=V+40|0;oe=m;le=oe+36|0;do{o[oe>>2]=0|0;oe=oe+4|0}while((oe|0)<(le|0));n[m+36>>1]=0|0;i[m+38>>0]=0|0;A=oi(u,r,0)|0;e:do{if(A){_=V+48|0;o[_>>2]=1;w=o[u>>2]|0;T=w+20|0;R=o[T>>2]|0;Zi[R&3](u,V,$,$,1,0);k=o[g>>2]|0;M=(k|0)==1;s=M?$:0;l=s}else{x=V+36|0;S=o[u>>2]|0;C=S+24|0;I=o[C>>2]|0;qi[I&3](u,V,$,1,0);N=o[x>>2]|0;switch(N|0){case 0:{D=o[E>>2]|0;O=(D|0)==1;P=o[y>>2]|0;H=(P|0)==1;te=O&H;j=o[b>>2]|0;L=(j|0)==1;re=te&L;F=o[v>>2]|0;c=re?F:0;l=c;break e;break}case 1:{break}default:{l=0;break e}}B=o[g>>2]|0;U=(B|0)==1;if(!U){z=o[E>>2]|0;G=(z|0)==0;W=o[y>>2]|0;K=(W|0)==1;ie=G&K;X=o[b>>2]|0;q=(X|0)==1;ne=ie&q;if(!ne){l=0;break}}Z=o[m>>2]|0;l=Z}}while(0);p=se;return l|0}function ui(e){e=e|0;var t=0,r=0;r=p;Jr(e);pi(e);return}function di(e,t,r,i,n,a){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;var s=0,l=0,c=0,u=0,d=0,h=0,f=0,m=0,v=0,g=0;g=p;d=t+8|0;h=o[d>>2]|0;f=oi(e,h,a)|0;if(f){li(0,t,r,i,n)}else{m=e+8|0;s=o[m>>2]|0;l=o[s>>2]|0;c=l+20|0;u=o[c>>2]|0;Zi[u&3](s,t,r,i,n,a)}return}function hi(e,t,r,n,a){e=e|0;t=t|0;r=r|0;n=n|0;a=a|0;var s=0,l=0,c=0,u=0,d=0,h=0,f=0,m=0,v=0,g=0,y=0,b=0,E=0,A=0,_=0,w=0,T=0,R=0,k=0,M=0;var x=0,S=0,C=0,I=0,N=0,D=0,O=0,P=0,H=0,j=0,L=0,F=0,B=0,V=0,U=0,z=0,G=0,W=0,K=0,X=0;var q=0,Z=0,Y=0,J=0,Q=0,$=0,ee=0;ee=p;q=t+8|0;Z=o[q>>2]|0;Y=oi(e,Z,a)|0;do{if(Y){si(0,t,r,n)}else{J=o[t>>2]|0;Q=oi(e,J,a)|0;if(!Q){z=e+8|0;G=o[z>>2]|0;W=o[G>>2]|0;K=W+24|0;X=o[K>>2]|0;qi[X&3](G,t,r,n,a);break}c=t+16|0;u=o[c>>2]|0;d=(u|0)==(r|0);if(!d){h=t+20|0;f=o[h>>2]|0;m=(f|0)==(r|0);if(!m){y=t+32|0;o[y>>2]=n;b=t+44|0;E=o[b>>2]|0;A=(E|0)==4;if(A){break}_=t+52|0;i[_>>0]=0;w=t+53|0;i[w>>0]=0;T=e+8|0;R=o[T>>2]|0;k=o[R>>2]|0;M=k+20|0;x=o[M>>2]|0;Zi[x&3](R,t,r,r,1,a);S=i[w>>0]|0;C=S<<24>>24==0;if(C){s=4;$=11}else{I=i[_>>0]|0;N=I<<24>>24==0;if(N){s=3;$=11}else{l=3}}if(($|0)==11){o[h>>2]=r;D=t+40|0;O=o[D>>2]|0;P=O+1|0;o[D>>2]=P;H=t+36|0;j=o[H>>2]|0;L=(j|0)==1;if(L){F=t+24|0;B=o[F>>2]|0;V=(B|0)==2;if(V){U=t+54|0;i[U>>0]=1;l=s}else{l=s}}else{l=s}}o[b>>2]=l;break}}v=(n|0)==1;if(v){g=t+32|0;o[g>>2]=1}}}while(0);return}function fi(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0,s=0,l=0,c=0,u=0,d=0,h=0,f=0,m=0;m=p;s=t+8|0;l=o[s>>2]|0;c=oi(e,l,0)|0;if(c){ai(0,t,r,i)}else{u=e+8|0;d=o[u>>2]|0;h=o[d>>2]|0;n=h+28|0;a=o[n>>2]|0;Xi[a&3](d,t,r,i)}return}function pi(e){e=e|0;var t=0,r=0;r=p;Xr(e);return}function mi(e){e=e|0;var t=0,r=0;r=p;return}function vi(e){e=e|0;var t=0,r=0;r=p;Jr(e);pi(e);return}function gi(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0,o=0;o=p;i=oi(e,t,0)|0;return i|0}function yi(e){e=e|0;var t=0,r=0;r=p;Jr(e);pi(e);return}function bi(e,t,r,n,a,s){e=e|0;t=t|0;r=r|0;n=n|0;a=a|0;s=s|0;var l=0,c=0,u=0,d=0,h=0,f=0,m=0,v=0,g=0,y=0,b=0,E=0,A=0,_=0,w=0,T=0,R=0,k=0,M=0,x=0;var S=0,C=0,I=0,N=0,D=0,O=0,P=0,H=0,j=0,L=0,F=0,B=0,V=0,U=0,z=0;z=p;L=t+8|0;F=o[L>>2]|0;B=oi(e,F,s)|0;if(B){li(0,t,r,n,a)}else{V=t+52|0;c=i[V>>0]|0;u=t+53|0;d=i[u>>0]|0;h=e+16|0;f=e+12|0;m=o[f>>2]|0;v=(e+16|0)+(m<<3)|0;i[V>>0]=0;i[u>>0]=0;wi(h,t,r,n,a,s);g=(m|0)>1;e:do{if(g){y=e+24|0;b=t+24|0;E=e+8|0;A=t+54|0;l=y;while(1){_=i[A>>0]|0;w=_<<24>>24==0;if(!w){break e}T=i[V>>0]|0;R=T<<24>>24==0;if(R){I=i[u>>0]|0;N=I<<24>>24==0;if(!N){D=o[E>>2]|0;O=D&1;P=(O|0)==0;if(P){break e}}}else{k=o[b>>2]|0;M=(k|0)==1;if(M){break e}x=o[E>>2]|0;S=x&2;C=(S|0)==0;if(C){break e}}i[V>>0]=0;i[u>>0]=0;wi(l,t,r,n,a,s);H=l+8|0;j=H>>>0<v>>>0;if(j){l=H}else{break}}}}while(0);i[V>>0]=c;i[u>>0]=d}return}function Ei(e,t,r,n,a){e=e|0;t=t|0;r=r|0;n=n|0;a=a|0;var s=0,l=0,c=0,u=0,d=0,h=0,f=0,m=0,v=0,g=0,y=0,b=0,E=0,A=0,_=0,w=0,T=0,R=0,k=0,M=0;var x=0,S=0,C=0,I=0,N=0,D=0,O=0,P=0,H=0,j=0,L=0,F=0,B=0,V=0,U=0,z=0,G=0,W=0,K=0,X=0;var q=0,Z=0,Y=0,J=0,Q=0,$=0,ee=0,te=0,re=0,ie=0,ne=0,oe=0,ae=0,se=0,le=0,ce=0,ue=0,de=0,he=0,fe=0;var pe=0,me=0,ve=0,ge=0,ye=0,be=0,Ee=0,Ae=0,_e=0,we=0,Te=0,Re=0,ke=0,Me=0,xe=0,Se=0,Ce=0,Ie=0,Ne=0,De=0;var Oe=0,Pe=0,He=0,je=0,Le=0,Fe=0,Be=0,Ve=0,Ue=0,ze=0,Ge=0,We=0,Ke=0,Xe=0,qe=0,Ze=0,Ye=0,Je=0,Qe=0;Qe=p;ie=t+8|0;pe=o[ie>>2]|0;Re=oi(e,pe,a)|0;e:do{if(Re){si(0,t,r,n)}else{He=o[t>>2]|0;Xe=oi(e,He,a)|0;if(!Xe){ue=e+16|0;de=e+12|0;he=o[de>>2]|0;fe=(e+16|0)+(he<<3)|0;Ti(ue,t,r,n,a);me=e+24|0;ve=(he|0)>1;if(!ve){break}ge=e+8|0;ye=o[ge>>2]|0;be=ye&2;Ee=(be|0)==0;if(Ee){Ae=t+36|0;_e=o[Ae>>2]|0;we=(_e|0)==1;if(!we){Ce=ye&1;Ie=(Ce|0)==0;if(Ie){Oe=t+54|0;m=me;while(1){Ge=i[Oe>>0]|0;We=Ge<<24>>24==0;if(!We){break e}Ke=o[Ae>>2]|0;qe=(Ke|0)==1;if(qe){break e}Ti(m,t,r,n,a);Ze=m+8|0;Ye=Ze>>>0<fe>>>0;if(Ye){m=Ze}else{break e}}}Ne=t+24|0;De=t+54|0;d=me;while(1){Pe=i[De>>0]|0;je=Pe<<24>>24==0;if(!je){break e}Le=o[Ae>>2]|0;Fe=(Le|0)==1;if(Fe){Be=o[Ne>>2]|0;Ve=(Be|0)==1;if(Ve){break e}}Ti(d,t,r,n,a);Ue=d+8|0;ze=Ue>>>0<fe>>>0;if(ze){d=Ue}else{break e}}}}Te=t+54|0;s=me;while(1){ke=i[Te>>0]|0;Me=ke<<24>>24==0;if(!Me){break e}Ti(s,t,r,n,a);xe=s+8|0;Se=xe>>>0<fe>>>0;if(Se){s=xe}else{break e}}}g=t+16|0;y=o[g>>2]|0;b=(y|0)==(r|0);if(!b){E=t+20|0;A=o[E>>2]|0;_=(A|0)==(r|0);if(!_){R=t+32|0;o[R>>2]=n;k=t+44|0;M=o[k>>2]|0;x=(M|0)==4;if(x){break}S=e+16|0;C=e+12|0;I=o[C>>2]|0;N=(e+16|0)+(I<<3)|0;D=t+52|0;O=t+53|0;P=t+54|0;H=e+8|0;j=t+24|0;l=0;c=S;u=0;t:while(1){L=c>>>0<N>>>0;if(!L){v=l;Je=18;break}i[D>>0]=0;i[O>>0]=0;wi(c,t,r,r,1,a);F=i[P>>0]|0;B=F<<24>>24==0;if(!B){v=l;Je=18;break}V=i[O>>0]|0;U=V<<24>>24==0;do{if(U){h=l;f=u}else{z=i[D>>0]|0;G=z<<24>>24==0;if(G){Y=o[H>>2]|0;J=Y&1;Q=(J|0)==0;if(Q){v=1;Je=18;break t}else{h=1;f=u;break}}W=o[j>>2]|0;K=(W|0)==1;if(K){Je=23;break t}X=o[H>>2]|0;q=X&2;Z=(q|0)==0;if(Z){Je=23;break t}else{h=1;f=1}}}while(0);$=c+8|0;l=h;c=$;u=f}do{if((Je|0)==18){if(!u){o[E>>2]=r;ee=t+40|0;te=o[ee>>2]|0;re=te+1|0;o[ee>>2]=re;ne=t+36|0;oe=o[ne>>2]|0;ae=(oe|0)==1;if(ae){se=o[j>>2]|0;le=(se|0)==2;if(le){i[P>>0]=1;if(v){Je=23;break}else{ce=4;break}}}}if(v){Je=23}else{ce=4}}}while(0);if((Je|0)==23){ce=3}o[k>>2]=ce;break}}w=(n|0)==1;if(w){T=t+32|0;o[T>>2]=1}}}while(0);return}function Ai(e,t,r,n){e=e|0;t=t|0;r=r|0;n=n|0;var a=0,s=0,l=0,c=0,u=0,d=0,h=0,f=0,m=0,v=0,g=0,y=0,b=0,E=0,A=0,_=0,w=0;w=p;v=t+8|0;g=o[v>>2]|0;y=oi(e,g,0)|0;e:do{if(y){ai(0,t,r,n)}else{b=e+16|0;E=e+12|0;A=o[E>>2]|0;s=(e+16|0)+(A<<3)|0;_i(b,t,r,n);l=(A|0)>1;if(l){c=e+24|0;u=t+54|0;a=c;while(1){_i(a,t,r,n);d=i[u>>0]|0;h=d<<24>>24==0;if(!h){break e}f=a+8|0;m=f>>>0<s>>>0;if(m){a=f}else{break}}}}}while(0);return}function _i(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0,s=0,l=0,c=0,u=0,d=0,h=0,f=0,m=0,v=0,g=0,y=0,b=0,E=0,A=0,_=0,w=0,T=0;T=p;g=e+4|0;y=o[g>>2]|0;b=y>>8;E=y&1;A=(E|0)==0;if(A){n=b}else{_=o[r>>2]|0;a=_+b|0;s=o[a>>2]|0;n=s}l=o[e>>2]|0;c=o[l>>2]|0;u=c+28|0;d=o[u>>2]|0;h=r+n|0;f=y&2;m=(f|0)!=0;v=m?i:2;Xi[d&3](l,t,h,v);return}function wi(e,t,r,i,n,a){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;var s=0,l=0,c=0,u=0,d=0,h=0,f=0,m=0,v=0,g=0,y=0,b=0,E=0,A=0,_=0,w=0,T=0,R=0,k=0;k=p;A=e+4|0;_=o[A>>2]|0;w=_>>8;T=_&1;l=(T|0)==0;if(l){s=w}else{c=o[i>>2]|0;u=c+w|0;d=o[u>>2]|0;s=d}h=o[e>>2]|0;f=o[h>>2]|0;m=f+20|0;v=o[m>>2]|0;g=i+s|0;y=_&2;b=(y|0)!=0;E=b?n:2;Zi[v&3](h,t,r,g,E,a);return}function Ti(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;var a=0,s=0,l=0,c=0,u=0,d=0,h=0,f=0,m=0,v=0,g=0,y=0,b=0,E=0,A=0,_=0,w=0,T=0,R=0;R=p;b=e+4|0;E=o[b>>2]|0;A=E>>8;_=E&1;w=(_|0)==0;if(w){a=A}else{s=o[r>>2]|0;l=s+A|0;c=o[l>>2]|0;a=c}u=o[e>>2]|0;d=o[u>>2]|0;h=d+24|0;f=o[h>>2]|0;m=r+a|0;v=E&2;g=(v|0)!=0;y=g?i:2;qi[f&3](u,t,m,y,n);return}function Ri(){}function ki(e,t,r){e=e|0;t=t|0;r=r|0;var n=0;var a=0;var s=0;var l=0;if((r|0)>=8192){return _e(e|0,t|0,r|0)|0}n=e|0;l=e+r|0;if((e&3)==(t&3)){while(e&3){if((r|0)==0)return n|0;i[e>>0]=i[t>>0]|0;e=e+1|0;t=t+1|0;r=r-1|0}a=l&-4|0;s=a-64|0;while((e|0)<=(s|0)){o[e>>2]=o[t>>2]|0;o[e+4>>2]=o[t+4>>2]|0;o[e+8>>2]=o[t+8>>2]|0;o[e+12>>2]=o[t+12>>2]|0;o[e+16>>2]=o[t+16>>2]|0;o[e+20>>2]=o[t+20>>2]|0;o[e+24>>2]=o[t+24>>2]|0;o[e+28>>2]=o[t+28>>2]|0;o[e+32>>2]=o[t+32>>2]|0;o[e+36>>2]=o[t+36>>2]|0;o[e+40>>2]=o[t+40>>2]|0;o[e+44>>2]=o[t+44>>2]|0;o[e+48>>2]=o[t+48>>2]|0;o[e+52>>2]=o[t+52>>2]|0;o[e+56>>2]=o[t+56>>2]|0;o[e+60>>2]=o[t+60>>2]|0;e=e+64|0;t=t+64|0}while((e|0)<(a|0)){o[e>>2]=o[t>>2]|0;e=e+4|0;t=t+4|0}}else{a=l-4|0;while((e|0)<(a|0)){i[e>>0]=i[t>>0]|0;i[e+1>>0]=i[t+1>>0]|0;i[e+2>>0]=i[t+2>>0]|0;i[e+3>>0]=i[t+3>>0]|0;e=e+4|0;t=t+4|0}}while((e|0)<(l|0)){i[e>>0]=i[t>>0]|0;e=e+1|0;t=t+1|0}return n|0}function Mi(e,t,r){e=e|0;t=t|0;r=r|0;var n=0,a=0,s=0,l=0;n=e+r|0;t=t&0xff;if((r|0)>=67){while((e&3)!=0){i[e>>0]=t;e=e+1|0}a=n&-4|0;s=a-64|0;l=t|t<<8|t<<16|t<<24;while((e|0)<=(s|0)){o[e>>2]=l;o[e+4>>2]=l;o[e+8>>2]=l;o[e+12>>2]=l;o[e+16>>2]=l;o[e+20>>2]=l;o[e+24>>2]=l;o[e+28>>2]=l;o[e+32>>2]=l;o[e+36>>2]=l;o[e+40>>2]=l;o[e+44>>2]=l;o[e+48>>2]=l;o[e+52>>2]=l;o[e+56>>2]=l;o[e+60>>2]=l;e=e+64|0}while((e|0)<(a|0)){o[e>>2]=l;e=e+4|0}}while((e|0)<(n|0)){i[e>>0]=t;e=e+1|0}return n-r|0}function xi(e){e=e|0;var t=0;var r=0;var i=0;var n=0;e=e+15&-16|0;t=o[d>>2]|0;i=t+e|0;if((e|0)>0&(i|0)<(t|0)|(i|0)<0){Y()|0;le(12);return-1}o[d>>2]=i;n=Z()|0;if((i|0)>(n|0)){if((q()|0)==0){o[d>>2]=t;le(12);return-1}}return t|0}function Si(e){e=e|0;return zi[e&1]()|0}function Ci(e,t){e=e|0;t=t|0;return Gi[e&1](t|0)|0}function Ii(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;return Wi[e&3](t|0,r|0,i|0)|0}function Ni(e,t){e=e|0;t=t|0;Ki[e&7](t|0)}function Di(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;Xi[e&3](t|0,r|0,i|0,n|0)}function Oi(e,t,r,i,n,o){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;o=o|0;qi[e&3](t|0,r|0,i|0,n|0,o|0)}function Pi(e,t,r,i,n,o,a){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;o=o|0;a=a|0;Zi[e&3](t|0,r|0,i|0,n|0,o|0,a|0)}function Hi(){K(0);return 0}function ji(e){e=e|0;K(1);return 0}function Li(e,t,r){e=e|0;t=t|0;r=r|0;K(2);return 0}function Fi(e){e=e|0;K(3)}function Bi(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;K(4)}function Vi(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;K(5)}function Ui(e,t,r,i,n,o){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;o=o|0;K(6)}var zi=[Hi,it];var Gi=[ji,lt];var Wi=[Li,ti,gi,Li];var Ki=[Fi,Jr,Qr,$r,ei,ui,vi,yi];var Xi=[Bi,ni,fi,Ai];var qi=[Vi,ii,hi,Ei];var Zi=[Ui,ri,di,bi];return{__GLOBAL__sub_I_bind_cpp:mt,__GLOBAL__sub_I_whiteList_cpp:pt,___errno_location:qr,___getTypeName:Wr,_free:Xr,_malloc:Kr,_memcpy:ki,_memset:Mi,_sbrk:xi,dynCall_i:Si,dynCall_ii:Ci,dynCall_iiii:Ii,dynCall_vi:Ni,dynCall_viiii:Di,dynCall_viiiii:Oi,dynCall_viiiiii:Pi,establishStackSpace:$e,getTempRet0:rt,runPostSets:Ri,setTempRet0:tt,setThrew:et,stackAlloc:Ye,stackRestore:Qe,stackSave:Je}}(Module.asmGlobalArg,Module.asmLibraryArg,buffer),__GLOBAL__sub_I_bind_cpp=Module.__GLOBAL__sub_I_bind_cpp=asm.__GLOBAL__sub_I_bind_cpp,__GLOBAL__sub_I_whiteList_cpp=Module.__GLOBAL__sub_I_whiteList_cpp=asm.__GLOBAL__sub_I_whiteList_cpp,___errno_location=Module.___errno_location=asm.___errno_location,___getTypeName=Module.___getTypeName=asm.___getTypeName,_free=Module._free=asm._free,_malloc=Module._malloc=asm._malloc,_memcpy=Module._memcpy=asm._memcpy,_memset=Module._memset=asm._memset,_sbrk=Module._sbrk=asm._sbrk,establishStackSpace=Module.establishStackSpace=asm.establishStackSpace,getTempRet0=Module.getTempRet0=asm.getTempRet0,runPostSets=Module.runPostSets=asm.runPostSets,setTempRet0=Module.setTempRet0=asm.setTempRet0,setThrew=Module.setThrew=asm.setThrew,stackAlloc=Module.stackAlloc=asm.stackAlloc,stackRestore=Module.stackRestore=asm.stackRestore,stackSave=Module.stackSave=asm.stackSave,dynCall_i=Module.dynCall_i=asm.dynCall_i,dynCall_ii=Module.dynCall_ii=asm.dynCall_ii,dynCall_iiii=Module.dynCall_iiii=asm.dynCall_iiii,dynCall_vi=Module.dynCall_vi=asm.dynCall_vi,dynCall_viiii=Module.dynCall_viiii=asm.dynCall_viiii,dynCall_viiiii=Module.dynCall_viiiii=asm.dynCall_viiiii,dynCall_viiiiii=Module.dynCall_viiiiii=asm.dynCall_viiiiii;if(Module.asm=asm,memoryInitializer)if(isDataURI(memoryInitializer)||("function"==typeof Module.locateFile?memoryInitializer=Module.locateFile(memoryInitializer):Module.memoryInitializerPrefixURL&&(memoryInitializer=Module.memoryInitializerPrefixURL+memoryInitializer)),ENVIRONMENT_IS_NODE||ENVIRONMENT_IS_SHELL){var data=Module.readBinary(memoryInitializer);HEAPU8.set(data,GLOBAL_BASE)}else{addRunDependency("memory initializer");var applyMemoryInitializer=function(e){e.byteLength&&(e=new Uint8Array(e)),HEAPU8.set(e,GLOBAL_BASE),Module.memoryInitializerRequest&&delete Module.memoryInitializerRequest.response,removeRunDependency("memory initializer")};function doBrowserLoad(){Module.readAsync(memoryInitializer,applyMemoryInitializer,function(){throw"could not load memory initializer "+memoryInitializer})}var memoryInitializerBytes=tryParseAsDataURI(memoryInitializer);if(memoryInitializerBytes)applyMemoryInitializer(memoryInitializerBytes.buffer);else if(Module.memoryInitializerRequest){function useRequest(){var e=Module.memoryInitializerRequest,t=e.response;if(200!==e.status&&0!==e.status){var r=tryParseAsDataURI(Module.memoryInitializerRequestURL);if(!r)return console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+e.status+", retrying "+memoryInitializer),void doBrowserLoad();t=r.buffer}applyMemoryInitializer(t)}Module.memoryInitializerRequest.response?setTimeout(useRequest,0):Module.memoryInitializerRequest.addEventListener("load",useRequest)}else doBrowserLoad()}function ExitStatus(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}ExitStatus.prototype=new Error,ExitStatus.prototype.constructor=ExitStatus;var calledMain=!1;function run(e){function t(){Module.calledRun||(Module.calledRun=!0,ABORT||(ensureInitRuntime(),preMain(),Module.onRuntimeInitialized&&Module.onRuntimeInitialized(),postRun()))}e=e||Module.arguments,runDependencies>0||(preRun(),runDependencies>0||Module.calledRun||(Module.setStatus?(Module.setStatus("Running..."),setTimeout(function(){setTimeout(function(){Module.setStatus("")},1),t()},1)):t()))}function exit(e,t){t&&Module.noExitRuntime&&0===e||(Module.noExitRuntime||(ABORT=!0,EXITSTATUS=e,STACKTOP=initialStackTop,exitRuntime(),Module.onExit&&Module.onExit(e)),ENVIRONMENT_IS_NODE&&process.exit(e),Module.quit(e,new ExitStatus(e)))}dependenciesFulfilled=function e(){Module.calledRun||run(),Module.calledRun||(dependenciesFulfilled=e)},Module.run=run,Module.exit=exit;var abortDecorators=[];function abort(e){throw Module.onAbort&&Module.onAbort(e),void 0!==e?(Module.print(e),Module.printErr(e),e=JSON.stringify(e)):e="",ABORT=!0,EXITSTATUS=1,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}if(Module.abort=abort,Module.preInit)for("function"==typeof Module.preInit&&(Module.preInit=[Module.preInit]);Module.preInit.length>0;)Module.preInit.pop()();Module.noExitRuntime=!0,run(),function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={exports:{},id:i,loaded:!1};return e[i].call(n.exports,n,n.exports,r),n.loaded=!0,n.exports}r.m=e,r.c=t,r.p="",r(0)}([function(e,t,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},n=r(1);if("undefined"==typeof AFRAME)throw"Component attempted to register before AFRAME was available.";var o=AFRAME.utils.srcLoader.parseUrl,a=AFRAME.utils.debug;a.enable("shader:gif:warn");var s=a("shader:gif:warn"),l=(a("shader:gif:debug"),{});function c(e,t){return{status:"error",src:t,message:e,timestamp:Date.now()}}AFRAME.registerShader("gif",{schema:{color:{type:"color"},fog:{default:!0},src:{default:null},autoplay:{default:!0}},init:function(e){return console.log("init",e),console.log(this.el.components),this.__cnv=document.createElement("canvas"),this.__cnv.width=2,this.__cnv.height=2,this.__ctx=this.__cnv.getContext("2d"),this.__texture=new THREE.Texture(this.__cnv),this.__material={},this.__reset(),this.material=new THREE.MeshBasicMaterial({map:this.__texture}),this.el.sceneEl.addBehavior(this),this.__addPublicFunctions(),this.material},update:function(e){return console.log("update",e),this.__updateMaterial(e),this.__updateTexture(e),this.material},tick:function(e){this.__frames&&!this.paused()&&Date.now()-this.__startTime>=this.__nextFrameTime&&this.nextFrame()},__updateMaterial:function(e){var t=this.material;console.log("testmaterial",t);var r=this.__getMaterialData(e);Object.keys(r).forEach(function(e){t[e]=r[e]})},__getMaterialData:function(e){return console.log("test",e),{fog:e.fog,opacity:e.opacity}},__setTexure:function(e){console.log("__setTexure",e),"error"===e.status?(s("Error: "+e.message+"\nsrc: "+e.src),this.__reset()):"success"===e.status&&e.src!==this.__textureSrc&&(this.__reset(),this.__ready(e))},__updateTexture:function(e){var t=e.src,r=e.autoplay;"boolean"==typeof r?this.__autoplay=r:void 0===r&&(this.__autoplay=!0),this.__autoplay&&this.__frames&&this.play(),t?this.__validateSrc(t,this.__setTexure.bind(this)):this.__reset()},__validateSrc:function(e,t){var r=o(e);if(r)this.__getImageSrc(r,t);else{var n=void 0,a=this.__validateAndGetQuerySelector(e);if(a&&"object"===(void 0===a?"undefined":i(a))){if(a.error)n=a.error;else{var s=a.tagName.toLowerCase();if("video"===s)e=a.src,n="For video, please use `aframe-video-shader`";else{if("img"===s)return void this.__getImageSrc(a.src,t);n="For <"+s+"> element, please use `aframe-html-shader`"}}var u,d;n&&(u=l[e],d=c(n,e),u&&u.callbacks?u.callbacks.forEach(function(e){return e(d)}):t(d),l[e]=d)}}},__getImageSrc:function(e,t){var r=this;if(e!==this.__textureSrc){var i=l[e];if(i&&i.callbacks){if(i.src)return void t(i);if(i.callbacks)return void i.callbacks.push(t)}else(i=l[e]={callbacks:[]}).callbacks.push(t);var o=new Image;o.crossOrigin="Anonymous",o.addEventListener("load",function(t){r.__getUnit8Array(e,function(t){t?(0,n.parseGIF)(t,function(t,r,n){var o={status:"success",src:e,times:t,cnt:r,frames:n,timestamp:Date.now()};i.callbacks&&(i.callbacks.forEach(function(e){return e(o)}),l[e]=o)},function(e){return a(e)}):a("This is not gif. Please use `shader:flat` instead")})}),o.addEventListener("error",function(e){return a("Could be the following issue\n - Not Image\n - Not Found\n - Server Error\n - Cross-Origin Issue")}),o.src=e}function a(t){var r=c(t,e);i.callbacks&&(i.callbacks.forEach(function(e){return e(r)}),l[e]=r)}},__getUnit8Array:function(e,t){if("function"==typeof t){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="arraybuffer",r.addEventListener("load",function(e){for(var r=new Uint8Array(e.target.response),i=r.subarray(0,4),n="",o=0;o<i.length;o++)n+=i[o].toString(16);"47494638"===n?t(r):t()}),r.addEventListener("error",function(e){console.log(e),t()}),r.send()}},__validateAndGetQuerySelector:function(e){try{var t=document.querySelector(e);return t||{error:"No element was found matching the selector"}}catch(e){return{error:"no valid selector"}}},__addPublicFunctions:function(){this.el.gif={play:this.play.bind(this),pause:this.pause.bind(this),togglePlayback:this.togglePlayback.bind(this),paused:this.paused.bind(this),nextFrame:this.nextFrame.bind(this)}},pause:function(){console.log("pause"),this.__paused=!0},play:function(){console.log("play"),this.__paused=!1},togglePlayback:function(){this.paused()?this.play():this.pause()},paused:function(){return this.__paused},nextFrame:function(){for(this.__draw();Date.now()-this.__startTime>=this.__nextFrameTime;)this.__nextFrameTime+=this.__delayTimes[this.__frameIdx++],(this.__infinity||this.__loopCnt)&&this.__frameCnt<=this.__frameIdx&&(this.__frameIdx=0)},__clearCanvas:function(){this.__ctx.clearRect(0,0,this.__width,this.__height),this.__texture.needsUpdate=!0},__draw:function(){this.__ctx.drawImage(this.__frames[this.__frameIdx],0,0,this.__width,this.__height),this.__texture.needsUpdate=!0},__ready:function(e){var t=e.src,r=e.times,i=e.cnt,n=e.frames;console.log("__ready"),this.__textureSrc=t,this.__delayTimes=r,i?this.__loopCnt=i:this.__infinity=!0,this.__frames=n,this.__frameCnt=r.length,this.__startTime=Date.now(),this.__width=THREE.Math.floorPowerOfTwo(n[0].width),this.__height=THREE.Math.floorPowerOfTwo(n[0].height),this.__cnv.width=this.__width,this.__cnv.height=this.__height,this.__draw(),this.__autoplay?this.play():this.pause()},__reset:function(){this.pause(),this.__clearCanvas(),this.__startTime=0,this.__nextFrameTime=0,this.__frameIdx=0,this.__frameCnt=0,this.__delayTimes=null,this.__infinity=!1,this.__loopCnt=0,this.__frames=null,this.__textureSrc=null}})},function(e,t){"use strict";t.parseGIF=function(e,t,r){var i=0,n=[],o=0,a=null,s=null,l=[],c=0;if(71===e[0]&&73===e[1]&&70===e[2]&&56===e[3]&&57===e[4]&&97===e[5]){i+=+!!(128&e[10])*Math.pow(2,1+(7&e[10]))*3+13;for(var u=e.subarray(0,i);e[i]&&59!==e[i];){var d=i,h=e[i];if(33===h){var f=e[++i];if(-1===[1,254,249,255].indexOf(f)){r&&r("parseGIF: unknown label");break}for(249===f&&n.push(10*(e[i+3]+(e[i+4]<<8))),255===f&&(c=e[i+15]+(e[i+16]<<8));e[++i];)i+=e[i];249===f&&(a=e.subarray(d,i+1))}else{if(44!==h){r&&r("parseGIF: unknown blockId");break}for(i+=9,i+=+!!(128&e[i])*(3*Math.pow(2,1+(7&e[i])))+1;e[++i];)i+=e[i];s=e.subarray(d,i+1);l.push(URL.createObjectURL(new Blob([u,a,s])))}i++}}else r&&r("parseGIF: no GIF89a");if(l.length){var p=document.createElement("canvas"),m=function e(r){var i=new Image;i.onload=function(r,i){o++,l[i]=this,o===l.length?(p=null,t&&t(n,c,l)):e(++i)}.bind(i),i.src=p.toDataURL("image/gif")};l.forEach(function(e,t){var r=new Image;r.onload=function(e,t){0===t&&(p.width=r.width,p.height=r.height),o++,l[t]=this,o===l.length&&(o=0,m(1))}.bind(r,null,t),r.src=e})}}}]),function e(t,r,i){function n(a,s){if(!r[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=r[a]={exports:{}};t[a][0].call(u.exports,function(e){var r=t[a][1][e];return n(r||e)},u,u.exports,e,t,r,i)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}({1:[function(e,t,r){"use strict";e("./")},{"./":2}],2:[function(e,t,r){"use strict";e("./src/controls"),e("./src/loaders"),e("./src/misc"),e("./src/pathfinding"),e("./src/primitives")},{"./src/controls":14,"./src/loaders":23,"./src/misc":28,"./src/pathfinding":34,"./src/primitives":42}],3:[function(e,t,r){"use strict";t.exports=THREE.ColladaLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.ColladaLoader.prototype={constructor:THREE.ColladaLoader,crossOrigin:"anonymous",load:function(e,t,r,i){var n=this,o=void 0===n.path?THREE.LoaderUtils.extractUrlBase(e):n.path,a=new THREE.FileLoader(n.manager);a.setPath(n.path),a.load(e,function(e){t(n.parse(e,o))},r,i)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},options:{set convertUpAxis(e){console.warn("THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.")}},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){function r(e,t){for(var r=[],i=e.childNodes,n=0,o=i.length;n<o;n++){var a=i[n];a.nodeName===t&&r.push(a)}return r}function i(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=new Array(t.length),i=0,n=t.length;i<n;i++)r[i]=t[i];return r}function n(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=new Array(t.length),i=0,n=t.length;i<n;i++)r[i]=parseFloat(t[i]);return r}function o(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=new Array(t.length),i=0,n=t.length;i<n;i++)r[i]=parseInt(t[i]);return r}function a(e){return e.substring(1)}function s(e){return 0===Object.keys(e).length}function l(e){return void 0!==e&&!0===e.hasAttribute("meter")?parseFloat(e.getAttribute("meter")):1}function c(e){return void 0!==e?e.textContent:"Y_UP"}function u(e,t,i,n){var o=r(e,t)[0];if(void 0!==o)for(var a=r(o,i),s=0;s<a.length;s++)n(a[s])}function d(e,t){for(var r in e){e[r].build=t(e[r])}}function h(e,t){return void 0!==e.build?e.build:(e.build=t(e),e.build)}function f(e){for(var t={inputs:{}},r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"input":var o=a(n.getAttribute("source")),s=n.getAttribute("semantic");t.inputs[s]=o}}return t}function p(e){var t={},r=e.getAttribute("target").split("/"),i=r.shift(),n=r.shift(),o=-1!==n.indexOf("("),s=-1!==n.indexOf(".");if(s)r=n.split("."),n=r.shift(),t.member=r.shift();else if(o){var l=n.split("(");n=l.shift();for(var c=0;c<l.length;c++)l[c]=parseInt(l[c].replace(/\)/,""));t.indices=l}return t.id=i,t.sid=n,t.arraySyntax=o,t.memberSyntax=s,t.sampler=a(e.getAttribute("source")),t}function m(e){var t=[],r=e.channels,i=e.samplers,n=e.sources;for(var o in r)if(r.hasOwnProperty(o)){var a=r[o],s=i[a.sampler],l=s.inputs.INPUT,c=s.inputs.OUTPUT;A(g(a,n[l],n[c]),t)}return t}function v(e){return h(Ke.animations[e],m)}function g(e,t,r){var i,n,o,a,s,l,c=Ke.nodes[e.id],u=Pe(c.id),d=c.transforms[e.sid],h=c.matrix.clone().transpose(),f={};switch(d){case"matrix":for(o=0,a=t.array.length;o<a;o++)if(i=t.array[o],n=o*r.stride,void 0===f[i]&&(f[i]={}),!0===e.arraySyntax){var p=r.array[n],m=e.indices[0]+4*e.indices[1];f[i][m]=p}else for(s=0,l=r.stride;s<l;s++)f[i][s]=r.array[n+s];break;case"translate":case"rotate":case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',d)}var v=function(e,t){var r=[];for(var i in e)r.push({time:parseFloat(i),value:e[i]});r.sort(function(e,t){return e.time-t.time});for(var n=0;n<16;n++)_(r,n,t.elements[n]);return r}(f,h);return{name:u.uuid,keyframes:v}}var y=new THREE.Vector3,b=new THREE.Vector3,E=new THREE.Quaternion;function A(e,t){for(var r=e.keyframes,i=e.name,n=[],o=[],a=[],s=[],l=0,c=r.length;l<c;l++){var u=r[l],d=u.time,h=u.value;Te.fromArray(h).transpose(),Te.decompose(y,E,b),n.push(d),o.push(y.x,y.y,y.z),a.push(E.x,E.y,E.z,E.w),s.push(b.x,b.y,b.z)}return o.length>0&&t.push(new THREE.VectorKeyframeTrack(i+".position",n,o)),a.length>0&&t.push(new THREE.QuaternionKeyframeTrack(i+".quaternion",n,a)),s.length>0&&t.push(new THREE.VectorKeyframeTrack(i+".scale",n,s)),t}function _(e,t,r){var i,n,o,a=!0;for(n=0,o=e.length;n<o;n++)void 0===(i=e[n]).value[t]?i.value[t]=null:a=!1;if(!0===a)for(n=0,o=e.length;n<o;n++)(i=e[n]).value[t]=r;else!function(e,t){for(var r,i,n=0,o=e.length;n<o;n++){var a=e[n];if(null===a.value[t]){if(r=w(e,n,t),i=T(e,n,t),null===r){a.value[t]=i.value[t];continue}if(null===i){a.value[t]=r.value[t];continue}R(a,r,i,t)}}}(e,t)}function w(e,t,r){for(;t>=0;){var i=e[t];if(null!==i.value[r])return i;t--}return null}function T(e,t,r){for(;t<e.length;){var i=e[t];if(null!==i.value[r])return i;t++}return null}function R(e,t,r,i){r.time-t.time!=0?e.value[i]=(e.time-t.time)*(r.value[i]-t.value[i])/(r.time-t.time)+t.value[i]:e.value[i]=t.value[i]}function k(e){for(var t=[],r=e.name,i=e.end-e.start||-1,n=e.animations,o=0,a=n.length;o<a;o++)for(var s=v(n[o]),l=0,c=s.length;l<c;l++)t.push(s[l]);return new THREE.AnimationClip(r,i,t)}function M(e){return h(Ke.clips[e],k)}function x(e){for(var t={sources:{}},r=0,i=e.childNodes.length;r<i;r++){var o=e.childNodes[r];if(1===o.nodeType)switch(o.nodeName){case"bind_shape_matrix":t.bindShapeMatrix=n(o.textContent);break;case"source":var a=o.getAttribute("id");t.sources[a]=ne(o);break;case"joints":t.joints=S(o);break;case"vertex_weights":t.vertexWeights=C(o)}}return t}function S(e){for(var t={inputs:{}},r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"input":var o=n.getAttribute("semantic"),s=a(n.getAttribute("source"));t.inputs[o]=s}}return t}function C(e){for(var t={inputs:{}},r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"input":var s=n.getAttribute("semantic"),l=a(n.getAttribute("source")),c=parseInt(n.getAttribute("offset"));t.inputs[s]={id:l,offset:c};break;case"vcount":t.vcount=o(n.textContent);break;case"v":t.v=o(n.textContent)}}return t}function I(e){var t={id:e.id},r=Ke.geometries[t.id];return void 0!==e.skin&&(t.skin=function(e){var t,r,i,n={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},o=e.sources,a=e.vertexWeights,s=a.vcount,l=a.v,c=a.inputs.JOINT.offset,u=a.inputs.WEIGHT.offset,d=e.sources[e.joints.inputs.JOINT],h=e.sources[e.joints.inputs.INV_BIND_MATRIX],f=o[a.inputs.WEIGHT.id].array,p=0;for(t=0,i=s.length;t<i;t++){var m=s[t],v=[];for(r=0;r<m;r++){var g=l[p+c],y=l[p+u],b=f[y];v.push({index:g,weight:b}),p+=2}for(v.sort(w),r=0;r<4;r++){var E=v[r];void 0!==E?(n.indices.array.push(E.index),n.weights.array.push(E.weight)):(n.indices.array.push(0),n.weights.array.push(0))}}e.bindShapeMatrix?n.bindMatrix=(new THREE.Matrix4).fromArray(e.bindShapeMatrix).transpose():n.bindMatrix=(new THREE.Matrix4).identity();for(t=0,i=d.array.length;t<i;t++){var A=d.array[t],_=(new THREE.Matrix4).fromArray(h.array,t*h.stride).transpose();n.joints.push({name:A,boneInverse:_})}return n;function w(e,t){return t.weight-e.weight}}(e.skin),r.sources.skinIndices=t.skin.indices,r.sources.skinWeights=t.skin.weights),t}function N(e){return void 0!==e.build?e.build:e.init_from}function D(e){var t=Ke.images[e];return void 0!==t?h(t,N):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",e),null)}function O(e){for(var t={surfaces:{},samplers:{}},r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"newparam":P(n,t);break;case"technique":t.technique=L(n);break;case"extra":t.extra=G(n)}}return t}function P(e,t){for(var r=e.getAttribute("sid"),i=0,n=e.childNodes.length;i<n;i++){var o=e.childNodes[i];if(1===o.nodeType)switch(o.nodeName){case"surface":t.surfaces[r]=H(o);break;case"sampler2D":t.samplers[r]=j(o)}}}function H(e){for(var t={},r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"init_from":t.init_from=n.textContent}}return t}function j(e){for(var t={},r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"source":t.source=n.textContent}}return t}function L(e){for(var t={},r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"constant":case"lambert":case"blinn":case"phong":t.type=n.nodeName,t.parameters=F(n)}}return t}function F(e){for(var t={},r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":t[n.nodeName]=B(n);break;case"transparent":t[n.nodeName]={opaque:n.getAttribute("opaque"),data:B(n)}}}return t}function B(e){for(var t={},r=0,i=e.childNodes.length;r<i;r++){var o=e.childNodes[r];if(1===o.nodeType)switch(o.nodeName){case"color":t[o.nodeName]=n(o.textContent);break;case"float":t[o.nodeName]=parseFloat(o.textContent);break;case"texture":t[o.nodeName]={id:o.getAttribute("texture"),extra:V(o)}}}return t}function V(e){for(var t={technique:{}},r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"extra":U(n,t)}}return t}function U(e,t){for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"technique":z(n,t)}}}function z(e,t){for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":t.technique[n.nodeName]=parseFloat(n.textContent);break;case"wrapU":case"wrapV":"TRUE"===n.textContent.toUpperCase()?t.technique[n.nodeName]=1:"FALSE"===n.textContent.toUpperCase()?t.technique[n.nodeName]=0:t.technique[n.nodeName]=parseInt(n.textContent)}}}function G(e){for(var t={},r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"technique":t.technique=W(n)}}return t}function W(e){for(var t={},r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"double_sided":t[n.nodeName]=parseInt(n.textContent)}}return t}function K(e){return e}function X(e){var t,r,i=(t=e.url,h(Ke.effects[t],K)),n=i.profile.technique,o=i.profile.extra;switch(n.type){case"phong":case"blinn":r=new THREE.MeshPhongMaterial;break;case"lambert":r=new THREE.MeshLambertMaterial;break;default:r=new THREE.MeshBasicMaterial}function a(e){var t=i.profile.samplers[e.id],r=null;void 0!==t?r=D(i.profile.surfaces[t.source].init_from):(console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),r=D(e.id));if(null!==r){var n=function(e){var t,r=e.slice(2+(e.lastIndexOf(".")-1>>>0));switch(r=r.toLowerCase()){case"tga":t=Be;break;default:t=Ue}return t}(r);if(void 0!==n){var o=n.load(r),a=e.extra;if(void 0!==a&&void 0!==a.technique&&!1===s(a.technique)){var l=a.technique;o.wrapS=l.wrapU?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,o.wrapT=l.wrapV?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,o.offset.set(l.offsetU||0,l.offsetV||0),o.repeat.set(l.repeatU||1,l.repeatV||1)}else o.wrapS=THREE.RepeatWrapping,o.wrapT=THREE.RepeatWrapping;return o}return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",r),null}return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",e.id),null}r.name=e.name;var l=n.parameters;for(var c in l){var u=l[c];switch(c){case"diffuse":u.color&&r.color.fromArray(u.color),u.texture&&(r.map=a(u.texture));break;case"specular":u.color&&r.specular&&r.specular.fromArray(u.color),u.texture&&(r.specularMap=a(u.texture));break;case"bump":u.texture&&(r.normalMap=a(u.texture));break;case"ambient":u.texture&&(r.lightMap=a(u.texture));break;case"shininess":u.float&&r.shininess&&(r.shininess=u.float);break;case"emission":u.color&&r.emissive&&r.emissive.fromArray(u.color),u.texture&&(r.emissiveMap=a(u.texture))}}var d=l.transparent,f=l.transparency;if(void 0===f&&d&&(f={float:1}),void 0===d&&f&&(d={opaque:"A_ONE",data:{color:[1,1,1,1]}}),d&&f)if(d.data.texture)r.transparent=!0;else{var p=d.data.color;switch(d.opaque){case"A_ONE":r.opacity=p[3]*f.float;break;case"RGB_ZERO":r.opacity=1-p[0]*f.float;break;case"A_ZERO":r.opacity=1-p[3]*f.float;break;case"RGB_ONE":r.opacity=p[0]*f.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',d.opaque)}r.opacity<1&&(r.transparent=!0)}return void 0!==o&&void 0!==o.technique&&1===o.technique.double_sided&&(r.side=THREE.DoubleSide),r}function q(e){return h(Ke.materials[e],X)}function Z(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"technique_common":return Y(r)}}return{}}function Y(e){for(var t={},r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];switch(i.nodeName){case"perspective":case"orthographic":t.technique=i.nodeName,t.parameters=J(i)}}return t}function J(e){for(var t={},r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];switch(i.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":t[i.nodeName]=parseFloat(i.textContent)}}return t}function Q(e){var t;switch(e.optics.technique){case"perspective":t=new THREE.PerspectiveCamera(e.optics.parameters.yfov,e.optics.parameters.aspect_ratio,e.optics.parameters.znear,e.optics.parameters.zfar);break;case"orthographic":var r=e.optics.parameters.ymag,i=e.optics.parameters.xmag,n=e.optics.parameters.aspect_ratio;i=void 0===i?r*n:i,r=void 0===r?i/n:r,i*=.5,r*=.5,t=new THREE.OrthographicCamera(-i,i,r,-r,e.optics.parameters.znear,e.optics.parameters.zfar);break;default:t=new THREE.PerspectiveCamera}return t.name=e.name,t}function $(e){var t=Ke.cameras[e];return void 0!==t?h(t,Q):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",e),null)}function ee(e){for(var t={},r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"directional":case"point":case"spot":case"ambient":t.technique=n.nodeName,t.parameters=te(n)}}return t}function te(e){for(var t={},r=0,i=e.childNodes.length;r<i;r++){var o=e.childNodes[r];if(1===o.nodeType)switch(o.nodeName){case"color":var a=n(o.textContent);t.color=(new THREE.Color).fromArray(a);break;case"falloff_angle":t.falloffAngle=parseFloat(o.textContent);break;case"quadratic_attenuation":var s=parseFloat(o.textContent);t.distance=s?Math.sqrt(1/s):0}}return t}function re(e){var t;switch(e.technique){case"directional":t=new THREE.DirectionalLight;break;case"point":t=new THREE.PointLight;break;case"spot":t=new THREE.SpotLight;break;case"ambient":t=new THREE.AmbientLight}return e.parameters.color&&t.color.copy(e.parameters.color),e.parameters.distance&&(t.distance=e.parameters.distance),t}function ie(e){var t=Ke.lights[e];return void 0!==t?h(t,re):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",e),null)}function ne(e){for(var t={array:[],stride:3},o=0;o<e.childNodes.length;o++){var a=e.childNodes[o];if(1===a.nodeType)switch(a.nodeName){case"float_array":t.array=n(a.textContent);break;case"Name_array":t.array=i(a.textContent);break;case"technique_common":var s=r(a,"accessor")[0];void 0!==s&&(t.stride=parseInt(s.getAttribute("stride")))}}return t}function oe(e){for(var t={},r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];1===i.nodeType&&(t[i.getAttribute("semantic")]=a(i.getAttribute("source")))}return t}function ae(e){for(var t={type:e.nodeName,material:e.getAttribute("material"),count:parseInt(e.getAttribute("count")),inputs:{},stride:0,hasUV:!1},r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"input":var s=a(n.getAttribute("source")),l=n.getAttribute("semantic"),c=parseInt(n.getAttribute("offset")),u=parseInt(n.getAttribute("set")),d=u>0?l+u:l;t.inputs[d]={id:s,offset:c},t.stride=Math.max(t.stride,c+1),"TEXCOORD"===l&&(t.hasUV=!0);break;case"vcount":t.vcount=o(n.textContent);break;case"p":t.p=o(n.textContent)}}return t}function se(e){for(var t=0,r=0,i=e.length;r<i;r++){!0===e[r].hasUV&&t++}t>0&&t<e.length&&(e.uvsNeedsFix=!0)}function le(e){var t={},r=e.sources,i=e.vertices,n=e.primitives;if(0===n.length)return{};var o=function(e){for(var t={},r=0;r<e.length;r++){var i=e[r];void 0===t[i.type]&&(t[i.type]=[]),t[i.type].push(i)}return t}(n);for(var a in o){var s=o[a];se(s),t[a]=ce(s,r,i)}return t}function ce(e,t,r){for(var i={},n={array:[],stride:0},o={array:[],stride:0},a={array:[],stride:0},s={array:[],stride:0},l={array:[],stride:0},c=[],u=4,d=[],h=4,f=new THREE.BufferGeometry,p=[],m=0,v=0;v<e.length;v++){var g=e[v],y=g.inputs,b=0;switch(g.type){case"lines":case"linestrips":b=2*g.count;break;case"triangles":b=3*g.count;break;case"polylist":for(var E=0;E<g.count;E++){var A=g.vcount[E];switch(A){case 3:b+=3;break;case 4:b+=6;break;default:b+=3*(A-2)}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",g.type)}for(var _ in f.addGroup(m,b,v),m+=b,g.material&&p.push(g.material),y){var w=y[_];switch(_){case"VERTEX":for(var T in r){var R=r[T];switch(T){case"POSITION":var k=n.array.length;if(ue(g,t[R],w.offset,n.array),n.stride=t[R].stride,t.skinWeights&&t.skinIndices&&(ue(g,t.skinIndices,w.offset,c),ue(g,t.skinWeights,w.offset,d)),!1===g.hasUV&&!0===e.uvsNeedsFix){b=(n.array.length-k)/n.stride;for(var M=0;M<b;M++)a.array.push(0,0)}break;case"NORMAL":ue(g,t[R],w.offset,o.array),o.stride=t[R].stride;break;case"COLOR":ue(g,t[R],w.offset,l.array),l.stride=t[R].stride;break;case"TEXCOORD":ue(g,t[R],w.offset,a.array),a.stride=t[R].stride;break;case"TEXCOORD1":ue(g,t[R],w.offset,s.array),a.stride=t[R].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',T)}}break;case"NORMAL":ue(g,t[w.id],w.offset,o.array),o.stride=t[w.id].stride;break;case"COLOR":ue(g,t[w.id],w.offset,l.array),l.stride=t[w.id].stride;break;case"TEXCOORD":ue(g,t[w.id],w.offset,a.array),a.stride=t[w.id].stride;break;case"TEXCOORD1":ue(g,t[w.id],w.offset,s.array),s.stride=t[w.id].stride}}}return n.array.length>0&&f.addAttribute("position",new THREE.Float32BufferAttribute(n.array,n.stride)),o.array.length>0&&f.addAttribute("normal",new THREE.Float32BufferAttribute(o.array,o.stride)),l.array.length>0&&f.addAttribute("color",new THREE.Float32BufferAttribute(l.array,l.stride)),a.array.length>0&&f.addAttribute("uv",new THREE.Float32BufferAttribute(a.array,a.stride)),s.array.length>0&&f.addAttribute("uv2",new THREE.Float32BufferAttribute(s.array,s.stride)),c.length>0&&f.addAttribute("skinIndex",new THREE.Float32BufferAttribute(c,u)),d.length>0&&f.addAttribute("skinWeight",new THREE.Float32BufferAttribute(d,h)),i.data=f,i.type=e[0].type,i.materialKeys=p,i}function ue(e,t,r,i){var n=e.p,o=e.stride,a=e.vcount;function s(e){for(var t=n[e+r]*c,o=t+c;t<o;t++)i.push(l[t])}var l=t.array,c=t.stride;if(void 0!==e.vcount)for(var u=0,d=0,h=a.length;d<h;d++){var f=a[d];if(4===f){var p=u+1*o,m=u+2*o,v=u+3*o;s(u+0*o),s(p),s(v),s(p),s(m),s(v)}else if(3===f){p=u+1*o,m=u+2*o;s(u+0*o),s(p),s(m)}else if(f>4)for(var g=1,y=f-2;g<=y;g++){p=u+o*g,m=u+o*(g+1);s(u+0*o),s(p),s(m)}u+=o*f}else for(d=0,h=n.length;d<h;d+=o)s(d)}function de(e){return h(Ke.geometries[e],le)}function he(e){return void 0!==e.build?e.build:e}function fe(e,t){for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"joint":t.joints[i.getAttribute("sid")]=pe(i);break;case"link":t.links.push(ve(i))}}}function pe(e){for(var t,r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"prismatic":case"revolute":t=me(i)}}return t}function me(e,t){t={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",axis:new THREE.Vector3,limits:{min:0,max:0},type:e.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"axis":var o=n(i.textContent);t.axis.fromArray(o);break;case"limits":var a=i.getElementsByTagName("max")[0],s=i.getElementsByTagName("min")[0];t.limits.max=parseFloat(a.textContent),t.limits.min=parseFloat(s.textContent)}}return t.limits.min>=t.limits.max&&(t.static=!0),t.middlePosition=(t.limits.min+t.limits.max)/2,t}function ve(e){for(var t={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",attachments:[],transforms:[]},r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"attachment_full":t.attachments.push(ge(i));break;case"matrix":case"translate":case"rotate":t.transforms.push(ye(i))}}return t}function ge(e){for(var t={joint:e.getAttribute("joint").split("/").pop(),transforms:[],links:[]},r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"link":t.links.push(ve(i));break;case"matrix":case"translate":case"rotate":t.transforms.push(ye(i))}}return t}function ye(e){var t={type:e.nodeName},r=n(e.textContent);switch(t.type){case"matrix":t.obj=new THREE.Matrix4,t.obj.fromArray(r).transpose();break;case"translate":t.obj=new THREE.Vector3,t.obj.fromArray(r);break;case"rotate":t.obj=new THREE.Vector3,t.obj.fromArray(r),t.angle=THREE.Math.degToRad(r[3])}return t}function be(e,t){for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"technique_common":Ee(i,t)}}}function Ee(e,t){for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"inertia":t.inertia=n(i.textContent);break;case"mass":t.mass=n(i.textContent)[0]}}}function Ae(e){for(var t={target:e.getAttribute("target").split("/").pop()},r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"axis":var n=i.getElementsByTagName("param")[0];t.axis=n.textContent;var o=t.axis.split("inst_").pop().split("axis")[0];t.jointIndex=o.substr(0,o.length-1)}}return t}function _e(e){return void 0!==e.build?e.build:e}function we(e){for(var t=[],r=Le.querySelector('[id="'+e.id+'"]'),i=0;i<r.childNodes.length;i++){var o=r.childNodes[i];if(1===o.nodeType)switch(o.nodeName){case"matrix":var a=n(o.textContent),s=(new THREE.Matrix4).fromArray(a).transpose();t.push({sid:o.getAttribute("sid"),type:o.nodeName,obj:s});break;case"translate":case"scale":a=n(o.textContent);var l=(new THREE.Vector3).fromArray(a);t.push({sid:o.getAttribute("sid"),type:o.nodeName,obj:l});break;case"rotate":a=n(o.textContent),l=(new THREE.Vector3).fromArray(a);var c=THREE.Math.degToRad(a[3]);t.push({sid:o.getAttribute("sid"),type:o.nodeName,obj:l,angle:c})}}return t}var Te=new THREE.Matrix4,Re=new THREE.Vector3;function ke(e){for(var t={name:e.getAttribute("name")||"",type:e.getAttribute("type"),id:e.getAttribute("id"),sid:e.getAttribute("sid"),matrix:new THREE.Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}},r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"node":t.nodes.push(i.getAttribute("id")),ke(i);break;case"instance_camera":t.instanceCameras.push(a(i.getAttribute("url")));break;case"instance_controller":t.instanceControllers.push(Me(i));break;case"instance_light":t.instanceLights.push(a(i.getAttribute("url")));break;case"instance_geometry":t.instanceGeometries.push(Me(i));break;case"instance_node":t.instanceNodes.push(a(i.getAttribute("url")));break;case"matrix":var o=n(i.textContent);t.matrix.multiply(Te.fromArray(o).transpose()),t.transforms[i.getAttribute("sid")]=i.nodeName;break;case"translate":o=n(i.textContent);Re.fromArray(o),t.matrix.multiply(Te.makeTranslation(Re.x,Re.y,Re.z)),t.transforms[i.getAttribute("sid")]=i.nodeName;break;case"rotate":o=n(i.textContent);var s=THREE.Math.degToRad(o[3]);t.matrix.multiply(Te.makeRotationAxis(Re.fromArray(o),s)),t.transforms[i.getAttribute("sid")]=i.nodeName;break;case"scale":o=n(i.textContent);t.matrix.scale(Re.fromArray(o)),t.transforms[i.getAttribute("sid")]=i.nodeName;break;case"extra":break;default:console.log(i)}}return Oe(t.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",t.id):Ke.nodes[t.id]=t,t}function Me(e){for(var t={id:a(e.getAttribute("url")),materials:{},skeletons:[]},r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];switch(i.nodeName){case"bind_material":for(var n=i.getElementsByTagName("instance_material"),o=0;o<n.length;o++){var s=n[o],l=s.getAttribute("symbol"),c=s.getAttribute("target");t.materials[l]=a(c)}break;case"skeleton":t.skeletons.push(a(i.textContent))}}return t}function xe(e,t){var r,i,n,o=[],a=[];for(r=0;r<e.length;r++){var s=e[r];if(Oe(s))Se(Pe(s),t,o);else if(n=s,void 0!==Ke.visualScenes[n])for(var l=Ke.visualScenes[s].children,c=0;c<l.length;c++){var u=l[c];if("JOINT"===u.type)Se(Pe(u.id),t,o)}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",s)}for(r=0;r<t.length;r++)for(c=0;c<o.length;c++)if((i=o[c]).bone.name===t[r].name){a[r]=i,i.processed=!0;break}for(r=0;r<o.length;r++)!1===(i=o[r]).processed&&(a.push(i),i.processed=!0);var d=[],h=[];for(r=0;r<a.length;r++)i=a[r],d.push(i.bone),h.push(i.boneInverse);return new THREE.Skeleton(d,h)}function Se(e,t,r){e.traverse(function(e){if(!0===e.isBone){for(var i,n=0;n<t.length;n++){var o=t[n];if(o.name===e.name){i=o.boneInverse;break}}void 0===i&&(i=new THREE.Matrix4),r.push({bone:e,boneInverse:i,processed:!1})}})}function Ce(e){for(var t,r=[],i=e.matrix,n=e.nodes,o=e.type,a=e.instanceCameras,s=e.instanceControllers,l=e.instanceLights,c=e.instanceGeometries,u=e.instanceNodes,d=0,f=n.length;d<f;d++)r.push(Pe(n[d]));for(d=0,f=a.length;d<f;d++){var p=$(a[d]);null!==p&&r.push(p.clone())}for(d=0,f=s.length;d<f;d++)for(var m=s[d],v=(t=m.id,h(Ke.controllers[t],I)),g=De(de(v.id),m.materials),y=xe(m.skeletons,v.skin.joints),b=0,E=g.length;b<E;b++){var A;(A=g[b]).isSkinnedMesh&&(A.bind(y,v.skin.bindMatrix),A.normalizeSkinWeights()),r.push(A)}for(d=0,f=l.length;d<f;d++){var _=ie(l[d]);null!==_&&r.push(_.clone())}for(d=0,f=c.length;d<f;d++)for(b=0,E=(g=De(de((m=c[d]).id),m.materials)).length;b<E;b++)r.push(g[b]);for(d=0,f=u.length;d<f;d++)r.push(Pe(u[d]).clone());if(0===n.length&&1===r.length)A=r[0];else{A="JOINT"===o?new THREE.Bone:new THREE.Group;for(d=0;d<r.length;d++)A.add(r[d])}return""===A.name&&(A.name="JOINT"===o?e.sid:e.name),A.matrix.copy(i),A.matrix.decompose(A.position,A.quaternion,A.scale),A}var Ie=new THREE.MeshBasicMaterial({color:16711935});function Ne(e,t){for(var r=[],i=0,n=e.length;i<n;i++){var o=t[e[i]];void 0===o?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",e[i]),r.push(Ie)):r.push(q(o))}return r}function De(e,t){var r=[];for(var i in e){var n=e[i],o=Ne(n.materialKeys,t);0===o.length&&("lines"===i||"linestrips"===i?o.push(new THREE.LineBasicMaterial):o.push(new THREE.MeshPhongMaterial));var a=void 0!==n.data.attributes.skinIndex;if(a)for(var s=0,l=o.length;s<l;s++)o[s].skinning=!0;var c,u=1===o.length?o[0]:o;switch(i){case"lines":c=new THREE.LineSegments(n.data,u);break;case"linestrips":c=new THREE.Line(n.data,u);break;case"triangles":case"polylist":c=a?new THREE.SkinnedMesh(n.data,u):new THREE.Mesh(n.data,u)}r.push(c)}return r}function Oe(e){return void 0!==Ke.nodes[e]}function Pe(e){return h(Ke.nodes[e],Ce)}function He(e){var t=new THREE.Group;t.name=e.name;for(var r=e.children,i=0;i<r.length;i++){var n=r[i];t.add(Pe(n.id))}return t}function je(e){return h(Ke.visualScenes[e],He)}if(0===e.length)return{scene:new THREE.Scene};var Le=r((new DOMParser).parseFromString(e,"application/xml"),"COLLADA")[0],Fe=Le.getAttribute("version");console.log("THREE.ColladaLoader: File version",Fe);var Be,Ve=function(e){return{unit:l(r(e,"unit")[0]),upAxis:c(r(e,"up_axis")[0])}}(r(Le,"asset")[0]),Ue=new THREE.TextureLoader(this.manager);Ue.setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin),THREE.TGALoader&&(Be=new THREE.TGALoader(this.manager)).setPath(this.resourcePath||t);var ze=[],Ge={},We=0,Ke={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};u(Le,"library_animations","animation",function(e){for(var t={sources:{},samplers:{},channels:{}},r=0,i=e.childNodes.length;r<i;r++){var n,o=e.childNodes[r];if(1===o.nodeType)switch(o.nodeName){case"source":n=o.getAttribute("id"),t.sources[n]=ne(o);break;case"sampler":n=o.getAttribute("id"),t.samplers[n]=f(o);break;case"channel":n=o.getAttribute("target"),t.channels[n]=p(o);break;default:console.log(o)}}Ke.animations[e.getAttribute("id")]=t}),u(Le,"library_animation_clips","animation_clip",function(e){for(var t={name:e.getAttribute("id")||"default",start:parseFloat(e.getAttribute("start")||0),end:parseFloat(e.getAttribute("end")||0),animations:[]},r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"instance_animation":t.animations.push(a(n.getAttribute("url")))}}Ke.clips[e.getAttribute("id")]=t}),u(Le,"library_controllers","controller",function(e){for(var t={},r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"skin":t.id=a(n.getAttribute("source")),t.skin=x(n);break;case"morph":t.id=a(n.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.")}}Ke.controllers[e.getAttribute("id")]=t}),u(Le,"library_images","image",function(e){var t={init_from:r(e,"init_from")[0].textContent};Ke.images[e.getAttribute("id")]=t}),u(Le,"library_effects","effect",function(e){for(var t={},r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"profile_COMMON":t.profile=O(n)}}Ke.effects[e.getAttribute("id")]=t}),u(Le,"library_materials","material",function(e){for(var t={name:e.getAttribute("name")},r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"instance_effect":t.url=a(n.getAttribute("url"))}}Ke.materials[e.getAttribute("id")]=t}),u(Le,"library_cameras","camera",function(e){for(var t={name:e.getAttribute("name")},r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"optics":t.optics=Z(n)}}Ke.cameras[e.getAttribute("id")]=t}),u(Le,"library_lights","light",function(e){for(var t={},r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"technique_common":t=ee(n)}}Ke.lights[e.getAttribute("id")]=t}),u(Le,"library_geometries","geometry",function(e){var t={name:e.getAttribute("name"),sources:{},vertices:{},primitives:[]},i=r(e,"mesh")[0];if(void 0!==i){for(var n=0;n<i.childNodes.length;n++){var o=i.childNodes[n];if(1===o.nodeType){var a=o.getAttribute("id");switch(o.nodeName){case"source":t.sources[a]=ne(o);break;case"vertices":t.vertices=oe(o);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",o.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":t.primitives.push(ae(o));break;default:console.log(o)}}}Ke.geometries[e.getAttribute("id")]=t}}),u(Le,"library_nodes","node",ke),u(Le,"library_visual_scenes","visual_scene",function(e){var t={name:e.getAttribute("name"),children:[]};!function(e){for(var t=e.getElementsByTagName("node"),r=0;r<t.length;r++){var i=t[r];!1===i.hasAttribute("id")&&i.setAttribute("id","three_default_"+We++)}}(e);for(var i=r(e,"node"),n=0;n<i.length;n++)t.children.push(ke(i[n]));Ke.visualScenes[e.getAttribute("id")]=t}),u(Le,"library_kinematics_models","kinematics_model",function(e){for(var t={name:e.getAttribute("name")||"",joints:{},links:[]},r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"technique_common":fe(i,t)}}Ke.kinematicsModels[e.getAttribute("id")]=t}),u(Le,"library_physics_models","physics_model",function(e){for(var t={name:e.getAttribute("name")||"",rigidBodies:{}},r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"rigid_body":t.rigidBodies[i.getAttribute("name")]={},be(i,t.rigidBodies[i.getAttribute("name")])}}Ke.physicsModels[e.getAttribute("id")]=t}),u(Le,"scene","instance_kinematics_scene",function(e){for(var t={bindJointAxis:[]},r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"bind_joint_axis":t.bindJointAxis.push(Ae(i))}}Ke.kinematicsScenes[a(e.getAttribute("url"))]=t}),d(Ke.animations,m),d(Ke.clips,k),d(Ke.controllers,I),d(Ke.images,N),d(Ke.effects,K),d(Ke.materials,X),d(Ke.cameras,Q),d(Ke.lights,re),d(Ke.geometries,le),d(Ke.visualScenes,He),function(){var e=Ke.clips;if(!0===s(e)){if(!1===s(Ke.animations)){var t=[];for(var r in Ke.animations)for(var i=v(r),n=0,o=i.length;n<o;n++)t.push(i[n]);ze.push(new THREE.AnimationClip("default",-1,t))}}else for(var r in e)ze.push(M(r))}(),function(){var e=Object.keys(Ke.kinematicsModels)[0],t=Object.keys(Ke.kinematicsScenes)[0],r=Object.keys(Ke.visualScenes)[0];if(void 0!==e&&void 0!==t){for(var i,n=(i=e,h(Ke.kinematicsModels[i],he)),o=function(e){return h(Ke.kinematicsScenes[e],_e)}(t),a=je(r),s=o.bindJointAxis,l={},c=0,u=s.length;c<u;c++){var d=s[c],f=Le.querySelector('[sid="'+d.target+'"]');if(f){var p=f.parentElement;v(d.jointIndex,p)}}var m=new THREE.Matrix4;Ge={joints:n&&n.joints,getJointValue:function(e){var t=l[e];if(t)return t.position;console.warn("THREE.ColladaLoader: Joint "+e+" doesn't exist.")},setJointValue:function(e,t){var r=l[e];if(r){var i=r.joint;if(t>i.limits.max||t<i.limits.min)console.warn("THREE.ColladaLoader: Joint "+e+" value "+t+" outside of limits (min: "+i.limits.min+", max: "+i.limits.max+").");else if(i.static)console.warn("THREE.ColladaLoader: Joint "+e+" is static.");else{var n=r.object,o=i.axis,a=r.transforms;Te.identity();for(var s=0;s<a.length;s++){var c=a[s];if(c.sid&&-1!==c.sid.indexOf(e))switch(i.type){case"revolute":Te.multiply(m.makeRotationAxis(o,THREE.Math.degToRad(t)));break;case"prismatic":Te.multiply(m.makeTranslation(o.x*t,o.y*t,o.z*t));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+i.type)}else switch(c.type){case"matrix":Te.multiply(c.obj);break;case"translate":Te.multiply(m.makeTranslation(c.obj.x,c.obj.y,c.obj.z));break;case"scale":Te.scale(c.obj);break;case"rotate":Te.multiply(m.makeRotationAxis(c.obj,c.angle))}}n.matrix.copy(Te),n.matrix.decompose(n.position,n.quaternion,n.scale),l[e].position=t}}else console.log("THREE.ColladaLoader: "+e+" does not exist.")}}}function v(e,t){var r=t.getAttribute("name"),i=n.joints[e];a.traverse(function(n){n.name===r&&(l[e]={object:n,transforms:we(t),joint:i,position:i.zeroPosition})})}}();var Xe=function(e){return je(a(r(e,"instance_visual_scene")[0].getAttribute("url")))}(r(Le,"scene")[0]);return"Z_UP"===Ve.upAxis&&Xe.quaternion.setFromEuler(new THREE.Euler(-Math.PI/2,0,0)),Xe.scale.multiplyScalar(Ve.unit),{animations:ze,kinematics:Ge,library:Ke,scene:Xe}}}},{}],4:[function(e,t,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};"function"==typeof Symbol&&i(Symbol.iterator);t.exports=THREE.FBXLoader=function(){var e,t,r;function i(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager}function n(e){this.textureLoader=e}function o(){}function a(){}function s(){}function l(){}function c(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t}function u(){}function d(e){var t=e.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function h(e){return e/46186158e3}i.prototype={constructor:i,crossOrigin:"anonymous",load:function(e,t,r,i){var n=this,o=void 0===n.path?THREE.LoaderUtils.extractUrlBase(e):n.path,a=new THREE.FileLoader(this.manager);a.setResponseType("arraybuffer"),a.load(e,function(r){try{t(n.parse(r,o))}catch(t){setTimeout(function(){i&&i(t),n.manager.itemError(e)},0)}},r,i)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(t,r){if(function(e){var t="Kaydara FBX Binary  \0";return e.byteLength>=t.length&&t===E(e,0,t.length)}(t))e=(new l).parse(t);else{var i=E(t);if(!function(e){var t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],r=0;for(var i=0;i<t.length;++i){if((o=void 0,o=e[(n=1)-1],e=e.slice(r+n),r++,o)===t[i])return!1}var n,o;return!0}(i))throw new Error("THREE.FBXLoader: Unknown format.");if(d(i)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+d(i));e=(new s).parse(i)}return new n(new THREE.TextureLoader(this.manager).setPath(this.resourcePath||r).setCrossOrigin(this.crossOrigin)).parse(e)}},n.prototype={constructor:n,parse:function(){t=this.parseConnections();var i=this.parseImages(),n=this.parseTextures(i),a=this.parseMaterials(n),s=this.parseDeformers(),l=(new o).parse(s);return this.parseScene(s,l,a),e&&e.FBXHeaderExtension&&e.FBXHeaderExtension.SceneInfo&&e.FBXHeaderExtension.SceneInfo["LastSaved|ApplicationName"]&&(r["LastSaved|ApplicationName"]||(r["LastSaved|ApplicationName"]=e.FBXHeaderExtension.SceneInfo["LastSaved|ApplicationName"])),e&&e.GlobalSettings&&e.GlobalSettings.OriginalUnitScaleFactor&&e.GlobalSettings.OriginalUnitScaleFactor.value&&(r.OriginalUnitScaleFactor||(r.OriginalUnitScaleFactor=e.GlobalSettings.OriginalUnitScaleFactor.value)),r},parseConnections:function(){var t=new Map;"Connections"in e&&e.Connections.connections.forEach(function(e){var r=e[0],i=e[1],n=e[2];t.has(r)||t.set(r,{parents:[],children:[]});var o={ID:i,relationship:n};t.get(r).parents.push(o),t.has(i)||t.set(i,{parents:[],children:[]});var a={ID:r,relationship:n};t.get(i).children.push(a)});return t},parseImages:function(){var t={},r={};if("Video"in e.Objects){var i=e.Objects.Video;for(var n in i){var o=i[n];if(t[c=parseInt(n)]=o.RelativeFilename||o.Filename,"Content"in o){var a=o.Content instanceof ArrayBuffer&&o.Content.byteLength>0,s="string"==typeof o.Content&&""!==o.Content;if(a||s){var l=this.parseImage(i[n]);r[o.RelativeFilename||o.Filename]=l}}}}for(var c in t){var u=t[c];void 0!==r[u]?t[c]=r[u]:t[c]=t[c].split("\\").pop()}return t},parseImage:function(e){var t,r=e.Content,i=e.RelativeFilename||e.Filename,n=i.slice(i.lastIndexOf(".")+1).toLowerCase();switch(n){case"bmp":t="image/bmp";break;case"jpg":case"jpeg":t="image/jpeg";break;case"png":t="image/png";break;case"tif":t="image/tiff";break;case"tga":if("function"!=typeof THREE.TGALoader)return void console.warn("FBXLoader: THREE.TGALoader is required to load TGA textures");if(null===THREE.Loader.Handlers.get(".tga")){var o=new THREE.TGALoader;o.setPath(this.textureLoader.path),THREE.Loader.Handlers.add(/\.tga$/i,o)}t="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+n+'" is not supported.')}if("string"==typeof r)return"data:"+t+";base64,"+r;var a=new Uint8Array(r);return window.URL.createObjectURL(new Blob([a],{type:t}))},parseTextures:function(t){var r=new Map;if("Texture"in e.Objects){var i=e.Objects.Texture;for(var n in i){var o=this.parseTexture(i[n],t);r.set(parseInt(n),o)}}return r},parseTexture:function(e,t){var r=this.loadTexture(e,t);r.ID=e.id,r.name=e.attrName;var i=e.WrapModeU,n=e.WrapModeV,o=void 0!==i?i.value:0,a=void 0!==n?n.value:0;if(r.wrapS=0===o?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,r.wrapT=0===a?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,"Scaling"in e){var s=e.Scaling.value;r.repeat.x=s[0],r.repeat.y=s[1]}return r},loadTexture:function(e,r){var i,n,o=this.textureLoader.path,a=t.get(e.id).children;void 0!==a&&a.length>0&&void 0!==r[a[0].ID]&&(0!==(i=r[a[0].ID]).indexOf("blob:")&&0!==i.indexOf("data:")||this.textureLoader.setPath(void 0));var s=e.FileName.slice(-3).toLowerCase();if("tga"===s){var l=THREE.Loader.Handlers.get(".tga");null===l?(console.warn("FBXLoader: TGALoader not found, creating empty placeholder texture for",i),n=new THREE.Texture):n=l.load(i)}else"psd"===s?(console.warn("FBXLoader: PSD textures are not supported, creating empty placeholder texture for",i),n=new THREE.Texture):n=this.textureLoader.load(i);return this.textureLoader.setPath(o),n},parseMaterials:function(t){var r=new Map;if("Material"in e.Objects){var i=e.Objects.Material;for(var n in i){var o=this.parseMaterial(i[n],t);null!==o&&r.set(parseInt(n),o)}}return r},parseMaterial:function(e,r){var i=e.id,n=e.attrName,o=e.ShadingModel;if("object"==typeof o&&(o=o.value),!t.has(i))return null;var a,s=this.parseParameters(e,r,i);switch(o.toLowerCase()){case"phong":a=new THREE.MeshPhongMaterial;break;case"lambert":a=new THREE.MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',o),a=new THREE.MeshPhongMaterial({color:3342591})}return a.setValues(s),a.name=n,a},parseParameters:function(e,r,i){var n={};e.BumpFactor&&(n.bumpScale=e.BumpFactor.value),e.Diffuse?n.color=(new THREE.Color).fromArray(e.Diffuse.value):e.DiffuseColor&&"Color"===e.DiffuseColor.type&&(n.color=(new THREE.Color).fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(n.displacementScale=e.DisplacementFactor.value),e.Emissive?n.emissive=(new THREE.Color).fromArray(e.Emissive.value):e.EmissiveColor&&"Color"===e.EmissiveColor.type&&(n.emissive=(new THREE.Color).fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(n.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(n.opacity=parseFloat(e.Opacity.value)),n.opacity<1&&(n.transparent=!0),e.ReflectionFactor&&(n.reflectivity=e.ReflectionFactor.value),e.Shininess&&(n.shininess=e.Shininess.value),e.Specular?n.specular=(new THREE.Color).fromArray(e.Specular.value):e.SpecularColor&&"Color"===e.SpecularColor.type&&(n.specular=(new THREE.Color).fromArray(e.SpecularColor.value));var o=this;return t.get(i).children.forEach(function(e){var t=e.relationship;switch(t){case"Bump":n.bumpMap=o.getTexture(r,e.ID);break;case"DiffuseColor":n.map=o.getTexture(r,e.ID);break;case"DisplacementColor":n.displacementMap=o.getTexture(r,e.ID);break;case"EmissiveColor":n.emissiveMap=o.getTexture(r,e.ID);break;case"NormalMap":n.normalMap=o.getTexture(r,e.ID);break;case"ReflectionColor":n.envMap=o.getTexture(r,e.ID),n.envMap.mapping=THREE.EquirectangularReflectionMapping;break;case"SpecularColor":n.specularMap=o.getTexture(r,e.ID);break;case"TransparentColor":n.alphaMap=o.getTexture(r,e.ID),n.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",t)}}),n},getTexture:function(r,i){return"LayeredTexture"in e.Objects&&i in e.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),i=t.get(i).children[0].ID),r.get(i)},parseDeformers:function(){var r={},i={};if("Deformer"in e.Objects){var n=e.Objects.Deformer;for(var o in n){var a=n[o],s=t.get(parseInt(o));if("Skin"===a.attrType){var l=this.parseSkeleton(s,n);l.ID=o,s.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),l.geometryID=s.parents[0].ID,r[o]=l}else if("BlendShape"===a.attrType){var c={id:o};c.rawTargets=this.parseMorphTargets(s,n),c.id=o,s.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),i[o]=c}}}return{skeletons:r,morphTargets:i}},parseSkeleton:function(e,t){var r=[];return e.children.forEach(function(e){var i=t[e.ID];if("Cluster"===i.attrType){var n={ID:e.ID,indices:[],weights:[],transformLink:(new THREE.Matrix4).fromArray(i.TransformLink.a)};"Indexes"in i&&(n.indices=i.Indexes.a,n.weights=i.Weights.a),r.push(n)}}),{rawBones:r,bones:[]}},parseMorphTargets:function(e,r){for(var i=[],n=0;n<e.children.length;n++){var o=e.children[n],a=r[o.ID],s={name:a.attrName,initialWeight:a.DeformPercent,id:a.id,fullWeights:a.FullWeights.a};if("BlendShapeChannel"!==a.attrType)return;t.get(parseInt(o.ID)).children.forEach(function(e){void 0===e.relationship&&(s.geoID=e.ID)}),i.push(s)}return i},parseScene:function(i,n,o){r=new THREE.Group;var s=this.parseModels(i.skeletons,n,o),l=e.Objects.Model,c=this;s.forEach(function(e){var i=l[e.ID];c.setLookAtProperties(e,i),t.get(e.ID).parents.forEach(function(t){var r=s.get(t.ID);void 0!==r&&r.add(e)}),null===e.parent&&r.add(e)}),this.bindSkeleton(i.skeletons,n,s),this.createAmbientLight(),this.setupMorphMaterials(),r.traverse(function(e){if(e.userData.transformData){e.parent&&(e.userData.transformData.parentMatrixWorld=e.parent.matrix);var t=g(e.userData.transformData);e.applyMatrix(t)}});var u=(new a).parse();1===r.children.length&&r.children[0].isGroup&&(r.children[0].animations=u,r=r.children[0]),r.animations=u},parseModels:function(r,i,n){var o=new Map,a=e.Objects.Model;for(var s in a){var l=parseInt(s),c=a[s],u=t.get(l),d=this.buildSkeleton(u,r,l,c.attrName);if(!d){switch(c.attrType){case"Camera":d=this.createCamera(u);break;case"Light":d=this.createLight(u);break;case"Mesh":d=this.createMesh(u,i,n);break;case"NurbsCurve":d=this.createCurve(u,i);break;case"LimbNode":case"Root":d=new THREE.Bone;break;case"Null":default:d=new THREE.Group}d.name=THREE.PropertyBinding.sanitizeNodeName(c.attrName),d.ID=l}this.getTransformData(d,c),o.set(l,d)}return o},buildSkeleton:function(e,t,r,i){var n=null;return e.parents.forEach(function(e){for(var o in t){var a=t[o];a.rawBones.forEach(function(t,o){if(t.ID===e.ID){var s=n;(n=new THREE.Bone).matrixWorld.copy(t.transformLink),n.name=THREE.PropertyBinding.sanitizeNodeName(i),n.ID=r,a.bones[o]=n,null!==s&&n.add(s)}})}}),n},createCamera:function(t){var r,i;if(t.children.forEach(function(t){var r=e.Objects.NodeAttribute[t.ID];void 0!==r&&(i=r)}),void 0===i)r=new THREE.Object3D;else{var n=0;void 0!==i.CameraProjectionType&&1===i.CameraProjectionType.value&&(n=1);var o=1;void 0!==i.NearPlane&&(o=i.NearPlane.value/1e3);var a=1e3;void 0!==i.FarPlane&&(a=i.FarPlane.value/1e3);var s=window.innerWidth,l=window.innerHeight;void 0!==i.AspectWidth&&void 0!==i.AspectHeight&&(s=i.AspectWidth.value,l=i.AspectHeight.value);var c=s/l,u=45;void 0!==i.FieldOfView&&(u=i.FieldOfView.value);var d=i.FocalLength?i.FocalLength.value:null;switch(n){case 0:r=new THREE.PerspectiveCamera(u,c,o,a),null!==d&&r.setFocalLength(d);break;case 1:r=new THREE.OrthographicCamera(-s/2,s/2,l/2,-l/2,o,a);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+n+"."),r=new THREE.Object3D}}return r},createLight:function(t){var r,i;if(t.children.forEach(function(t){var r=e.Objects.NodeAttribute[t.ID];void 0!==r&&(i=r)}),void 0===i)r=new THREE.Object3D;else{var n;n=void 0===i.LightType?0:i.LightType.value;var o=16777215;void 0!==i.Color&&(o=(new THREE.Color).fromArray(i.Color.value));var a=void 0===i.Intensity?1:i.Intensity.value/100;void 0!==i.CastLightOnObject&&0===i.CastLightOnObject.value&&(a=0);var s=0;void 0!==i.FarAttenuationEnd&&(s=void 0!==i.EnableFarAttenuation&&0===i.EnableFarAttenuation.value?0:i.FarAttenuationEnd.value);switch(n){case 0:r=new THREE.PointLight(o,a,s,1);break;case 1:r=new THREE.DirectionalLight(o,a);break;case 2:var l=Math.PI/3;void 0!==i.InnerAngle&&(l=THREE.Math.degToRad(i.InnerAngle.value));var c=0;void 0!==i.OuterAngle&&(c=THREE.Math.degToRad(i.OuterAngle.value),c=Math.max(c,1)),r=new THREE.SpotLight(o,a,s,l,c,1);break;default:console.warn("THREE.FBXLoader: Unknown light type "+i.LightType.value+", defaulting to a THREE.PointLight."),r=new THREE.PointLight(o,a)}void 0!==i.CastShadows&&1===i.CastShadows.value&&(r.castShadow=!0)}return r},createMesh:function(e,t,r){var i,n=null,o=null,a=[];return e.children.forEach(function(e){t.has(e.ID)&&(n=t.get(e.ID)),r.has(e.ID)&&a.push(r.get(e.ID))}),a.length>1?o=a:a.length>0?o=a[0]:(o=new THREE.MeshPhongMaterial({color:13421772}),a.push(o)),"color"in n.attributes&&a.forEach(function(e){e.vertexColors=THREE.VertexColors}),n.FBX_Deformer?(a.forEach(function(e){e.skinning=!0}),i=new THREE.SkinnedMesh(n,o)):i=new THREE.Mesh(n,o),i},createCurve:function(e,t){var r=e.children.reduce(function(e,r){return t.has(r.ID)&&(e=t.get(r.ID)),e},null),i=new THREE.LineBasicMaterial({color:3342591,linewidth:1});return new THREE.Line(r,i)},getTransformData:function(e,t){var r={};"InheritType"in t&&(r.inheritType=parseInt(t.InheritType.value)),r.eulerOrder="RotationOrder"in t?y(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(r.translation=t.Lcl_Translation.value),"PreRotation"in t&&(r.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(r.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(r.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(r.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(r.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(r.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(r.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(r.rotationPivot=t.RotationPivot.value),e.userData.transformData=r},setLookAtProperties:function(i,n){"LookAtProperty"in n&&t.get(i.ID).children.forEach(function(t){if("LookAtProperty"===t.relationship){var n=e.Objects.Model[t.ID];if("Lcl_Translation"in n){var o=n.Lcl_Translation.value;void 0!==i.target?(i.target.position.fromArray(o),r.add(i.target)):i.lookAt((new THREE.Vector3).fromArray(o))}}})},bindSkeleton:function(e,r,i){var n=this.parsePoseNodes();for(var o in e){var a=e[o];t.get(parseInt(a.ID)).parents.forEach(function(e){if(r.has(e.ID)){var o=e.ID;t.get(o).parents.forEach(function(e){i.has(e.ID)&&i.get(e.ID).bind(new THREE.Skeleton(a.bones),n[e.ID])})}})}},parsePoseNodes:function(){var t={};if("Pose"in e.Objects){var r=e.Objects.Pose;for(var i in r)if("BindPose"===r[i].attrType){var n=r[i].PoseNode;Array.isArray(n)?n.forEach(function(e){t[e.Node]=(new THREE.Matrix4).fromArray(e.Matrix.a)}):t[n.Node]=(new THREE.Matrix4).fromArray(n.Matrix.a)}}return t},createAmbientLight:function(){if("GlobalSettings"in e&&"AmbientColor"in e.GlobalSettings){var t=e.GlobalSettings.AmbientColor.value,r=t[0],i=t[1],n=t[2];if(0!==r||0!==i||0!==n)new THREE.Color(r,i,n)}},setupMorphMaterials:function(){var e=this;r.traverse(function(t){t.isMesh&&t.geometry.morphAttributes.position&&t.geometry.morphAttributes.position.length&&(Array.isArray(t.material)?t.material.forEach(function(r,i){e.setupMorphMaterial(t,r,i)}):e.setupMorphMaterial(t,t.material))})},setupMorphMaterial:function(e,t,i){var n=e.uuid,o=t.uuid,a=!1;if(r.traverse(function(e){e.isMesh&&(Array.isArray(e.material)?e.material.forEach(function(t){t.uuid===o&&e.uuid!==n&&(a=!0)}):e.material.uuid===o&&e.uuid!==n&&(a=!0))}),!0===a){var s=t.clone();s.morphTargets=!0,void 0===i?e.material=s:e.material[i]=s}else t.morphTargets=!0}},o.prototype={constructor:o,parse:function(r){var i=new Map;if("Geometry"in e.Objects){var n=e.Objects.Geometry;for(var o in n){var a=t.get(parseInt(o)),s=this.parseGeometry(a,n[o],r);i.set(parseInt(o),s)}}return i},parseGeometry:function(e,t,r){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,r);case"NurbsCurve":return this.parseNurbsGeometry(t)}},parseMeshGeometry:function(t,r,i){var n=i.skeletons,o=i.morphTargets,a=t.parents.map(function(t){return e.Objects.Model[t.ID]});if(0!==a.length){var s=t.children.reduce(function(e,t){return void 0!==n[t.ID]&&(e=n[t.ID]),e},null),l=t.children.reduce(function(e,t){return void 0!==o[t.ID]&&(e=o[t.ID]),e},null),c=a[0],u={};"RotationOrder"in c&&(u.eulerOrder=y(c.RotationOrder.value)),"InheritType"in c&&(u.inheritType=parseInt(c.InheritType.value)),"GeometricTranslation"in c&&(u.translation=c.GeometricTranslation.value),"GeometricRotation"in c&&(u.rotation=c.GeometricRotation.value),"GeometricScaling"in c&&(u.scale=c.GeometricScaling.value);var d=g(u);return this.genGeometry(r,s,l,d)}},genGeometry:function(e,t,r,i){var n=new THREE.BufferGeometry;e.attrName&&(n.name=e.attrName);var o=this.parseGeoNode(e,t),a=this.genBuffers(o),s=new THREE.Float32BufferAttribute(a.vertex,3);if(i.applyToBufferAttribute(s),n.addAttribute("position",s),a.colors.length>0&&n.addAttribute("color",new THREE.Float32BufferAttribute(a.colors,3)),t&&(n.addAttribute("skinIndex",new THREE.Uint16BufferAttribute(a.weightsIndices,4)),n.addAttribute("skinWeight",new THREE.Float32BufferAttribute(a.vertexWeights,4)),n.FBX_Deformer=t),a.normal.length>0){var l=new THREE.Float32BufferAttribute(a.normal,3);(new THREE.Matrix3).getNormalMatrix(i).applyToBufferAttribute(l),n.addAttribute("normal",l)}if(a.uvs.forEach(function(e,t){var r="uv"+(t+1).toString();0===t&&(r="uv"),n.addAttribute(r,new THREE.Float32BufferAttribute(a.uvs[t],2))}),o.material&&"AllSame"!==o.material.mappingType){var c=a.materialIndex[0],u=0;if(a.materialIndex.forEach(function(e,t){e!==c&&(n.addGroup(u,t-u,c),c=e,u=t)}),n.groups.length>0){var d=n.groups[n.groups.length-1],h=d.start+d.count;h!==a.materialIndex.length&&n.addGroup(h,a.materialIndex.length-h,c)}0===n.groups.length&&n.addGroup(0,a.materialIndex.length,a.materialIndex[0])}return this.addMorphTargets(n,e,r,i),n},parseGeoNode:function(e,t){var r={};if(r.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],r.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(r.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(r.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(r.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){r.uv=[];for(var i=0;e.LayerElementUV[i];)r.uv.push(this.parseUVs(e.LayerElementUV[i])),i++}return r.weightTable={},null!==t&&(r.skeleton=t,t.rawBones.forEach(function(e,t){e.indices.forEach(function(i,n){void 0===r.weightTable[i]&&(r.weightTable[i]=[]),r.weightTable[i].push({id:t,weight:e.weights[n]})})})),r},genBuffers:function(e){var t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},r=0,i=0,n=!1,o=[],a=[],s=[],l=[],c=[],u=[],d=this;return e.vertexIndices.forEach(function(h,f){var m=!1;h<0&&(h^=-1,m=!0);var v=[],g=[];if(o.push(3*h,3*h+1,3*h+2),e.color){var y=p(f,r,h,e.color);s.push(y[0],y[1],y[2])}if(e.skeleton){if(void 0!==e.weightTable[h]&&e.weightTable[h].forEach(function(e){g.push(e.weight),v.push(e.id)}),g.length>4){n||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),n=!0);var b=[0,0,0,0],E=[0,0,0,0];g.forEach(function(e,t){var r=e,i=v[t];E.forEach(function(e,t,n){if(r>e){n[t]=r,r=e;var o=b[t];b[t]=i,i=o}})}),v=b,g=E}for(;g.length<4;)g.push(0),v.push(0);for(var A=0;A<4;++A)c.push(g[A]),u.push(v[A])}if(e.normal){y=p(f,r,h,e.normal);a.push(y[0],y[1],y[2])}if(e.material&&"AllSame"!==e.material.mappingType)var _=p(f,r,h,e.material)[0];e.uv&&e.uv.forEach(function(e,t){var i=p(f,r,h,e);void 0===l[t]&&(l[t]=[]),l[t].push(i[0]),l[t].push(i[1])}),i++,m&&(d.genFace(t,e,o,_,a,s,l,c,u,i),r++,i=0,o=[],a=[],s=[],l=[],c=[],u=[])}),t},genFace:function(e,t,r,i,n,o,a,s,l,c){for(var u=2;u<c;u++)e.vertex.push(t.vertexPositions[r[0]]),e.vertex.push(t.vertexPositions[r[1]]),e.vertex.push(t.vertexPositions[r[2]]),e.vertex.push(t.vertexPositions[r[3*(u-1)]]),e.vertex.push(t.vertexPositions[r[3*(u-1)+1]]),e.vertex.push(t.vertexPositions[r[3*(u-1)+2]]),e.vertex.push(t.vertexPositions[r[3*u]]),e.vertex.push(t.vertexPositions[r[3*u+1]]),e.vertex.push(t.vertexPositions[r[3*u+2]]),t.skeleton&&(e.vertexWeights.push(s[0]),e.vertexWeights.push(s[1]),e.vertexWeights.push(s[2]),e.vertexWeights.push(s[3]),e.vertexWeights.push(s[4*(u-1)]),e.vertexWeights.push(s[4*(u-1)+1]),e.vertexWeights.push(s[4*(u-1)+2]),e.vertexWeights.push(s[4*(u-1)+3]),e.vertexWeights.push(s[4*u]),e.vertexWeights.push(s[4*u+1]),e.vertexWeights.push(s[4*u+2]),e.vertexWeights.push(s[4*u+3]),e.weightsIndices.push(l[0]),e.weightsIndices.push(l[1]),e.weightsIndices.push(l[2]),e.weightsIndices.push(l[3]),e.weightsIndices.push(l[4*(u-1)]),e.weightsIndices.push(l[4*(u-1)+1]),e.weightsIndices.push(l[4*(u-1)+2]),e.weightsIndices.push(l[4*(u-1)+3]),e.weightsIndices.push(l[4*u]),e.weightsIndices.push(l[4*u+1]),e.weightsIndices.push(l[4*u+2]),e.weightsIndices.push(l[4*u+3])),t.color&&(e.colors.push(o[0]),e.colors.push(o[1]),e.colors.push(o[2]),e.colors.push(o[3*(u-1)]),e.colors.push(o[3*(u-1)+1]),e.colors.push(o[3*(u-1)+2]),e.colors.push(o[3*u]),e.colors.push(o[3*u+1]),e.colors.push(o[3*u+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(i),e.materialIndex.push(i),e.materialIndex.push(i)),t.normal&&(e.normal.push(n[0]),e.normal.push(n[1]),e.normal.push(n[2]),e.normal.push(n[3*(u-1)]),e.normal.push(n[3*(u-1)+1]),e.normal.push(n[3*(u-1)+2]),e.normal.push(n[3*u]),e.normal.push(n[3*u+1]),e.normal.push(n[3*u+2])),t.uv&&t.uv.forEach(function(t,r){void 0===e.uvs[r]&&(e.uvs[r]=[]),e.uvs[r].push(a[r][0]),e.uvs[r].push(a[r][1]),e.uvs[r].push(a[r][2*(u-1)]),e.uvs[r].push(a[r][2*(u-1)+1]),e.uvs[r].push(a[r][2*u]),e.uvs[r].push(a[r][2*u+1])})},addMorphTargets:function(t,r,i,n){if(null!==i){t.morphAttributes.position=[];var o=this;i.rawTargets.forEach(function(i){var a=e.Objects.Geometry[i.geoID];void 0!==a&&o.genMorphGeometry(t,r,a,n,i.name)})}},genMorphGeometry:function(e,t,r,i,n){var o=new THREE.BufferGeometry;r.attrName&&(o.name=r.attrName);for(var a=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],s=void 0!==t.Vertices?t.Vertices.a.slice():[],l=void 0!==r.Vertices?r.Vertices.a:[],c=void 0!==r.Indexes?r.Indexes.a:[],u=0;u<c.length;u++){var d=3*c[u];s[d]+=l[3*u],s[d+1]+=l[3*u+1],s[d+2]+=l[3*u+2]}var h={vertexIndices:a,vertexPositions:s},f=this.genBuffers(h),p=new THREE.Float32BufferAttribute(f.vertex,3);p.name=n||r.attrName,i.applyToBufferAttribute(p),e.morphAttributes.position.push(p)},parseNormals:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,i=e.Normals.a,n=[];return"IndexToDirect"===r&&("NormalIndex"in e?n=e.NormalIndex.a:"NormalsIndex"in e&&(n=e.NormalsIndex.a)),{dataSize:3,buffer:i,indices:n,mappingType:t,referenceType:r}},parseUVs:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,i=e.UV.a,n=[];return"IndexToDirect"===r&&(n=e.UVIndex.a),{dataSize:2,buffer:i,indices:n,mappingType:t,referenceType:r}},parseVertexColors:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,i=e.Colors.a,n=[];return"IndexToDirect"===r&&(n=e.ColorIndex.a),{dataSize:4,buffer:i,indices:n,mappingType:t,referenceType:r}},parseMaterialIndices:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:r};for(var i=e.Materials.a,n=[],o=0;o<i.length;++o)n.push(o);return{dataSize:1,buffer:i,indices:n,mappingType:t,referenceType:r}},parseNurbsGeometry:function(e){if(void 0===THREE.NURBSCurve)return console.error("THREE.FBXLoader: The loader relies on THREE.NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new THREE.BufferGeometry;var t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new THREE.BufferGeometry;for(var r,i,n=t-1,o=e.KnotVector.a,a=[],s=e.Points.a,l=0,c=s.length;l<c;l+=4)a.push((new THREE.Vector4).fromArray(s,l));if("Closed"===e.Form)a.push(a[0]);else if("Periodic"===e.Form){r=n,i=o.length-1-r;for(l=0;l<n;++l)a.push(a[l])}var u=new THREE.NURBSCurve(n,o,a,r,i).getPoints(7*a.length),d=new Float32Array(3*u.length);u.forEach(function(e,t){e.toArray(d,3*t)});var h=new THREE.BufferGeometry;return h.addAttribute("position",new THREE.BufferAttribute(d,3)),h}},a.prototype={constructor:a,parse:function(){var e=[],t=this.parseClips();if(void 0!==t){for(var r in t){var i=t[r],n=this.addClip(i);e.push(n)}return e}},parseClips:function(){if(void 0!==e.Objects.AnimationCurve){var t=this.parseAnimationCurveNodes();this.parseAnimationCurves(t);var r=this.parseAnimationLayers(t);return this.parseAnimStacks(r)}},parseAnimationCurveNodes:function(){var t=e.Objects.AnimationCurveNode,r=new Map;for(var i in t){var n=t[i];if(null!==n.attrName.match(/S|R|T|DeformPercent/)){var o={id:n.id,attr:n.attrName,curves:{}};r.set(o.id,o)}}return r},parseAnimationCurves:function(r){var i=e.Objects.AnimationCurve;for(var n in i){var o={id:i[n].id,times:i[n].KeyTime.a.map(h),values:i[n].KeyValueFloat.a},a=t.get(o.id);if(void 0!==a){var s=a.parents[0].ID,l=a.parents[0].relationship;l.match(/X/)?r.get(s).curves.x=o:l.match(/Y/)?r.get(s).curves.y=o:l.match(/Z/)?r.get(s).curves.z=o:l.match(/d|DeformPercent/)&&r.has(s)&&(r.get(s).curves.morph=o)}}},parseAnimationLayers:function(i){var n=e.Objects.AnimationLayer,o=new Map;for(var a in n){var s=[],l=t.get(parseInt(a));if(void 0!==l)l.children.forEach(function(n,o){if(i.has(n.ID)){var a=i.get(n.ID);if(void 0!==a.curves.x||void 0!==a.curves.y||void 0!==a.curves.z){if(void 0===s[o]){t.get(n.ID).parents.forEach(function(e){void 0!==e.relationship&&(f=e.ID)});var l=e.Objects.Model[f.toString()],c={modelName:THREE.PropertyBinding.sanitizeNodeName(l.attrName),ID:l.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};r.traverse(function(e){(e.ID=l.id)&&(c.transform=e.matrix,e.userData.transformData&&(c.eulerOrder=e.userData.transformData.eulerOrder))}),c.transform||(c.transform=new THREE.Matrix4),"PreRotation"in l&&(c.preRotation=l.PreRotation.value),"PostRotation"in l&&(c.postRotation=l.PostRotation.value),s[o]=c}s[o][a.attr]=a}else if(void 0!==a.curves.morph){if(void 0===s[o]){var u;t.get(n.ID).parents.forEach(function(e){void 0!==e.relationship&&(u=e.ID)});var d=t.get(u).parents[0].ID,h=t.get(d).parents[0].ID,f=t.get(h).parents[0].ID;l=e.Objects.Model[f],c={modelName:THREE.PropertyBinding.sanitizeNodeName(l.attrName),morphName:e.Objects.Deformer[u].attrName};s[o]=c}s[o][a.attr]=a}}}),o.set(parseInt(a),s)}return o},parseAnimStacks:function(r){var i=e.Objects.AnimationStack,n={};for(var o in i){var a=t.get(parseInt(o)).children;a.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var s=r.get(a[0].ID);n[o]={name:i[o].attrName,layer:s}}return n},addClip:function(e){var t=[],r=this;return e.layer.forEach(function(e){t=t.concat(r.generateTracks(e))}),new THREE.AnimationClip(e.name,-1,t)},generateTracks:function(e){var t=[],r=new THREE.Vector3,i=new THREE.Quaternion,n=new THREE.Vector3;if(e.transform&&e.transform.decompose(r,i,n),r=r.toArray(),i=(new THREE.Euler).setFromQuaternion(i,e.eulerOrder).toArray(),n=n.toArray(),void 0!==e.T&&Object.keys(e.T.curves).length>0){var o=this.generateVectorTrack(e.modelName,e.T.curves,r,"position");void 0!==o&&t.push(o)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){var a=this.generateRotationTrack(e.modelName,e.R.curves,i,e.preRotation,e.postRotation,e.eulerOrder);void 0!==a&&t.push(a)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){var s=this.generateVectorTrack(e.modelName,e.S.curves,n,"scale");void 0!==s&&t.push(s)}if(void 0!==e.DeformPercent){var l=this.generateMorphTrack(e);void 0!==l&&t.push(l)}return t},generateVectorTrack:function(e,t,r,i){var n=this.getTimesForAllAxes(t),o=this.getKeyframeTrackValues(n,t,r);return new THREE.VectorKeyframeTrack(e+"."+i,n,o)},generateRotationTrack:function(e,t,r,i,n,o){void 0!==t.x&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(THREE.Math.degToRad)),void 0!==t.y&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(THREE.Math.degToRad)),void 0!==t.z&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(THREE.Math.degToRad));var a=this.getTimesForAllAxes(t),s=this.getKeyframeTrackValues(a,t,r);void 0!==i&&((i=i.map(THREE.Math.degToRad)).push(o),i=(new THREE.Euler).fromArray(i),i=(new THREE.Quaternion).setFromEuler(i)),void 0!==n&&((n=n.map(THREE.Math.degToRad)).push(o),n=(new THREE.Euler).fromArray(n),n=(new THREE.Quaternion).setFromEuler(n).inverse());for(var l=new THREE.Quaternion,c=new THREE.Euler,u=[],d=0;d<s.length;d+=3)c.set(s[d],s[d+1],s[d+2],o),l.setFromEuler(c),void 0!==i&&l.premultiply(i),void 0!==n&&l.multiply(n),l.toArray(u,d/3*4);return new THREE.QuaternionKeyframeTrack(e+".quaternion",a,u)},generateMorphTrack:function(e){var t=e.DeformPercent.curves.morph,i=t.values.map(function(e){return e/100}),n=r.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new THREE.NumberKeyframeTrack(e.modelName+".morphTargetInfluences["+n+"]",t.times,i)},getTimesForAllAxes:function(e){var t=[];return void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort(function(e,t){return e-t}).filter(function(e,t,r){return r.indexOf(e)==t})},getKeyframeTrackValues:function(e,t,r){var i=r,n=[],o=-1,a=-1,s=-1;return e.forEach(function(e){if(t.x&&(o=t.x.times.indexOf(e)),t.y&&(a=t.y.times.indexOf(e)),t.z&&(s=t.z.times.indexOf(e)),-1!==o){var r=t.x.values[o];n.push(r),i[0]=r}else n.push(i[0]);if(-1!==a){var l=t.y.values[a];n.push(l),i[1]=l}else n.push(i[1]);if(-1!==s){var c=t.z.values[s];n.push(c),i[2]=c}else n.push(i[2])}),n},interpolateRotations:function(e){for(var t=1;t<e.values.length;t++){var r=e.values[t-1],i=e.values[t]-r,n=Math.abs(i);if(n>=180){for(var o=n/180,a=i/o,s=r+a,l=e.times[t-1],c=(e.times[t]-l)/o,u=l+c,d=[],h=[];u<e.times[t];)d.push(u),u+=c,h.push(s),s+=a;e.times=A(e.times,t,d),e.values=A(e.values,t,h)}}}},s.prototype={constructor:s,getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(e){this.nodeStack.push(e),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(e,t){this.currentProp=e,this.currentPropName=t},parse:function(e){this.currentIndent=0,this.allNodes=new u,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var t=this,r=e.split(/[\r\n]+/);return r.forEach(function(e,i){var n=e.match(/^[\s\t]*;/),o=e.match(/^[\s\t]*$/);if(!n&&!o){var a=e.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),s=e.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),l=e.match("^\\t{"+(t.currentIndent-1)+"}}");a?t.parseNodeBegin(e,a):s?t.parseNodeProperty(e,s,r[++i]):l?t.popStack():e.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(e)}}),this.allNodes},parseNodeBegin:function(e,t){var r=t[1].trim().replace(/^"/,"").replace(/"$/,""),i=t[2].split(",").map(function(e){return e.trim().replace(/^"/,"").replace(/"$/,"")}),n={name:r},o=this.parseNodeAttr(i),a=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(r,n):r in a?("PoseNode"===r?a.PoseNode.push(n):void 0!==a[r].id&&(a[r]={},a[r][a[r].id]=a[r]),""!==o.id&&(a[r][o.id]=n)):"number"==typeof o.id?(a[r]={},a[r][o.id]=n):"Properties70"!==r&&(a[r]="PoseNode"===r?[n]:n),"number"==typeof o.id&&(n.id=o.id),""!==o.name&&(n.attrName=o.name),""!==o.type&&(n.attrType=o.type),this.pushStack(n)},parseNodeAttr:function(e){var t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));var r="",i="";return e.length>1&&(r=e[1].replace(/^(\w+)::/,""),i=e[2]),{id:t,name:r,type:i}},parseNodeProperty:function(e,t,r){var i=t[1].replace(/^"/,"").replace(/"$/,"").trim(),n=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===i&&","===n&&(n=r.replace(/"/g,"").replace(/,$/,"").trim());var o=this.getCurrentNode();if("Properties70"!==o.name){if("C"===i){var a=n.split(",").slice(1),s=parseInt(a[0]),l=parseInt(a[1]),c=n.split(",").slice(3);i="connections",function(e,t){for(var r=0,i=e.length,n=t.length;r<n;r++,i++)e[i]=t[r]}(n=[s,l],c=c.map(function(e){return e.trim().replace(/^"/,"")})),void 0===o[i]&&(o[i]=[])}"Node"===i&&(o.id=n),i in o&&Array.isArray(o[i])?o[i].push(n):"a"!==i?o[i]=n:o.a=n,this.setCurrentProp(o,i),"a"===i&&","!==n.slice(-1)&&(o.a=b(n))}else this.parseNodeSpecialProperty(e,i,n)},parseNodePropertyContinued:function(e){var t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=b(t.a))},parseNodeSpecialProperty:function(e,t,r){var i=r.split('",').map(function(e){return e.trim().replace(/^\"/,"").replace(/\s/,"_")}),n=i[0],o=i[1],a=i[2],s=i[3],l=i[4];switch(o){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":l=parseFloat(l);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":l=b(l)}this.getPrevNode()[n]={type:o,type2:a,flag:s,value:l},this.setCurrentProp(this.getPrevNode(),n)}},l.prototype={constructor:l,parse:function(e){var t=new c(e);t.skip(23);for(var r=t.getUint32(),i=new u;!this.endOfContent(t);){var n=this.parseNode(t,r);null!==n&&i.add(n.name,n)}return i},endOfContent:function(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()},parseNode:function(e,t){var r={},i=t>=7500?e.getUint64():e.getUint32(),n=t>=7500?e.getUint64():e.getUint32(),o=(t>=7500?e.getUint64():e.getUint32(),e.getUint8()),a=e.getString(o);if(0===i)return null;for(var s=[],l=0;l<n;l++)s.push(this.parseProperty(e));var c=s.length>0?s[0]:"",u=s.length>1?s[1]:"",d=s.length>2?s[2]:"";for(r.singleProperty=1===n&&e.getOffset()===i;i>e.getOffset();){var h=this.parseNode(e,t);null!==h&&this.parseSubNode(a,r,h)}return r.propertyList=s,"number"==typeof c&&(r.id=c),""!==u&&(r.attrName=u),""!==d&&(r.attrType=d),""!==a&&(r.name=a),r},parseSubNode:function(e,t,r){if(!0===r.singleProperty){var i=r.propertyList[0];Array.isArray(i)?(t[r.name]=r,r.a=i):t[r.name]=i}else if("Connections"===e&&"C"===r.name){var n=[];r.propertyList.forEach(function(e,t){0!==t&&n.push(e)}),void 0===t.connections&&(t.connections=[]),t.connections.push(n)}else if("Properties70"===r.name){Object.keys(r).forEach(function(e){t[e]=r[e]})}else if("Properties70"===e&&"P"===r.name){var o,a=r.propertyList[0],s=r.propertyList[1],l=r.propertyList[2],c=r.propertyList[3];0===a.indexOf("Lcl ")&&(a=a.replace("Lcl ","Lcl_")),0===s.indexOf("Lcl ")&&(s=s.replace("Lcl ","Lcl_")),o="Color"===s||"ColorRGB"===s||"Vector"===s||"Vector3D"===s||0===s.indexOf("Lcl_")?[r.propertyList[4],r.propertyList[5],r.propertyList[6]]:r.propertyList[4],t[a]={type:s,type2:l,flag:c,value:o}}else void 0===t[r.name]?"number"==typeof r.id?(t[r.name]={},t[r.name][r.id]=r):t[r.name]=r:"PoseNode"===r.name?(Array.isArray(t[r.name])||(t[r.name]=[t[r.name]]),t[r.name].push(r)):void 0===t[r.name][r.id]&&(t[r.name][r.id]=r)},parseProperty:function(e){var t=e.getString(1);switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":var r=e.getUint32();return e.getArrayBuffer(r);case"S":r=e.getUint32();return e.getString(r);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var i=e.getUint32(),n=e.getUint32(),o=e.getUint32();if(0===n)switch(t){case"b":case"c":return e.getBooleanArray(i);case"d":return e.getFloat64Array(i);case"f":return e.getFloat32Array(i);case"i":return e.getInt32Array(i);case"l":return e.getInt64Array(i)}"undefined"==typeof Zlib&&console.error("THREE.FBXLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js");var a=new c(new Zlib.Inflate(new Uint8Array(e.getArrayBuffer(o))).decompress().buffer);switch(t){case"b":case"c":return a.getBooleanArray(i);case"d":return a.getFloat64Array(i);case"f":return a.getFloat32Array(i);case"i":return a.getInt32Array(i);case"l":return a.getInt64Array(i)}default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}},c.prototype={constructor:c,getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(e){this.offset+=e},getBoolean:function(){return 1==(1&this.getUint8())},getBooleanArray:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getBoolean());return t},getUint8:function(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e},getInt16:function(){var e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e},getInt32:function(){var e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e},getInt32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt32());return t},getUint32:function(){var e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e},getInt64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,4294967295===(e=4294967295&~e)&&(t=t+1&4294967295),-(4294967296*t+(e=e+1&4294967295))):4294967296*t+e},getInt64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt64());return t},getUint64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e},getFloat32:function(){var e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e},getFloat32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat32());return t},getFloat64:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},getFloat64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat64());return t},getArrayBuffer:function(e){var t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t},getString:function(e){for(var t=[],r=0;r<e;r++)t[r]=this.getUint8();var i=t.indexOf(0);return i>=0&&(t=t.slice(0,i)),THREE.LoaderUtils.decodeText(new Uint8Array(t))}},u.prototype={constructor:u,add:function(e,t){this[e]=t}};var f=[];function p(e,t,r,i){var n;switch(i.mappingType){case"ByPolygonVertex":n=e;break;case"ByPolygon":n=t;break;case"ByVertice":n=r;break;case"AllSame":n=i.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+i.mappingType)}"IndexToDirect"===i.referenceType&&(n=i.indices[n]);var o=n*i.dataSize,a=o+i.dataSize;return function(e,t,r,i){for(var n=r,o=0;n<i;n++,o++)e[o]=t[n];return e}(f,i.buffer,o,a)}var m=new THREE.Euler,v=new THREE.Vector3;function g(e){var t,r=new THREE.Matrix4,i=new THREE.Matrix4,n=new THREE.Matrix4,o=new THREE.Matrix4,a=new THREE.Matrix4,s=new THREE.Matrix4,l=new THREE.Matrix4,c=new THREE.Matrix4,u=new THREE.Matrix4,d=new THREE.Matrix4,h=new THREE.Matrix4,f=new THREE.Matrix4,p=new THREE.Matrix4,g=e.inheritType?e.inheritType:0;(e.translation&&r.setPosition(v.fromArray(e.translation)),e.preRotation)&&((t=e.preRotation.map(THREE.Math.degToRad)).push(e.eulerOrder),i.makeRotationFromEuler(m.fromArray(t)));e.rotation&&((t=e.rotation.map(THREE.Math.degToRad)).push(e.eulerOrder),n.makeRotationFromEuler(m.fromArray(t)));e.postRotation&&((t=e.postRotation.map(THREE.Math.degToRad)).push(e.eulerOrder),o.makeRotationFromEuler(m.fromArray(t)));e.scale&&s.scale(v.fromArray(e.scale)),e.scalingOffset&&c.setPosition(v.fromArray(e.scalingOffset)),e.scalingPivot&&l.setPosition(v.fromArray(e.scalingPivot)),e.rotationOffset&&u.setPosition(v.fromArray(e.rotationOffset)),e.rotationPivot&&d.setPosition(v.fromArray(e.rotationPivot)),e.parentMatrixWorld&&(h=e.parentMatrixWorld);var y=i.multiply(n).multiply(o),b=new THREE.Matrix4;h.extractRotation(b);var E=new THREE.Matrix4,A=new THREE.Matrix4,_=new THREE.Matrix4,w=new THREE.Matrix4;if(w.copyPosition(h),_=w.getInverse(w).multiply(h),A=b.getInverse(b).multiply(_),E=s,0===g)p=b.multiply(y).multiply(A).multiply(E);else if(1===g)p=b.multiply(A).multiply(y).multiply(E);else{var T=(new THREE.Matrix4).copy(s),R=A.multiply(T.getInverse(T));p=b.multiply(y).multiply(R).multiply(E)}a=r.multiply(u).multiply(d).multiply(i).multiply(n).multiply(o).multiply(d.getInverse(d)).multiply(c).multiply(l).multiply(s).multiply(l.getInverse(l));var k=(new THREE.Matrix4).copyPosition(a),M=h.multiply(k);return f.copyPosition(M),a=f.multiply(p)}function y(e){var t=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(e=e||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),t[0]):t[e]}function b(e){return e.split(",").map(function(e){return parseFloat(e)})}function E(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=e.byteLength),THREE.LoaderUtils.decodeText(new Uint8Array(e,t,r))}function A(e,t,r){return e.slice(0,t).concat(r).concat(e.slice(t))}return i}()},{}],5:[function(e,t,r){"use strict";t.exports=Object.assign(function(){},{FACE_1:0,FACE_2:1,FACE_3:2,FACE_4:3,L_SHOULDER_1:4,R_SHOULDER_1:5,L_SHOULDER_2:6,R_SHOULDER_2:7,SELECT:8,START:9,DPAD_UP:12,DPAD_DOWN:13,DPAD_LEFT:14,DPAD_RIGHT:15,VENDOR:16})},{}],6:[function(e,t,r){"use strict";t.exports=function(e,t,r){this.type=e,this.index=t,this.pressed=r.pressed,this.value=r.value}},{}],7:[function(e,t,r){"use strict";t.exports={size:5,cellSize:10,extrudeSettings:{amount:1,bevelEnabled:!0,bevelSegments:1,steps:1,bevelSize:.5,bevelThickness:.5},autogenerated:!0,cells:[{q:-1,r:0,s:1,h:1,walkable:!0,userData:{}},{q:0,r:-1,s:1,h:1,walkable:!0,userData:{}},{q:0,r:0,s:0,h:1,walkable:!0,userData:{}},{q:1,r:-1,s:0,h:1,walkable:!0,userData:{}},{q:-1,r:1,s:0,h:0,walkable:!0,userData:{}},{q:0,r:1,s:-1,h:0,walkable:!0,userData:{}},{q:1,r:0,s:-1,h:0,walkable:!0,userData:{}}]}},{}],8:[function(e,t,r){"use strict";function i(e){var t=document.getElementById(e),r=t.parentNode;try{r&&r.removeChild(t)}catch(e){}}function n(e,t,r){return new r(function(r,n){var o=t.timeout||5e3,a="script_"+Date.now()+"_"+Math.ceil(1e5*Math.random()),s=function(e,t){var r=document.createElement("script");return r.type="text/javascript",r.async=!0,r.id=t,r.src=e,r}(e,a),l=setTimeout(function(){n(new Error("Script request to "+e+" timed out")),i(a)},o),c=function(e){clearTimeout(e)};s.addEventListener("load",function(e){r({ok:!0}),c(l),i(a)}),s.addEventListener("error",function(t){n(new Error("Script request to "+e+" failed "+t)),c(l),i(a)}),function(e){var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}(s)})}t.exports=function(e){return e=e||{},function(t,r){return n(t,r=r||{},e.Promise||Promise)}}},{}],9:[function(e,t,r){"use strict";var i,n,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a="function"==typeof Symbol&&"symbol"===o(Symbol.iterator)?function(e){return void 0===e?"undefined":o(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":o(e)},s=t.exports={VERSION:"0.1.1",PI:Math.PI,TAU:2*Math.PI,DEG_TO_RAD:.0174532925,RAD_TO_DEG:57.2957795,SQRT3:Math.sqrt(3),TILE:"tile",ENT:"entity",STR:"structure",HEX:"hex",SQR:"square",ABS:"abstract"};s.Board=function(e,t){if(!e)throw new Error("You must pass in a grid system for the board to use.");this.tiles=[],this.tileGroup=null,this.group=new THREE.Object3D,this.grid=null,this.overlay=null,this.finder=new s.AStarFinder(t),s.Loader.init(),this.setGrid(e)},s.Board.prototype={setEntityOnTile:function(e,t){var r=this.grid.cellToPixel(t.cell);e.position.copy(r),e.position.y+=e.heightOffset||0,e.tile&&(e.tile.entity=null),e.tile=t,t.entity=e},addTile:function(e){-1===this.tiles.indexOf(e)&&(this.tiles.push(e),this.snapTileToGrid(e),e.position.y=0,this.tileGroup.add(e.mesh),this.grid.add(e.cell),e.cell.tile=e)},removeTile:function(e){if(e){var t=this.tiles.indexOf(e);this.grid.remove(e.cell),-1!==t&&this.tiles.splice(t,1),e.dispose()}},removeAllTiles:function(){if(this.tileGroup)for(var e=this.tileGroup.children,t=0;t<e.length;t++)this.tileGroup.remove(e[t])},getTileAtCell:function(e){var t=this.grid.cellToHash(e);return e.tile||(void 0!==this.grid.cells[t]?this.grid.cells[t].tile:null)},snapToGrid:function(e){var t=this.grid.pixelToCell(e);e.copy(this.grid.cellToPixel(t))},snapTileToGrid:function(e){if(e.cell)e.position.copy(this.grid.cellToPixel(e.cell));else{var t=this.grid.pixelToCell(e.position);e.position.copy(this.grid.cellToPixel(t))}return e},getRandomTile:function(){var e=s.Tools.randomInt(0,this.tiles.length-1);return this.tiles[e]},findPath:function(e,t,r){return this.finder.findPath(e.cell,t.cell,r,this.grid)},setGrid:function(e){this.group.remove(this.tileGroup),this.grid&&e!==this.grid&&(this.removeAllTiles(),this.tiles.forEach(function(e){this.grid.remove(e.cell),e.dispose()}),this.grid.dispose()),this.grid=e,this.tiles=[],this.tileGroup=new THREE.Object3D,this.group.add(this.tileGroup)},generateOverlay:function(e){var t=new THREE.LineBasicMaterial({color:0,opacity:.3});this.overlay&&this.group.remove(this.overlay),this.overlay=new THREE.Object3D,this.grid.generateOverlay(e,this.overlay,t),this.group.add(this.overlay)},generateTilemap:function(e){this.reset();var t=this.grid.generateTiles(e);this.tiles=t,this.tileGroup=new THREE.Object3D;for(var r=0;r<t.length;r++)this.tileGroup.add(t[r].mesh);this.group.add(this.tileGroup)},reset:function(){this.removeAllTiles(),this.tileGroup&&this.group.remove(this.tileGroup)}},s.Board.prototype.constructor=s.Board,s.Cell=function(e,t,r,i){this.q=e||0,this.r=t||0,this.s=r||0,this.h=i||1,this.tile=null,this.userData={},this.walkable=!0,this._calcCost=0,this._priority=0,this._visited=!1,this._parent=null,this.uniqueID=s.LinkedList.generateID()},s.Cell.prototype={set:function(e,t,r){return this.q=e,this.r=t,this.s=r,this},copy:function(e){return this.q=e.q,this.r=e.r,this.s=e.s,this.h=e.h,this.tile=e.tile||null,this.userData=e.userData||{},this.walkable=e.walkable,this},add:function(e){return this.q+=e.q,this.r+=e.r,this.s+=e.s,this},equals:function(e){return this.q===e.q&&this.r===e.r&&this.s===e.s}},s.Cell.prototype.constructor=s.Cell,s.HexGrid=function(e){e=e||{},this.type=s.HEX,this.size=5,this.cellSize=void 0===e.cellSize?10:e.cellSize,this.cells={},this.numCells=0,this.extrudeSettings=null,this.autogenerated=!1;var t,r=[];for(t=0;6>t;t++)r.push(this._createVertex(t));for(this.cellShape=new THREE.Shape,this.cellShape.moveTo(r[0].x,r[0].y),t=1;6>t;t++)this.cellShape.lineTo(r[t].x,r[t].y);this.cellShape.lineTo(r[0].x,r[0].y),this.cellShape.autoClose=!0,this.cellGeo=new THREE.Geometry,this.cellGeo.vertices=r,this.cellGeo.verticesNeedUpdate=!0,this.cellShapeGeo=new THREE.ShapeGeometry(this.cellShape),this._cellWidth=2*this.cellSize,this._cellLength=.5*s.SQRT3*this._cellWidth,this._hashDelimeter=".",this._directions=[new s.Cell(1,-1,0),new s.Cell(1,0,-1),new s.Cell(0,1,-1),new s.Cell(-1,1,0),new s.Cell(-1,0,1),new s.Cell(0,-1,1)],this._diagonals=[new s.Cell(2,-1,-1),new s.Cell(1,1,-2),new s.Cell(-1,2,-1),new s.Cell(-2,1,1),new s.Cell(-1,-1,2),new s.Cell(1,-2,1)],this._list=[],this._vec3=new THREE.Vector3,this._cel=new s.Cell,this._conversionVec=new THREE.Vector3,this._geoCache=[],this._matCache=[]},s.HexGrid.TWO_THIRDS=2/3,s.HexGrid.prototype={cellToPixel:function(e){return this._vec3.x=e.q*this._cellWidth*.75,this._vec3.y=e.h,this._vec3.z=-(e.s-e.r)*this._cellLength*.5,this._vec3},pixelToCell:function(e){var t=e.x*(s.HexGrid.TWO_THIRDS/this.cellSize),r=(-e.x/3+s.SQRT3/3*e.z)/this.cellSize;return this._cel.set(t,r,-t-r),this._cubeRound(this._cel)},getCellAt:function(e){var t=e.x*(s.HexGrid.TWO_THIRDS/this.cellSize),r=(-e.x/3+s.SQRT3/3*e.z)/this.cellSize;return this._cel.set(t,r,-t-r),this._cubeRound(this._cel),this.cells[this.cellToHash(this._cel)]},getNeighbors:function(e,t,r){var i,n,o=this._directions.length;for(this._list.length=0,i=0;o>i;i++)this._cel.copy(e),this._cel.add(this._directions[i]),!(n=this.cells[this.cellToHash(this._cel)])||r&&!r(e,n)||this._list.push(n);if(t)for(i=0;o>i;i++)this._cel.copy(e),this._cel.add(this._diagonals[i]),!(n=this.cells[this.cellToHash(this._cel)])||r&&!r(e,n)||this._list.push(n);return this._list},getRandomCell:function(){var e,t=0,r=s.Tools.randomInt(0,this.numCells);for(e in this.cells){if(t===r)return this.cells[e];t++}return this.cells[e]},cellToHash:function(e){return e.q+this._hashDelimeter+e.r+this._hashDelimeter+e.s},distance:function(e,t){return Math.max(Math.abs(e.q-t.q),Math.abs(e.r-t.r),Math.abs(e.s-t.s))+(t.h-e.h)},clearPath:function(){var e,t;for(e in this.cells)(t=this.cells[e])._calcCost=0,t._priority=0,t._parent=null,t._visited=!1},traverse:function(e){var t;for(t in this.cells)e(this.cells[t])},generateTile:function(e,t,r){var i=Math.abs(e.h);1>i&&(i=1);var n=this._geoCache[i];n||(this.extrudeSettings.amount=i,n=new THREE.ExtrudeGeometry(this.cellShape,this.extrudeSettings),this._geoCache[i]=n);var o=new s.Tile({size:this.cellSize,scale:t,cell:e,geometry:n,material:r});return e.tile=o,o},generateTiles:function(e){e=e||{};var t,r,i,n=[],o={tileScale:.95,cellSize:this.cellSize,material:null,extrudeSettings:{amount:1,bevelEnabled:!0,bevelSegments:1,steps:1,bevelSize:.5,bevelThickness:.5}};for(t in o=s.Tools.merge(o,e),this.cellSize=o.cellSize,this._cellWidth=2*this.cellSize,this._cellLength=.5*s.SQRT3*this._cellWidth,this.autogenerated=!0,this.extrudeSettings=o.extrudeSettings,this.cells)i=this.cells[t],(r=this.generateTile(i,o.tileScale,o.material)).position.copy(this.cellToPixel(i)),r.position.y=0,n.push(r);return n},generateTilePoly:function(e){e||(e=new THREE.MeshBasicMaterial({color:2405631}));var t=new THREE.Mesh(this.cellShapeGeo,e);return this._vec3.set(1,0,0),t.rotateOnAxis(this._vec3,s.PI/2),t},generate:function(e){var t,r,i,n;for(e=e||{},this.size=void 0===e.size?this.size:e.size,t=-this.size;t<this.size+1;t++)for(r=-this.size;r<this.size+1;r++)i=-t-r,Math.abs(t)<=this.size&&Math.abs(r)<=this.size&&Math.abs(i)<=this.size&&(n=new s.Cell(t,r,i),this.add(n))},generateOverlay:function(e,t,r){var i,n,o,a=this.cellShape.createPointsGeometry();for(i=-e;e+1>i;i++)for(n=-e;e+1>n;n++)if(o=-i-n,Math.abs(i)<=e&&Math.abs(n)<=e&&Math.abs(o)<=e){this._cel.set(i,n,o);var l=new THREE.Line(a,r);l.position.copy(this.cellToPixel(this._cel)),l.rotation.x=90*s.DEG_TO_RAD,t.add(l)}},add:function(e){var t=this.cellToHash(e);if(!this.cells[t])return this.cells[t]=e,this.numCells++,e},remove:function(e){var t=this.cellToHash(e);this.cells[t]&&(delete this.cells[t],this.numCells--)},dispose:function(){this.cells=null,this.numCells=0,this.cellShape=null,this.cellGeo.dispose(),this.cellGeo=null,this.cellShapeGeo.dispose(),this.cellShapeGeo=null,this._list=null,this._vec3=null,this._conversionVec=null,this._geoCache=null,this._matCache=null},load:function(e,t,r){var i=this;s.Tools.getJSON({url:e,callback:function(e){i.fromJSON(e),t.call(r||null,e)},cache:!1,scope:i})},fromJSON:function(e){var t,r,i=e.cells;for(this.cells={},this.numCells=0,this.size=e.size,this.cellSize=e.cellSize,this._cellWidth=2*this.cellSize,this._cellLength=.5*s.SQRT3*this._cellWidth,this.extrudeSettings=e.extrudeSettings,this.autogenerated=e.autogenerated,t=0;t<i.length;t++)(r=new s.Cell).copy(i[t]),this.add(r)},toJSON:function(){var e,t,r={size:this.size,cellSize:this.cellSize,extrudeSettings:this.extrudeSettings,autogenerated:this.autogenerated},i=[];for(t in this.cells)e=this.cells[t],i.push({q:e.q,r:e.r,s:e.s,h:e.h,walkable:e.walkable,userData:e.userData});return r.cells=i,r},_createVertex:function(e){var t=s.TAU/6*e;return new THREE.Vector3(this.cellSize*Math.cos(t),this.cellSize*Math.sin(t),0)},_cubeRound:function(e){var t=Math.round(e.q),r=Math.round(e.r),i=Math.round(e.s),n=Math.abs(t-e.q),o=Math.abs(r-e.r),a=Math.abs(i-e.s);return n>o&&n>a?t=-r-i:o>a?r=-t-i:i=-t-r,this._cel.set(t,r,i)}},s.HexGrid.prototype.constructor=s.HexGrid,s.SqrGrid=function(e){e=e||{},this.type=s.SQR,this.size=5,this.cellSize=void 0===e.cellSize?10:e.cellSize,this.cells={},this.numCells=0,this.extrudeSettings=null,this.autogenerated=!1;var t=[];t.push(new THREE.Vector3),t.push(new THREE.Vector3(-this.cellSize,this.cellSize)),t.push(new THREE.Vector3(this.cellSize,this.cellSize)),t.push(new THREE.Vector3(this.cellSize,-this.cellSize)),this.cellShape=new THREE.Shape,this.cellShape.moveTo(-this.cellSize,-this.cellSize),this.cellShape.lineTo(-this.cellSize,this.cellSize),this.cellShape.lineTo(this.cellSize,this.cellSize),this.cellShape.lineTo(this.cellSize,-this.cellSize),this.cellShape.lineTo(-this.cellSize,-this.cellSize),this.cellGeo=new THREE.Geometry,this.cellGeo.vertices=t,this.cellGeo.verticesNeedUpdate=!0,this.cellShapeGeo=new THREE.ShapeGeometry(this.cellShape),this._fullCellSize=2*this.cellSize,this._hashDelimeter=".",this._directions=[new s.Cell(1,0,0),new s.Cell(0,-1,0),new s.Cell(-1,0,0),new s.Cell(0,1,0)],this._diagonals=[new s.Cell(-1,-1,0),new s.Cell(-1,1,0),new s.Cell(1,1,0),new s.Cell(1,-1,0)],this._list=[],this._vec3=new THREE.Vector3,this._cel=new s.Cell,this._conversionVec=new THREE.Vector3,this._geoCache=[],this._matCache=[]},s.SqrGrid.prototype={cellToPixel:function(e){return this._vec3.x=e.q*this._fullCellSize,this._vec3.y=e.h,this._vec3.z=e.r*this._fullCellSize,this._vec3},pixelToCell:function(e){var t=Math.round(e.x/this._fullCellSize),r=Math.round(e.z/this._fullCellSize);return this._cel.set(t,r,0)},getCellAt:function(e){var t=Math.round(e.x/this._fullCellSize),r=Math.round(e.z/this._fullCellSize);return this._cel.set(t,r),this.cells[this.cellToHash(this._cel)]},getNeighbors:function(e,t,r){var i,n,o=this._directions.length;for(this._list.length=0,i=0;o>i;i++)this._cel.copy(e),this._cel.add(this._directions[i]),!(n=this.cells[this.cellToHash(this._cel)])||r&&!r(e,n)||this._list.push(n);if(t)for(i=0;o>i;i++)this._cel.copy(e),this._cel.add(this._diagonals[i]),!(n=this.cells[this.cellToHash(this._cel)])||r&&!r(e,n)||this._list.push(n);return this._list},getRandomCell:function(){var e,t=0,r=s.Tools.randomInt(0,this.numCells);for(e in this.cells){if(t===r)return this.cells[e];t++}return this.cells[e]},cellToHash:function(e){return e.q+this._hashDelimeter+e.r},distance:function(e,t){return Math.max(Math.abs(e.q-t.q),Math.abs(e.r-t.r))+(t.h-e.h)},clearPath:function(){var e,t;for(e in this.cells)(t=this.cells[e])._calcCost=0,t._priority=0,t._parent=null,t._visited=!1},traverse:function(e){var t;for(t in this.cells)e(this.cells[t])},generateTile:function(e,t,r){var i=Math.abs(e.h);1>i&&(i=1);var n=this._geoCache[i];n||(this.extrudeSettings.amount=i,n=new THREE.ExtrudeGeometry(this.cellShape,this.extrudeSettings),this._geoCache[i]=n);var o=new s.Tile({size:this.cellSize,scale:t,cell:e,geometry:n,material:r});return e.tile=o,o},generateTiles:function(e){e=e||{};var t,r,i,n=[],o={tileScale:.95,cellSize:this.cellSize,material:null,extrudeSettings:{amount:1,bevelEnabled:!0,bevelSegments:1,steps:1,bevelSize:.5,bevelThickness:.5}};for(t in o=s.Tools.merge(o,e),this.cellSize=o.cellSize,this._fullCellSize=2*this.cellSize,this.autogenerated=!0,this.extrudeSettings=o.extrudeSettings,this.cells)i=this.cells[t],(r=this.generateTile(i,o.tileScale,o.material)).position.copy(this.cellToPixel(i)),r.position.y=0,n.push(r);return n},generateTilePoly:function(e){e||(e=new THREE.MeshBasicMaterial({color:2405631}));var t=new THREE.Mesh(this.cellShapeGeo,e);return this._vec3.set(1,0,0),t.rotateOnAxis(this._vec3,s.PI/2),t},generate:function(e){e=e||{},this.size=void 0===e.size?this.size:e.size;var t,r,i,n=Math.ceil(this.size/2);for(t=-n;n>t;t++)for(r=-n;n>r;r++)i=new s.Cell(t,r+1),this.add(i)},generateOverlay:function(e,t,r){var i,n,o=Math.ceil(e/2);for(i=-o;o>i;i++)for(n=-o;o>n;n++){this._cel.set(i,n);var a=new THREE.Line(this.cellGeo,r);a.position.copy(this.cellToPixel(this._cel)),a.rotation.x=90*s.DEG_TO_RAD,t.add(a)}},add:function(e){var t=this.cellToHash(e);if(!this.cells[t])return this.cells[t]=e,this.numCells++,e},remove:function(e){var t=this.cellToHash(e);this.cells[t]&&(delete this.cells[t],this.numCells--)},dispose:function(){this.cells=null,this.numCells=0,this.cellShape=null,this.cellGeo.dispose(),this.cellGeo=null,this.cellShapeGeo.dispose(),this.cellShapeGeo=null,this._list=null,this._vec3=null,this._conversionVec=null,this._geoCache=null,this._matCache=null},load:function(e,t,r){s.Tools.getJSON({url:e,callback:function(e){this.fromJSON(e),t.call(r||null,e)},cache:!1,scope:this})},fromJSON:function(e){var t,r,i=e.cells;for(this.cells={},this.numCells=0,this.size=e.size,this.cellSize=e.cellSize,this._fullCellSize=2*this.cellSize,this.extrudeSettings=e.extrudeSettings,this.autogenerated=e.autogenerated,t=0;t<i.length;t++)(r=new s.Cell).copy(i[t]),this.add(r)},toJSON:function(){var e,t,r={size:this.size,cellSize:this.cellSize,extrudeSettings:this.extrudeSettings,autogenerated:this.autogenerated},i=[];for(t in this.cells)e=this.cells[t],i.push({q:e.q,r:e.r,s:e.s,h:e.h,walkable:e.walkable,userData:e.userData});return r.cells=i,r}},s.SqrGrid.prototype.constructor=s.SqrGrid,s.Tile=function(e){e=e||{};var t={cell:null,geometry:null,material:null};if(!(t=s.Tools.merge(t,e)).cell||!t.geometry)throw new Error("Missing vg.Tile configuration");this.cell=t.cell,this.cell.tile&&this.cell.tile!==this&&this.cell.tile.dispose(),this.cell.tile=this,this.uniqueID=s.Tools.generateID(),this.geometry=t.geometry,this.material=t.material,this.material||(this.material=new THREE.MeshPhongMaterial({color:s.Tools.randomizeRGB("30, 30, 30",13)})),this.objectType=s.TILE,this.entity=null,this.userData={},this.selected=!1,this.highlight="0x0084cc",this.mesh=new THREE.Mesh(this.geometry,this.material),this.mesh.userData.structure=this,this.position=this.mesh.position,this.rotation=this.mesh.rotation,this.rotation.x=-90*s.DEG_TO_RAD,this.mesh.scale.set(t.scale,t.scale,1),this.material.emissive?this._emissive=this.material.emissive.getHex():this._emissive=null},s.Tile.prototype={select:function(){return this.material.emissive&&this.material.emissive.setHex(this.highlight),this.selected=!0,this},deselect:function(){return null!==this._emissive&&this.material.emissive&&this.material.emissive.setHex(this._emissive),this.selected=!1,this},toggle:function(){return this.selected?this.deselect():this.select(),this},dispose:function(){this.cell&&this.cell.tile&&(this.cell.tile=null),this.cell=null,this.position=null,this.rotation=null,this.mesh.parent&&this.mesh.parent.remove(this.mesh),this.mesh.userData.structure=null,this.mesh=null,this.material=null,this.userData=null,this.entity=null,this.geometry=null,this._emissive=null}},s.Tile.prototype.constructor=s.Tile,i=function(){this.obj=null,this.next=null,this.prev=null,this.free=!0},(n=function(){this.first=null,this.last=null,this.length=0,this.objToNodeMap={},this.uniqueID=Date.now()+""+Math.floor(1e3*Math.random()),this.sortArray=[]}).generateID=function(){return Math.random().toString(36).slice(2)+Date.now()},(n.prototype={getNode:function(e){return this.objToNodeMap[e.uniqueID]},addNode:function(e){var t=new i;if(!e.uniqueID)try{e.uniqueID=n.generateID()}catch(e){return console.error("[LinkedList.addNode] obj passed is immutable: cannot attach necessary identifier"),null}return t.obj=e,t.free=!1,this.objToNodeMap[e.uniqueID]=t,t},swapObjects:function(e,t){this.objToNodeMap[e.obj.uniqueID]=null,this.objToNodeMap[t.uniqueID]=e,e.obj=t},add:function(e){var t=this.objToNodeMap[e.uniqueID];if(t){if(!1===t.free)return;t.obj=e,t.free=!1,t.next=null,t.prev=null}else t=this.addNode(e);if(this.first){if(!this.last)throw new Error("[LinkedList.add] No last in the list -- that shouldn't happen here");this.last.next=t,t.prev=this.last,this.last=t,t.next=null}else this.first=t,this.last=t,t.next=null,t.prev=null;this.length++,this.showDebug&&this.dump("after add")},has:function(e){return!!this.objToNodeMap[e.uniqueID]},moveUp:function(e){this.dump("before move up");var t=this.getNode(e);if(!t)throw"Oops, trying to move an object that isn't in the list";if(t.prev){var r=t.prev,i=r.prev;t==this.last&&(this.last=r);var n=t.next;i&&(i.next=t),t.next=r,t.prev=r.prev,r.next=n,r.prev=t,this.first==r&&(this.first=t)}},moveDown:function(e){var t=this.getNode(e);if(!t)throw"Oops, trying to move an object that isn't in the list";if(t.next){var r=t.next;this.moveUp(r.obj),this.last==r&&(this.last=t)}},sort:function(e){var t,r,i=this.sortArray,n=this.first;for(i.length=0;n;)i.push(n.obj),n=n.next;for(this.clear(),i.sort(e),r=i.length,t=0;r>t;t++)this.add(i[t])},remove:function(e){var t=this.getNode(e);return!(!t||t.free||(t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t.prev||(this.first=t.next),t.next||(this.last=t.prev),t.free=!0,t.prev=null,t.next=null,this.length--,0))},shift:function(){var e=this.first;return 0===this.length?null:(e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),this.first=e.next,e.next||(this.last=null),e.free=!0,e.prev=null,e.next=null,this.length--,e.obj)},pop:function(){var e=this.last;return 0===this.length?null:(e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),this.last=e.prev,e.prev||(this.first=null),e.free=!0,e.prev=null,e.next=null,this.length--,e.obj)},concat:function(e){for(var t=e.first;t;)this.add(t.obj),t=t.next},clear:function(){for(var e=this.first;e;)e.free=!0,e=e.next;this.first=null,this.length=0},dispose:function(){for(var e=this.first;e;)e.obj=null,e=e.next;this.first=null,this.objToNodeMap=null},dump:function(e){console.log("===================="+e+"=====================");for(var t=this.first;t;)console.log("{"+t.obj.toString()+"} previous="+(t.prev?t.prev.obj:"NULL")),t=t.next();console.log("==================================="),console.log("Last: {"+(this.last?this.last.obj:"NULL")+"} First: {"+(this.first?this.first.obj:"NULL")+"}")}}).constructor=n,s.LinkedList=n,function(){var e=function(e,t,r,i,n){this._listener=t,this.isOnce=r,this.context=i,this.signal=e,this._priority=n||0};(e.prototype={active:!0,params:null,execute:function(e){var t,r;return this.active&&this._listener&&(r=this.params?this.params.concat(e):e,t=this._listener.apply(this.context,r),this.isOnce&&this.detach()),t},detach:function(){return this.isBound()?this.signal.remove(this._listener,this.context):null},isBound:function(){return!!this.signal&&!!this._listener},_destroy:function(){delete this.signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this.isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}}).constructor=e;var t=function e(){this._bindings=[],this._prevParams=null;var t=this;this.dispatch=function(){e.prototype.dispatch.apply(t,arguments)}};(t.prototype={memorize:!1,_shouldPropagate:!0,active:!0,validateListener:function(e,t){if("function"!=typeof e)throw new Error("Signal: listener is a required param of {fn}() and should be a Function.".replace("{fn}",t))},_registerListener:function(t,r,i,n){var o,a=this._indexOfListener(t,i);if(-1!==a){if((o=this._bindings[a]).isOnce!==r)throw new Error("You cannot add"+(r?"":"Once")+"() then add"+(r?"Once":"")+"() the same listener without removing the relationship first.")}else o=new e(this,t,r,i,n),this._addBinding(o);return this.memorize&&this._prevParams&&o.execute(this._prevParams),o},_addBinding:function(e){var t=this._bindings.length;do{t--}while(this._bindings[t]&&e._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,e)},_indexOfListener:function(e,t){for(var r,i=this._bindings.length;i--;)if((r=this._bindings[i])._listener===e&&r.context===t)return i;return-1},has:function(e,t){return-1!==this._indexOfListener(e,t)},add:function(e,t,r){return this.validateListener(e,"add"),this._registerListener(e,!1,t,r)},addOnce:function(e,t,r){return this.validateListener(e,"addOnce"),this._registerListener(e,!0,t,r)},remove:function(e,t){this.validateListener(e,"remove");var r=this._indexOfListener(e,t);return-1!==r&&(this._bindings[r]._destroy(),this._bindings.splice(r,1)),e},removeAll:function(e){void 0===e&&(e=null);for(var t=this._bindings.length;t--;)e?this._bindings[t].context===e&&(this._bindings[t]._destroy(),this._bindings.splice(t,1)):this._bindings[t]._destroy();e||(this._bindings.length=0)},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){var e,t=Array.prototype.slice.call(arguments),r=this._bindings.length;if(this.memorize&&(this._prevParams=t),r){e=this._bindings.slice(),this._shouldPropagate=!0;do{r--}while(e[r]&&this._shouldPropagate&&!1!==e[r].execute(t))}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}}).constructor=t,s.Signal=t}(),s.AStarFinder=function(e){e=e||{};var t={allowDiagonal:!1,heuristicFilter:null};t=s.Tools.merge(t,e),this.allowDiagonal=t.allowDiagonal,this.heuristicFilter=t.heuristicFilter,this.list=new s.LinkedList},s.AStarFinder.prototype={findPath:function(e,t,r,i){var n,o,a,l,c,u;for(r=r||this.heuristicFilter,i.clearPath(),this.list.clear(),this.list.add(e);this.list.length>0;){if(this.list.sort(this.compare),(n=this.list.shift())._visited=!0,n===t)return s.PathUtil.backtrace(t);for(c=0,u=(a=i.getNeighbors(n,this.allowDiagonal,r)).length;u>c;c++)if((l=a[c]).walkable&&(o=n._calcCost+i.distance(n,l),!l._visited||o<l._calcCost)){if(l._visited=!0,l._parent=n,l._calcCost=o,l._priority=o+i.distance(t,l),l===t)return s.PathUtil.backtrace(t);this.list.add(l)}}return null},compare:function(e,t){return e._priority-t._priority}},s.AStarFinder.prototype.constructor=s.AStarFinder,s.PathUtil={backtrace:function(e){for(var t=[e];e._parent;)e=e._parent,t.push(e);return t.reverse()},biBacktrace:function(e,t){var r=this.backtrace(e),i=this.backtrace(t);return r.concat(i.reverse())},pathLength:function(e){var t,r,i,n,o,a=0;for(t=1;t<e.length;++t)r=e[t-1],i=e[t],n=r[0]-i[0],o=r[1]-i[1],a+=Math.sqrt(n*n+o*o);return a},interpolate:function(e,t,r,i){var n,o,a,s,l,c,u=Math.abs,d=[];for(n=r>e?1:-1,o=i>t?1:-1,l=(a=u(r-e))-(s=u(i-t));e!==r||t!==i;)d.push([e,t]),(c=2*l)>-s&&(l-=s,e+=n),a>c&&(l+=a,t+=o);return d},expandPath:function(e){var t,r,i,n,o,a,s=[],l=e.length;if(2>l)return s;for(o=0;l-1>o;++o)for(t=e[o],r=e[o+1],n=(i=this.interpolate(t[0],t[1],r[0],r[1])).length,a=0;n-1>a;++a)s.push(i[a]);return s.push(e[l-1]),s},smoothenPath:function(e,t){var r,i,n,o,a,s,l,c,u,d,h,f,p=t.length,m=t[0][0],v=t[0][1],g=t[p-1][0],y=t[p-1][1];for(a=[[r=m,i=v]],l=2;p>l;++l){for(n=(u=t[l])[0],o=u[1],d=this.interpolate(r,i,n,o),f=!1,c=1;c<d.length;++c)if(h=d[c],!e.isWalkableAt(h[0],h[1])){f=!0;break}f&&(s=t[l-1],a.push(s),r=s[0],i=s[1])}return a.push([g,y]),a},compressPath:function(e){if(e.length<3)return e;var t,r,i,n,o,a,s=[],l=e[0][0],c=e[0][1],u=e[1][0],d=e[1][1],h=u-l,f=d-c;for(h/=o=Math.sqrt(h*h+f*f),f/=o,s.push([l,c]),a=2;a<e.length;a++)t=u,r=d,i=h,n=f,h=(u=e[a][0])-t,f=(d=e[a][1])-r,f/=o=Math.sqrt(h*h+f*f),((h/=o)!==i||f!==n)&&s.push([t,r]);return s.push([u,d]),s}},s.Loader={manager:null,imageLoader:null,crossOrigin:!1,init:function(e){this.crossOrigin=e||!1,this.manager=new THREE.LoadingManager(function(){},function(){},function(){console.warn("Error loading images")}),this.imageLoader=new THREE.ImageLoader(this.manager),this.imageLoader.crossOrigin=e},loadTexture:function(e,t,r,i){var n=new THREE.Texture(null,t);return this.imageLoader.load(e,function(e){n.image=e,n.needsUpdate=!0,r&&r(n)},null,function(e){i&&i(e)}),n.sourceFile=e,n}},s.MouseCaster=function(e,t,r){this.down=!1,this.rightDown=!1,this.pickedObject=null,this.selectedObject=null,this.allHits=null,this.active=!0,this.shift=!1,this.ctrl=!1,this.wheel=0,this.position=new THREE.Vector3,this.screenPosition=new THREE.Vector2,this.signal=new s.Signal,this.group=e,this._camera=t,this._raycaster=new THREE.Raycaster,this._preventDefault=!1,(r=r||document).addEventListener("mousemove",this._onDocumentMouseMove.bind(this),!1),r.addEventListener("mousedown",this._onDocumentMouseDown.bind(this),!1),r.addEventListener("mouseup",this._onDocumentMouseUp.bind(this),!1),r.addEventListener("mousewheel",this._onMouseWheel.bind(this),!1),r.addEventListener("DOMMouseScroll",this._onMouseWheel.bind(this),!1)},s.MouseCaster.OVER="over",s.MouseCaster.OUT="out",s.MouseCaster.DOWN="down",s.MouseCaster.UP="up",s.MouseCaster.CLICK="click",s.MouseCaster.WHEEL="wheel",s.MouseCaster.prototype={update:function(){if(this.active){this._raycaster.setFromCamera(this.screenPosition,this._camera);var e,t,r=this._raycaster.intersectObject(this.group,!0);r.length>0?(t=(e=r[0]).object.userData.structure,this.pickedObject!=t&&(this.pickedObject&&this.signal.dispatch(s.MouseCaster.OUT,this.pickedObject),this.pickedObject=t,this.selectedObject=null,this.signal.dispatch(s.MouseCaster.OVER,this.pickedObject)),this.position.copy(e.point),this.screenPosition.z=e.distance):(this.pickedObject&&this.signal.dispatch(s.MouseCaster.OUT,this.pickedObject),this.pickedObject=null,this.selectedObject=null),this.allHits=r}},preventDefault:function(){this._preventDefault=!0},_onDocumentMouseDown:function(e){return(e=e||window.event).preventDefault(),this._preventDefault?(this._preventDefault=!1,!1):(this.pickedObject&&(this.selectedObject=this.pickedObject),this.shift=e.shiftKey,this.ctrl=e.ctrlKey,this.down=1===e.which,this.rightDown=3===e.which,void this.signal.dispatch(s.MouseCaster.DOWN,this.pickedObject))},_onDocumentMouseUp:function(e){return e.preventDefault(),this._preventDefault?(this._preventDefault=!1,!1):(this.shift=e.shiftKey,this.ctrl=e.ctrlKey,this.signal.dispatch(s.MouseCaster.UP,this.pickedObject),this.selectedObject&&this.pickedObject&&this.selectedObject.uniqueID===this.pickedObject.uniqueID&&this.signal.dispatch(s.MouseCaster.CLICK,this.pickedObject),this.down=1!==e.which&&this.down,void(this.rightDown=3!==e.which&&this.rightDown))},_onDocumentMouseMove:function(e){e.preventDefault(),this.screenPosition.x=e.clientX/window.innerWidth*2-1,this.screenPosition.y=-e.clientY/window.innerHeight*2+1},_onMouseWheel:function(e){if(this.active){e.preventDefault(),e.stopPropagation();var t=0;void 0!==e.wheelDelta?t=e.wheelDelta:void 0!==e.detail&&(t=-e.detail),t>0?this.wheel++:this.wheel--,this.signal.dispatch(s.MouseCaster.WHEEL,this.wheel)}}},s.MouseCaster.prototype.constructor=s.MouseCaster,s.Scene=function(e,t){var r={element:document.body,alpha:!0,antialias:!0,clearColor:"#fff",sortObjects:!1,fog:null,light:new THREE.DirectionalLight(16777215),lightPosition:null,cameraType:"PerspectiveCamera",cameraPosition:null,orthoZoom:4},i={minDistance:100,maxDistance:1e3,zoomSpeed:2,noZoom:!1};if(r=s.Tools.merge(r,e),"boolean"!=typeof t&&(i=s.Tools.merge(i,t)),this.renderer=new THREE.WebGLRenderer({alpha:r.alpha,antialias:r.antialias}),this.renderer.setClearColor(r.clearColor,0),this.renderer.sortObjects=r.sortObjects,this.width=window.innerWidth,this.height=window.innerHeight,this.orthoZoom=r.orthoZoom,this.container=new THREE.Scene,this.container.fog=r.fog,this.container.add(new THREE.AmbientLight(14540253)),r.lightPosition||r.light.position.set(-1,1,-1).normalize(),this.container.add(r.light),"OrthographicCamera"===r.cameraType){var n=window.innerWidth/this.orthoZoom,o=window.innerHeight/this.orthoZoom;this.camera=new THREE.OrthographicCamera(n/-2,n/2,o/2,o/-2,1,5e3)}else this.camera=new THREE.PerspectiveCamera(50,this.width/this.height,1,5e3);this.contolled=!!t,this.contolled&&(this.controls=new THREE.OrbitControls(this.camera,this.renderer.domElement),this.controls.minDistance=i.minDistance,this.controls.maxDistance=i.maxDistance,this.controls.zoomSpeed=i.zoomSpeed,this.controls.noZoom=i.noZoom),r.cameraPosition&&this.camera.position.copy(r.cameraPosition),window.addEventListener("resize",function(){if(this.width=window.innerWidth,this.height=window.innerHeight,"OrthographicCamera"===this.camera.type){var e=this.width/this.orthoZoom,t=this.height/this.orthoZoom;this.camera.left=e/-2,this.camera.right=e/2,this.camera.top=t/2,this.camera.bottom=t/-2}else this.camera.aspect=this.width/this.height;this.camera.updateProjectionMatrix(),this.renderer.setSize(this.width,this.height)}.bind(this),!1),this.attachTo(r.element)},s.Scene.prototype={attachTo:function(e){e.style.width=this.width+"px",e.style.height=this.height+"px",this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height),e.appendChild(this.renderer.domElement)},add:function(e){this.container.add(e)},remove:function(e){this.container.remove(e)},render:function(){this.contolled&&this.controls.update(),this.renderer.render(this.container,this.camera)},updateOrthoZoom:function(){if(this.orthoZoom<=0)this.orthoZoom=0;else{var e=this.width/this.orthoZoom,t=this.height/this.orthoZoom;this.camera.left=e/-2,this.camera.right=e/2,this.camera.top=t/2,this.camera.bottom=t/-2,this.camera.updateProjectionMatrix()}},focusOn:function(e){this.camera.lookAt(e.position)}},s.Scene.prototype.constructor=s.Scene,s.SelectionManager=function(e){this.mouse=e,this.onSelect=new s.Signal,this.onDeselect=new s.Signal,this.selected=null,this.toggleSelection=!1,this.mouse.signal.add(this.onMouse,this)},s.SelectionManager.prototype={select:function(e,t){e&&(t=t||!0,this.selected!==e&&this.clearSelection(t),e.selected?this.toggleSelection&&(t&&this.onDeselect.dispatch(e),e.deselect()):e.select(),this.selected=e,t&&this.onSelect.dispatch(e))},clearSelection:function(e){e=e||!0,this.selected&&(e&&this.onDeselect.dispatch(this.selected),this.selected.deselect()),this.selected=null},onMouse:function(e,t){switch(e){case s.MouseCaster.DOWN:t||this.clearSelection();break;case s.MouseCaster.CLICK:this.select(t)}}},s.SelectionManager.prototype.constructor=s.SelectionManager,s.Tools={clamp:function(e,t,r){return Math.max(t,Math.min(r,e))},sign:function(e){return e&&e/Math.abs(e)},random:function(e,t){return 1===arguments.length?Math.random()*e-.5*e:Math.random()*(t-e)+e},randomInt:function(e,t){return 1===arguments.length?Math.random()*e-.5*e|0:Math.random()*(t-e+1)+e|0},normalize:function(e,t,r){return(e-t)/(r-t)},getShortRotation:function(e){return(e%=this.TAU)>this.PI?e-=this.TAU:e<-this.PI&&(e+=this.TAU),e},generateID:function(){return Math.random().toString(36).slice(2)+Date.now()},isPlainObject:function(e){if("object"!=(void 0===e?"undefined":a(e))||e.nodeType||e===e.window)return!1;try{if(e.constructor&&!Object.prototype.hasOwnProperty.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}return!0},merge:function(e,t){var r=this,i=Array.isArray(t),n=i&&[]||{};return i?(e=e||[],n=n.concat(e),t.forEach(function(t,i){void 0===n[i]?n[i]=t:r.isPlainObject(t)?n[i]=r.merge(e[i],t):-1===e.indexOf(t)&&n.push(t)}),n):(e&&r.isPlainObject(e)&&Object.keys(e).forEach(function(t){n[t]=e[t]}),Object.keys(t).forEach(function(i){t[i]&&r.isPlainObject(t[i])&&e[i]?n[i]=r.merge(e[i],t[i]):n[i]=t[i]}),n)},now:function(){return window.nwf?window.nwf.system.Performance.elapsedTime:window.performance.now()},empty:function(e){for(;e.lastChild;)e.removeChild(e.lastChild)},radixSort:function(e,t,r,i){if(i=i||31,!((t=t||0)>=(r=r||e.length)-1||0>i)){for(var n=t,o=r,a=1<<i;o>n;)if(e[n]&a){--o;var s=e[n];e[n]=e[o],e[o]=s}else++n;this.radixSort(e,t,o,i-1),this.radixSort(e,o,r,i-1)}},randomizeRGB:function(e,t){var r,i,n=e.split(","),o="rgb(";for(t=this.randomInt(t),r=0;3>r;r++)0>(i=parseInt(n[r])+t)?i=0:i>255&&(i=255),o+=i+",";return(o=o.substring(0,o.length-1))+")"},getJSON:function(e){var t=new XMLHttpRequest,r=void 0!==e.cache&&e.cache?e.url:e.url+"?t="+Math.floor(1e4*Math.random())+Date.now();t.onreadystatechange=function(){if(200!==this.status)0!==this.status&&console.warn("[Tools.getJSON] Error: "+this.status+" ("+this.statusText+") :: "+e.url);else{var t=null;try{t=JSON.parse(this.responseText)}catch(e){return}e.callback.call(e.scope||null,t)}},t.open("GET",r,!0),t.setRequestHeader("Accept","application/json"),t.setRequestHeader("Content-Type","application/json"),t.send("")}}},{}],10:[function(e,t,r){"use strict";!function(e){var t="KeyboardEvent"in e;t||(e.KeyboardEvent=function(){throw TypeError("Illegal constructor")}),"DOM_KEY_LOCATION_STANDARD"in e.KeyboardEvent||(e.KeyboardEvent.DOM_KEY_LOCATION_STANDARD=0),"DOM_KEY_LOCATION_LEFT"in e.KeyboardEvent||(e.KeyboardEvent.DOM_KEY_LOCATION_LEFT=1),"DOM_KEY_LOCATION_RIGHT"in e.KeyboardEvent||(e.KeyboardEvent.DOM_KEY_LOCATION_RIGHT=2),"DOM_KEY_LOCATION_NUMPAD"in e.KeyboardEvent||(e.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD=3);var r=window.KeyboardEvent.DOM_KEY_LOCATION_STANDARD,i=window.KeyboardEvent.DOM_KEY_LOCATION_LEFT,n=window.KeyboardEvent.DOM_KEY_LOCATION_RIGHT,o=window.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD;function a(e,t){return-1!==String(e).indexOf(t)}var s=a(navigator.platform,"Win")?"win":a(navigator.platform,"Mac")?"mac":a(navigator.platform,"CrOS")?"cros":a(navigator.platform,"Linux")?"linux":a(navigator.userAgent,"iPad")||a(navigator.platform,"iPod")||a(navigator.platform,"iPhone")?"ios":"",l=a(navigator.userAgent,"Chrome/")?"chrome":a(navigator.vendor,"Apple")?"safari":a(navigator.userAgent,"MSIE")?"ie":a(navigator.userAgent,"Gecko/")?"moz":a(navigator.userAgent,"Opera/")?"opera":"",c=l+"-"+s;function u(e,t,r){c!==t&&l!==t&&s!==t||Object.keys(r).forEach(function(t){e[t]=r[t]})}var d={3:{code:"Cancel"},6:{code:"Help"},8:{code:"Backspace"},9:{code:"Tab"},12:{code:"Clear"},13:{code:"Enter"},16:{code:"Shift"},17:{code:"Control"},18:{code:"Alt"},19:{code:"Pause"},20:{code:"CapsLock"},21:{code:"KanaMode"},22:{code:"HangulMode"},23:{code:"JunjaMode"},24:{code:"FinalMode"},25:{code:"KanjiMode"},27:{code:"Escape"},28:{code:"Convert"},29:{code:"NonConvert"},30:{code:"Accept"},31:{code:"ModeChange"},32:{code:"Space"},33:{code:"PageUp"},34:{code:"PageDown"},35:{code:"End"},36:{code:"Home"},37:{code:"ArrowLeft"},38:{code:"ArrowUp"},39:{code:"ArrowRight"},40:{code:"ArrowDown"},41:{code:"Select"},42:{code:"Print"},43:{code:"Execute"},44:{code:"PrintScreen"},45:{code:"Insert"},46:{code:"Delete"},47:{code:"Help"},48:{code:"Digit0",keyCap:"0"},49:{code:"Digit1",keyCap:"1"},50:{code:"Digit2",keyCap:"2"},51:{code:"Digit3",keyCap:"3"},52:{code:"Digit4",keyCap:"4"},53:{code:"Digit5",keyCap:"5"},54:{code:"Digit6",keyCap:"6"},55:{code:"Digit7",keyCap:"7"},56:{code:"Digit8",keyCap:"8"},57:{code:"Digit9",keyCap:"9"},65:{code:"KeyA",keyCap:"a"},66:{code:"KeyB",keyCap:"b"},67:{code:"KeyC",keyCap:"c"},68:{code:"KeyD",keyCap:"d"},69:{code:"KeyE",keyCap:"e"},70:{code:"KeyF",keyCap:"f"},71:{code:"KeyG",keyCap:"g"},72:{code:"KeyH",keyCap:"h"},73:{code:"KeyI",keyCap:"i"},74:{code:"KeyJ",keyCap:"j"},75:{code:"KeyK",keyCap:"k"},76:{code:"KeyL",keyCap:"l"},77:{code:"KeyM",keyCap:"m"},78:{code:"KeyN",keyCap:"n"},79:{code:"KeyO",keyCap:"o"},80:{code:"KeyP",keyCap:"p"},81:{code:"KeyQ",keyCap:"q"},82:{code:"KeyR",keyCap:"r"},83:{code:"KeyS",keyCap:"s"},84:{code:"KeyT",keyCap:"t"},85:{code:"KeyU",keyCap:"u"},86:{code:"KeyV",keyCap:"v"},87:{code:"KeyW",keyCap:"w"},88:{code:"KeyX",keyCap:"x"},89:{code:"KeyY",keyCap:"y"},90:{code:"KeyZ",keyCap:"z"},91:{code:"OSLeft",location:i},92:{code:"OSRight",location:n},93:{code:"ContextMenu"},95:{code:"Standby"},96:{code:"Numpad0",keyCap:"0",location:o},97:{code:"Numpad1",keyCap:"1",location:o},98:{code:"Numpad2",keyCap:"2",location:o},99:{code:"Numpad3",keyCap:"3",location:o},100:{code:"Numpad4",keyCap:"4",location:o},101:{code:"Numpad5",keyCap:"5",location:o},102:{code:"Numpad6",keyCap:"6",location:o},103:{code:"Numpad7",keyCap:"7",location:o},104:{code:"Numpad8",keyCap:"8",location:o},105:{code:"Numpad9",keyCap:"9",location:o},106:{code:"NumpadMultiply",keyCap:"*",location:o},107:{code:"NumpadAdd",keyCap:"+",location:o},108:{code:"NumpadComma",keyCap:",",location:o},109:{code:"NumpadSubtract",keyCap:"-",location:o},110:{code:"NumpadDecimal",keyCap:".",location:o},111:{code:"NumpadDivide",keyCap:"/",location:o},112:{code:"F1"},113:{code:"F2"},114:{code:"F3"},115:{code:"F4"},116:{code:"F5"},117:{code:"F6"},118:{code:"F7"},119:{code:"F8"},120:{code:"F9"},121:{code:"F10"},122:{code:"F11"},123:{code:"F12"},124:{code:"F13"},125:{code:"F14"},126:{code:"F15"},127:{code:"F16"},128:{code:"F17"},129:{code:"F18"},130:{code:"F19"},131:{code:"F20"},132:{code:"F21"},133:{code:"F22"},134:{code:"F23"},135:{code:"F24"},144:{code:"NumLock",location:o},145:{code:"ScrollLock"},160:{code:"ShiftLeft",location:i},161:{code:"ShiftRight",location:n},162:{code:"ControlLeft",location:i},163:{code:"ControlRight",location:n},164:{code:"AltLeft",location:i},165:{code:"AltRight",location:n},166:{code:"BrowserBack"},167:{code:"BrowserForward"},168:{code:"BrowserRefresh"},169:{code:"BrowserStop"},170:{code:"BrowserSearch"},171:{code:"BrowserFavorites"},172:{code:"BrowserHome"},173:{code:"VolumeMute"},174:{code:"VolumeDown"},175:{code:"VolumeUp"},176:{code:"MediaTrackNext"},177:{code:"MediaTrackPrevious"},178:{code:"MediaStop"},179:{code:"MediaPlayPause"},180:{code:"LaunchMail"},181:{code:"MediaSelect"},182:{code:"LaunchApp1"},183:{code:"LaunchApp2"},186:{code:"Semicolon",keyCap:";"},187:{code:"Equal",keyCap:"="},188:{code:"Comma",keyCap:","},189:{code:"Minus",keyCap:"-"},190:{code:"Period",keyCap:"."},191:{code:"Slash",keyCap:"/"},192:{code:"Backquote",keyCap:"`"},219:{code:"BracketLeft",keyCap:"["},220:{code:"Backslash",keyCap:"\\"},221:{code:"BracketRight",keyCap:"]"},222:{code:"Quote",keyCap:"'"},226:{code:"IntlBackslash",keyCap:"\\"},229:{code:"Process"},246:{code:"Attn"},247:{code:"CrSel"},248:{code:"ExSel"},249:{code:"EraseEof"},250:{code:"Play"},251:{code:"ZoomToggle"},254:{code:"Clear"}};u(d,"moz",{59:{code:"Semicolon",keyCap:";"},61:{code:"Equal",keyCap:"="},107:{code:"Equal",keyCap:"="},109:{code:"Minus",keyCap:"-"},187:{code:"NumpadAdd",keyCap:"+",location:o},189:{code:"NumpadSubtract",keyCap:"-",location:o}}),u(d,"moz-mac",{12:{code:"NumLock",location:o},173:{code:"Minus",keyCap:"-"}}),u(d,"moz-win",{173:{code:"Minus",keyCap:"-"}}),u(d,"chrome-mac",{93:{code:"OSRight",location:n}}),u(d,"safari",{3:{code:"Enter"},25:{code:"Tab"}}),u(d,"ios",{10:{code:"Enter",location:r}}),u(d,"safari-mac",{91:{code:"OSLeft",location:i},93:{code:"OSRight",location:n},229:{code:"KeyQ",keyCap:"Q"}});var h={};"cros"===s&&(h["U+00A0"]={code:"ShiftLeft",location:i},h["U+00A1"]={code:"ShiftRight",location:n},h["U+00A2"]={code:"ControlLeft",location:i},h["U+00A3"]={code:"ControlRight",location:n},h["U+00A4"]={code:"AltLeft",location:i},h["U+00A5"]={code:"AltRight",location:n}),"chrome-mac"===c&&(h["U+0010"]={code:"ContextMenu"}),"safari-mac"===c&&(h["U+0010"]={code:"ContextMenu"}),"ios"===s&&(h["U+0010"]={code:"Function"},h["U+001C"]={code:"ArrowLeft"},h["U+001D"]={code:"ArrowRight"},h["U+001E"]={code:"ArrowUp"},h["U+001F"]={code:"ArrowDown"},h["U+0001"]={code:"Home"},h["U+0004"]={code:"End"},h["U+000B"]={code:"PageUp"},h["U+000C"]={code:"PageDown"});var f=[];f[i]={16:{code:"ShiftLeft",location:i},17:{code:"ControlLeft",location:i},18:{code:"AltLeft",location:i}},f[n]={16:{code:"ShiftRight",location:n},17:{code:"ControlRight",location:n},18:{code:"AltRight",location:n}},f[o]={13:{code:"NumpadEnter",location:o}},u(f[o],"moz",{109:{code:"NumpadSubtract",location:o},107:{code:"NumpadAdd",location:o}}),u(f[i],"moz-mac",{224:{code:"OSLeft",location:i}}),u(f[n],"moz-mac",{224:{code:"OSRight",location:n}}),u(f[n],"moz-win",{91:{code:"OSRight",location:n}}),u(f[n],"mac",{93:{code:"OSRight",location:n}}),u(f[o],"chrome-mac",{12:{code:"NumLock",location:o}}),u(f[o],"safari-mac",{12:{code:"NumLock",location:o},187:{code:"NumpadAdd",location:o},189:{code:"NumpadSubtract",location:o},190:{code:"NumpadDecimal",location:o},191:{code:"NumpadDivide",location:o}});var p={ShiftLeft:{key:"Shift"},ShiftRight:{key:"Shift"},ControlLeft:{key:"Control"},ControlRight:{key:"Control"},AltLeft:{key:"Alt"},AltRight:{key:"Alt"},OSLeft:{key:"OS"},OSRight:{key:"OS"},NumpadEnter:{key:"Enter"},Space:{key:" "},Digit0:{key:"0",shiftKey:")"},Digit1:{key:"1",shiftKey:"!"},Digit2:{key:"2",shiftKey:"@"},Digit3:{key:"3",shiftKey:"#"},Digit4:{key:"4",shiftKey:"$"},Digit5:{key:"5",shiftKey:"%"},Digit6:{key:"6",shiftKey:"^"},Digit7:{key:"7",shiftKey:"&"},Digit8:{key:"8",shiftKey:"*"},Digit9:{key:"9",shiftKey:"("},KeyA:{key:"a",shiftKey:"A"},KeyB:{key:"b",shiftKey:"B"},KeyC:{key:"c",shiftKey:"C"},KeyD:{key:"d",shiftKey:"D"},KeyE:{key:"e",shiftKey:"E"},KeyF:{key:"f",shiftKey:"F"},KeyG:{key:"g",shiftKey:"G"},KeyH:{key:"h",shiftKey:"H"},KeyI:{key:"i",shiftKey:"I"},KeyJ:{key:"j",shiftKey:"J"},KeyK:{key:"k",shiftKey:"K"},KeyL:{key:"l",shiftKey:"L"},KeyM:{key:"m",shiftKey:"M"},KeyN:{key:"n",shiftKey:"N"},KeyO:{key:"o",shiftKey:"O"},KeyP:{key:"p",shiftKey:"P"},KeyQ:{key:"q",shiftKey:"Q"},KeyR:{key:"r",shiftKey:"R"},KeyS:{key:"s",shiftKey:"S"},KeyT:{key:"t",shiftKey:"T"},KeyU:{key:"u",shiftKey:"U"},KeyV:{key:"v",shiftKey:"V"},KeyW:{key:"w",shiftKey:"W"},KeyX:{key:"x",shiftKey:"X"},KeyY:{key:"y",shiftKey:"Y"},KeyZ:{key:"z",shiftKey:"Z"},Numpad0:{key:"0"},Numpad1:{key:"1"},Numpad2:{key:"2"},Numpad3:{key:"3"},Numpad4:{key:"4"},Numpad5:{key:"5"},Numpad6:{key:"6"},Numpad7:{key:"7"},Numpad8:{key:"8"},Numpad9:{key:"9"},NumpadMultiply:{key:"*"},NumpadAdd:{key:"+"},NumpadComma:{key:","},NumpadSubtract:{key:"-"},NumpadDecimal:{key:"."},NumpadDivide:{key:"/"},Semicolon:{key:";",shiftKey:":"},Equal:{key:"=",shiftKey:"+"},Comma:{key:",",shiftKey:"<"},Minus:{key:"-",shiftKey:"_"},Period:{key:".",shiftKey:">"},Slash:{key:"/",shiftKey:"?"},Backquote:{key:"`",shiftKey:"~"},BracketLeft:{key:"[",shiftKey:"{"},Backslash:{key:"\\",shiftKey:"|"},BracketRight:{key:"]",shiftKey:"}"},Quote:{key:"'",shiftKey:'"'},IntlBackslash:{key:"\\",shiftKey:"|"}};u(p,"mac",{OSLeft:{key:"Meta"},OSRight:{key:"Meta"}});var m={Esc:"Escape",Nonconvert:"NonConvert",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Menu:"ContextMenu",MediaNextTrack:"MediaTrackNext",MediaPreviousTrack:"MediaTrackPrevious",SelectMedia:"MediaSelect",HalfWidth:"Hankaku",FullWidth:"Zenkaku",RomanCharacters:"Romaji",Crsel:"CrSel",Exsel:"ExSel",Zoom:"ZoomToggle"},v=function(e,t){var r={};return Object.keys(e).forEach(function(i){var n=e[i];t in n&&(r[n[t]]=n)}),r}(d,"code");try{var g=t&&"location"in new KeyboardEvent("")}catch(e){}function y(e){var t="keyCode"in e?e.keyCode:"which"in e?e.which:0,r=function(){if(g||"keyLocation"in e){var r=g?e.location:e.keyLocation;if(r&&t in f[r])return f[r][t]}return"keyIdentifier"in e&&e.keyIdentifier in h?h[e.keyIdentifier]:t in d?d[t]:null}();if(!r)return null;var i,n=(i=p[r.code])?e.shiftKey&&"shiftKey"in i?i.shiftKey:i.key:r.code;return{code:r.code,key:n,location:r.location,keyCap:r.keyCap}}"KeyboardEvent"in e&&"defineProperty"in Object&&function(){function e(e,t,r){t in e||Object.defineProperty(e,t,r)}if(e(KeyboardEvent.prototype,"code",{get:function(){var e=y(this);return e?e.code:""}}),"key"in KeyboardEvent.prototype){var t=Object.getOwnPropertyDescriptor(KeyboardEvent.prototype,"key");Object.defineProperty(KeyboardEvent.prototype,"key",{get:function(){var e=t.get.call(this);return m.hasOwnProperty(e)?m[e]:e}})}e(KeyboardEvent.prototype,"key",{get:function(){var e=y(this);return e&&"key"in e?e.key:"Unidentified"}}),e(KeyboardEvent.prototype,"location",{get:function(){var e=y(this);return e&&"location"in e?e.location:r}}),e(KeyboardEvent.prototype,"locale",{get:function(){return""}})}(),"queryKeyCap"in e.KeyboardEvent||(e.KeyboardEvent.queryKeyCap=function(e,t){if(e=String(e),!v.hasOwnProperty(e))return"Undefined";if(t&&"en-us"!==String(t).toLowerCase())throw Error("Unsupported locale");var r=v[e];return r.keyCap||r.code||"Undefined"}),e.identifyKey=function(e){if(!("code"in e)){var t=y(e);e.code=t?t.code:"",e.key=t&&"key"in t?t.key:"Unidentified",e.location="location"in e?e.location:"keyLocation"in e?e.keyLocation:t&&"location"in t?t.location:r,e.locale=""}}}(window)},{}],11:[function(e,t,r){var i=function(){};i.computeCentroids=function(e){var t,r,i;for(t=0,r=e.faces.length;t<r;t++)(i=e.faces[t]).centroid=new THREE.Vector3(0,0,0),i.centroid.add(e.vertices[i.a]),i.centroid.add(e.vertices[i.b]),i.centroid.add(e.vertices[i.c]),i.centroid.divideScalar(3)},i.roundNumber=function(e,t){return Number(e.toFixed(t))},i.sample=function(e){return e[Math.floor(Math.random()*e.length)]},i.mergeVertexIds=function(e,t){var r=[];if(e.forEach(function(e){t.indexOf(e)>=0&&r.push(e)}),r.length<2)return[];r.includes(e[0])&&r.includes(e[e.length-1])&&e.push(e.shift()),r.includes(t[0])&&r.includes(t[t.length-1])&&t.push(t.shift()),r=[],e.forEach(function(e){t.includes(e)&&r.push(e)});for(var i=r[1],n=r[0],o=e.slice();o[0]!==i;)o.push(o.shift());for(var a=0,s=t.slice();s[0]!==n;)if(s.push(s.shift()),a++>10)throw new Error("Unexpected state");return s.shift(),s.pop(),o.concat(s)},i.setPolygonCentroid=function(e,t){var r=new THREE.Vector3,i=t.vertices;e.vertexIds.forEach(function(e){r.add(i[e])}),r.divideScalar(e.vertexIds.length),e.centroid.copy(r)},i.cleanPolygon=function(e,t){for(var r=[],i=t.vertices,n=0;n<e.vertexIds.length;n++){var o,a,s,l=i[e.vertexIds[n]];0===n?(o=e.vertexIds[1],a=e.vertexIds[e.vertexIds.length-1]):n===e.vertexIds.length-1?(o=e.vertexIds[0],a=e.vertexIds[e.vertexIds.length-2]):(o=e.vertexIds[n+1],a=e.vertexIds[n-1]),s=i[a];var c=i[o].clone().sub(l),u=s.clone().sub(l),d=c.angleTo(u);if(d>Math.PI-.01&&d<Math.PI+.01){var h=[];e.neighbours.forEach(function(t){t.vertexIds.includes(e.vertexIds[n])||h.push(t)}),e.neighbours=h}else r.push(e.vertexIds[n])}e.vertexIds=r,this.setPolygonCentroid(e,t)},i.isConvex=function(e,t){var r=t.vertices;if(e.vertexIds.length<3)return!1;for(var i=!0,n=[],o=0;o<e.vertexIds.length;o++){var a,s,l=r[e.vertexIds[o]];0===o?(a=r[e.vertexIds[1]],s=r[e.vertexIds[e.vertexIds.length-1]]):o===e.vertexIds.length-1?(a=r[e.vertexIds[0]],s=r[e.vertexIds[e.vertexIds.length-2]]):(a=r[e.vertexIds[o+1]],s=r[e.vertexIds[o-1]]);var c=a.clone().sub(l),u=s.clone().sub(l),d=c.angleTo(u);if(d===Math.PI||0===d)return!1;var h=c.cross(u).y;n.push(h)}return n.forEach(function(e){0===e&&(i=!1)}),n.forEach(n[0]>0?function(e){e<0&&(i=!1)}:function(e){e>0&&(i=!1)}),i},i.distanceToSquared=function(e,t){var r=e.x-t.x,i=e.y-t.y,n=e.z-t.z;return r*r+i*i+n*n},i.isPointInPoly=function(e,t){for(var r=!1,i=-1,n=e.length,o=n-1;++i<n;o=i)(e[i].z<=t.z&&t.z<e[o].z||e[o].z<=t.z&&t.z<e[i].z)&&t.x<(e[o].x-e[i].x)*(t.z-e[i].z)/(e[o].z-e[i].z)+e[i].x&&(r=!r);return r},i.isVectorInPolygon=function(e,t,r){var i=1e5,n=-1e5,o=[];return t.vertexIds.forEach(function(e){i=Math.min(r[e].y,i),n=Math.max(r[e].y,n),o.push(r[e])}),!!(e.y<n+.5&&e.y>i-.5&&this.isPointInPoly(o,e))},i.triarea2=function(e,t,r){return(r.x-e.x)*(t.z-e.z)-(t.x-e.x)*(r.z-e.z)},i.vequal=function(e,t){return this.distanceToSquared(e,t)<1e-5};var n=function(e){this.content=[],this.scoreFunction=e};n.prototype.push=function(e){this.content.push(e),this.sinkDown(this.content.length-1)},n.prototype.pop=function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.bubbleUp(0)),e},n.prototype.remove=function(e){var t=this.content.indexOf(e),r=this.content.pop();t!==this.content.length-1&&(this.content[t]=r,this.scoreFunction(r)<this.scoreFunction(e)?this.sinkDown(t):this.bubbleUp(t))},n.prototype.size=function(){return this.content.length},n.prototype.rescoreElement=function(e){this.sinkDown(this.content.indexOf(e))},n.prototype.sinkDown=function(e){for(var t=this.content[e];e>0;){var r=(e+1>>1)-1,i=this.content[r];if(!(this.scoreFunction(t)<this.scoreFunction(i)))break;this.content[r]=t,this.content[e]=i,e=r}},n.prototype.bubbleUp=function(e){for(var t=this.content.length,r=this.content[e],i=this.scoreFunction(r);;){var n=e+1<<1,o=n-1,a=null,s=void 0;if(o<t&&(s=this.scoreFunction(this.content[o]))<i&&(a=o),n<t&&this.scoreFunction(this.content[n])<(null===a?i:s)&&(a=n),null===a)break;this.content[e]=this.content[a],this.content[a]=r,e=a}};var o=function(){};o.init=function(e){for(var t=0;t<e.length;t++){var r=e[t];r.f=0,r.g=0,r.h=0,r.cost=1,r.visited=!1,r.closed=!1,r.parent=null}},o.cleanUp=function(e){for(var t=0;t<e.length;t++){var r=e[t];delete r.f,delete r.g,delete r.h,delete r.cost,delete r.visited,delete r.closed,delete r.parent}},o.heap=function(){return new n(function(e){return e.f})},o.search=function(e,t,r){this.init(e);var i=this.heap();for(i.push(t);i.size()>0;){var n=i.pop();if(n===r){for(var o=n,a=[];o.parent;)a.push(o),o=o.parent;return this.cleanUp(a),a.reverse()}n.closed=!0;for(var s=this.neighbours(e,n),l=0,c=s.length;l<c;l++){var u=s[l];if(!u.closed){var d=n.g+u.cost,h=u.visited;if(!h||d<u.g){if(u.visited=!0,u.parent=n,!u.centroid||!r.centroid)throw new Error("Unexpected state");u.h=u.h||this.heuristic(u.centroid,r.centroid),u.g=d,u.f=u.g+u.h,h?i.rescoreElement(u):i.push(u)}}}}return[]},o.heuristic=function(e,t){return i.distanceToSquared(e,t)},o.neighbours=function(e,t){for(var r=[],i=0;i<t.neighbours.length;i++)r.push(e[t.neighbours[i]]);return r};var a=1,s=function(){};s.buildZone=function(e){var t=this,r=this._buildNavigationMesh(e),n={};r.vertices.forEach(function(e){e.x=i.roundNumber(e.x,2),e.y=i.roundNumber(e.y,2),e.z=i.roundNumber(e.z,2)}),n.vertices=r.vertices;var o=this._buildPolygonGroups(r);n.groups=[];var a=function(e,t){for(var r=0;r<e.length;r++)if(t===e[r])return r};return o.forEach(function(e){var r=[];e.forEach(function(n){var o=n.neighbours.map(function(t){return a(e,t)}),s=n.neighbours.map(function(e){return t._getSharedVerticesInOrder(n,e)});n.centroid.x=i.roundNumber(n.centroid.x,2),n.centroid.y=i.roundNumber(n.centroid.y,2),n.centroid.z=i.roundNumber(n.centroid.z,2),r.push({id:a(e,n),neighbours:o,vertexIds:n.vertexIds,centroid:n.centroid,portals:s})}),n.groups.push(r)}),n},s._buildNavigationMesh=function(e){return i.computeCentroids(e),e.mergeVertices(),this._buildPolygonsFromGeometry(e)},s._buildPolygonGroups=function(e){var t=[],r=0,i=function(e){e.neighbours.forEach(function(t){void 0===t.group&&(t.group=e.group,i(t))})};return e.polygons.forEach(function(e){void 0===e.group&&(e.group=r++,i(e)),t[e.group]||(t[e.group]=[]),t[e.group].push(e)}),t},s._buildPolygonNeighbours=function(e,t,r){var i=new Set,n=r.get(e.vertexIds[0]),o=r.get(e.vertexIds[1]),a=r.get(e.vertexIds[2]);n.forEach(function(e){(o.has(e)||a.has(e))&&i.add(t.polygons[e])}),o.forEach(function(e){a.has(e)&&i.add(t.polygons[e])}),e.neighbours=Array.from(i)},s._buildPolygonsFromGeometry=function(e){for(var t=this,r=[],i=e.vertices,n=e.faceVertexUvs,o=new Map,s=0;s<i.length;s++)o.set(s,new Set);e.faces.forEach(function(e){r.push({id:a++,vertexIds:[e.a,e.b,e.c],centroid:e.centroid,normal:e.normal,neighbours:[]}),o.get(e.a).add(r.length-1),o.get(e.b).add(r.length-1),o.get(e.c).add(r.length-1)});var l={polygons:r,vertices:i,faceVertexUvs:n};return r.forEach(function(e){t._buildPolygonNeighbours(e,l,o)}),l},s._getSharedVerticesInOrder=function(e,t){var r=e.vertexIds,i=t.vertexIds,n=new Set;if(r.forEach(function(e){i.includes(e)&&n.add(e)}),n.size<2)return[];n.has(r[0])&&n.has(r[r.length-1])&&r.push(r.shift()),n.has(i[0])&&n.has(i[i.length-1])&&i.push(i.shift());var o=[];return r.forEach(function(e){i.includes(e)&&o.push(e)}),o};var l=function(){this.portals=[]};l.prototype.push=function(e,t){void 0===t&&(t=e),this.portals.push({left:e,right:t})},l.prototype.stringPull=function(){var e,t,r,n=this.portals,o=[],a=0,s=0,l=0;t=n[0].left,r=n[0].right,o.push(e=n[0].left);for(var c=1;c<n.length;c++){var u=n[c].left,d=n[c].right;if(i.triarea2(e,r,d)<=0){if(!(i.vequal(e,r)||i.triarea2(e,t,d)>0)){o.push(t),t=e=t,r=e,s=a=s,l=a,c=a;continue}r=d,l=c}if(i.triarea2(e,t,u)>=0){if(!(i.vequal(e,t)||i.triarea2(e,r,u)<0)){o.push(r),t=e=r,r=e,s=a=l,l=a,c=a;continue}t=u,s=c}}return 0!==o.length&&i.vequal(o[o.length-1],n[n.length-1].left)||o.push(n[n.length-1].left),this.path=o,o};var c,u,d,h,f,p,m=function(){this.zones={}};m.createZone=function(e){return s.buildZone(e)},m.prototype.setZoneData=function(e,t){this.zones[e]=t},m.prototype.getGroup=function(e,t){if(!this.zones[e])return null;var r=null,n=Math.pow(50,2);return this.zones[e].groups.forEach(function(e,o){e.forEach(function(e){var a=i.distanceToSquared(e.centroid,t);a<n&&(r=o,n=a)})}),r},m.prototype.getRandomNode=function(e,t,r,n){if(!this.zones[e])return new THREE.Vector3;r=r||null,n=n||0;var o=[];return this.zones[e].groups[t].forEach(function(e){r&&n?i.distanceToSquared(r,e.centroid)<n*n&&o.push(e.centroid):o.push(e.centroid)}),i.sample(o)||new THREE.Vector3},m.prototype.getClosestNode=function(e,t,r,n){void 0===n&&(n=!1);var o=this.zones[t].vertices,a=null,s=1/0;return this.zones[t].groups[r].forEach(function(t){var r=i.distanceToSquared(t.centroid,e);r<s&&(!n||i.isVectorInPolygon(e,t,o))&&(a=t,s=r)}),a},m.prototype.findPath=function(e,t,r,i){var n=this.zones[r].groups[i],a=this.zones[r].vertices,s=this.getClosestNode(e,r,i),c=this.getClosestNode(t,r,i,!0);if(!s||!c)return null;var u=o.search(n,s,c),d=function(e,t){for(var r=0;r<e.neighbours.length;r++)if(e.neighbours[r]===t.id)return e.portals[r]},h=new l;h.push(e);for(var f=0;f<u.length;f++){var p=u[f+1];if(p){var m=d(u[f],p);h.push(a[m[0]],a[m[1]])}}h.push(t),h.stringPull();var v=h.path.map(function(e){return new THREE.Vector3(e.x,e.y,e.z)});return v.shift(),v},m.prototype.clampStep=(d=new THREE.Vector3,h=new THREE.Plane,f=new THREE.Triangle,p=new THREE.Vector3,function(e,t,r,i,n,o){var a=this.zones[i].vertices,s=this.zones[i].groups[n],l=[r],m={};m[r.id]=0,c=void 0,p.set(0,0,0),u=1/0,h.setFromCoplanarPoints(a[r.vertexIds[0]],a[r.vertexIds[1]],a[r.vertexIds[2]]),h.projectPoint(t,d),t.copy(d);for(var v=l.pop();v;v=l.pop()){f.set(a[v.vertexIds[0]],a[v.vertexIds[1]],a[v.vertexIds[2]]),f.closestPointToPoint(t,d),d.distanceToSquared(t)<u&&(c=v,p.copy(d),u=d.distanceToSquared(t));var g=m[v];if(!(g>2))for(var y=0;y<v.neighbours.length;y++){var b=s[v.neighbours[y]];b.id in m||(l.push(b),m[b.id]=g+1)}}return o.copy(p),c}),r.Pathfinding=m},{}],12:[function(e,t,r){"use strict";t.exports=AFRAME.registerComponent("checkpoint-controls",{schema:{enabled:{default:!0},mode:{default:"teleport",oneOf:["teleport","animate"]},animateSpeed:{default:3}},init:function(){this.active=!0,this.checkpoint=null,this.isNavMeshConstrained=!1,this.offset=new THREE.Vector3,this.position=new THREE.Vector3,this.targetPosition=new THREE.Vector3},play:function(){this.active=!0},pause:function(){this.active=!1},setCheckpoint:function(e){var t=this.el;this.active&&this.checkpoint!==e&&(this.checkpoint&&t.emit("navigation-end",{checkpoint:this.checkpoint}),this.checkpoint=e,this.sync(),this.position.distanceTo(this.targetPosition)<.1?this.checkpoint=null:(t.emit("navigation-start",{checkpoint:e}),"teleport"===this.data.mode&&(this.el.setAttribute("position",this.targetPosition),this.checkpoint=null,t.emit("navigation-end",{checkpoint:e}),t.components["movement-controls"].updateNavLocation())))},isVelocityActive:function(){return!(!this.active||!this.checkpoint)},getVelocity:function(){if(this.active){var e=this.data,t=this.offset,r=this.position,i=this.targetPosition,n=this.checkpoint;return this.sync(),r.distanceTo(i)<.1?(this.checkpoint=null,this.el.emit("navigation-end",{checkpoint:n}),t.set(0,0,0)):(t.setLength(e.animateSpeed),t)}},sync:function(){var e=this.offset,t=this.position,r=this.targetPosition;t.copy(this.el.getAttribute("position")),this.checkpoint.object3D.getWorldPosition(r),r.add(this.checkpoint.components.checkpoint.getOffset()),e.copy(r).sub(t)}})},{}],13:[function(e,t,r){"use strict";var i=e("../../lib/GamepadButton"),n=e("../../lib/GamepadButtonEvent");t.exports=AFRAME.registerComponent("gamepad-controls",{GamepadButton:i,schema:{controller:{default:0,oneOf:[0,1,2,3]},enabled:{default:!0},debug:{default:!1},camera:{default:"[camera]",type:"selector"},rotationSensitivity:{default:2}},init:function(){var e=this.el.sceneEl;this.prevTime=window.performance.now(),this.buttons={};var t=this.el.object3D.rotation;this.pitch=new THREE.Object3D,this.pitch.rotation.x=THREE.Math.degToRad(t.x),this.yaw=new THREE.Object3D,this.yaw.position.y=10,this.yaw.rotation.y=THREE.Math.degToRad(t.y),this.yaw.add(this.pitch),e.addBehavior(this)},update:function(){this.tick()},tick:function(e,t){this.updateButtonState(),this.updateRotation(t)},remove:function(){},isVelocityActive:function(){if(!this.data.enabled||!this.isConnected())return!1;var e=this.getDpad(),t=this.getJoystick(0),r=e.x||t.x,i=e.y||t.y;return Math.abs(r)>.2||Math.abs(i)>.2},getVelocityDelta:function(){var e=this.getDpad(),t=this.getJoystick(0),r=e.x||t.x,i=e.y||t.y,n=new THREE.Vector3;return Math.abs(r)>.2&&(n.x+=r),Math.abs(i)>.2&&(n.z+=i),n},isRotationActive:function(){if(!this.data.enabled||!this.isConnected())return!1;var e=this.getJoystick(1);return Math.abs(e.x)>.2||Math.abs(e.y)>.2},updateRotation:function(e){if(this.isRotationActive()){var t=this.data,r=this.yaw,i=this.pitch,n=t.camera.components["look-controls"],o=n&&n.pitchObject&&n.yawObject;o&&(i.rotation.copy(n.pitchObject.rotation),r.rotation.copy(n.yawObject.rotation));var a=this.getJoystick(1);Math.abs(a.x)<=.2&&(a.x=0),Math.abs(a.y)<=.2&&(a.y=0),a.multiplyScalar(t.rotationSensitivity*e/1e3),r.rotation.y-=a.x,i.rotation.x-=a.y,i.rotation.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,i.rotation.x)),t.camera.object3D.rotation.set(i.rotation.x,r.rotation.y,0),o&&(n.pitchObject.rotation.copy(i.rotation),n.yawObject.rotation.copy(r.rotation))}},updateButtonState:function(){var e=this.getGamepad();if(this.data.enabled&&e)for(var t=0;t<e.buttons.length;t++)e.buttons[t].pressed&&!this.buttons[t]?this.emit(new n("gamepadbuttondown",t,e.buttons[t])):!e.buttons[t].pressed&&this.buttons[t]&&this.emit(new n("gamepadbuttonup",t,e.buttons[t])),this.buttons[t]=e.buttons[t].pressed;else Object.keys(this.buttons)&&(this.buttons={})},emit:function(e){this.el.emit(e.type,e),this.el.emit(e.type+":"+e.index,new n(e.type,e.index,e))},getGamepad:function(){var e=navigator.getGamepads&&navigator.getGamepads()[this.data.controller],t=this.el.sceneEl.components["proxy-controls"];return t&&t.isConnected()&&t.getGamepad(this.data.controller)||e},getButton:function(e){return this.getGamepad().buttons[e]},getAxis:function(e){return this.getGamepad().axes[e]},getJoystick:function(e){var t=this.getGamepad();switch(e){case 0:return new THREE.Vector2(t.axes[0],t.axes[1]);case 1:return new THREE.Vector2(t.axes[2],t.axes[3]);default:throw new Error('Unexpected joystick index "%d".',e)}},getDpad:function(){var e=this.getGamepad();return e.buttons[i.DPAD_RIGHT]?new THREE.Vector2((e.buttons[i.DPAD_RIGHT].pressed?1:0)+(e.buttons[i.DPAD_LEFT].pressed?-1:0),(e.buttons[i.DPAD_UP].pressed?-1:0)+(e.buttons[i.DPAD_DOWN].pressed?1:0)):new THREE.Vector2},isConnected:function(){var e=this.getGamepad();return!(!e||!e.connected)},getID:function(){return this.getGamepad().id}})},{"../../lib/GamepadButton":5,"../../lib/GamepadButtonEvent":6}],14:[function(e,t,r){"use strict";e("./checkpoint-controls"),e("./gamepad-controls"),e("./keyboard-controls"),e("./touch-controls"),e("./movement-controls"),e("./trackpad-controls")},{"./checkpoint-controls":12,"./gamepad-controls":13,"./keyboard-controls":15,"./movement-controls":16,"./touch-controls":17,"./trackpad-controls":18}],15:[function(e,t,r){"use strict";e("../../lib/keyboard.polyfill");var i=window.KeyboardEvent;t.exports=AFRAME.registerComponent("keyboard-controls",{schema:{enabled:{default:!0},debug:{default:!1}},init:function(){this.dVelocity=new THREE.Vector3,this.localKeys={},this.listeners={keydown:this.onKeyDown.bind(this),keyup:this.onKeyUp.bind(this),blur:this.onBlur.bind(this)},this.attachEventListeners()},isVelocityActive:function(){return this.data.enabled&&!!Object.keys(this.getKeys()).length},getVelocityDelta:function(){var e=this.data,t=this.getKeys();return this.dVelocity.set(0,0,0),e.enabled&&((t.KeyW||t.ArrowUp)&&(this.dVelocity.z-=1),(t.KeyA||t.ArrowLeft)&&(this.dVelocity.x-=1),(t.KeyS||t.ArrowDown)&&(this.dVelocity.z+=1),(t.KeyD||t.ArrowRight)&&(this.dVelocity.x+=1)),this.dVelocity.clone()},play:function(){this.attachEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.pause()},attachEventListeners:function(){window.addEventListener("keydown",this.listeners.keydown,!1),window.addEventListener("keyup",this.listeners.keyup,!1),window.addEventListener("blur",this.listeners.blur,!1)},removeEventListeners:function(){window.removeEventListener("keydown",this.listeners.keydown),window.removeEventListener("keyup",this.listeners.keyup),window.removeEventListener("blur",this.listeners.blur)},onKeyDown:function(e){AFRAME.utils.shouldCaptureKeyEvent(e)&&(this.localKeys[e.code]=!0,this.emit(e))},onKeyUp:function(e){AFRAME.utils.shouldCaptureKeyEvent(e)&&(delete this.localKeys[e.code],this.emit(e))},onBlur:function(){for(var e in this.localKeys)this.localKeys.hasOwnProperty(e)&&delete this.localKeys[e]},emit:function(e){"__keyboard-controls-proxy"in e&&this.el.emit(e.type,e),this.el.emit(e.type+":"+e.code,new i(e.type,e)),this.data.debug&&console.log(e.type+":"+e.code)},isPressed:function(e){return e in this.getKeys()},getKeys:function(){return this.isProxied()?this.el.sceneEl.components["proxy-controls"].getKeyboard():this.localKeys},isProxied:function(){var e=this.el.sceneEl.components["proxy-controls"];return e&&e.isConnected()}})},{"../../lib/keyboard.polyfill":10}],16:[function(e,t,r){"use strict";var i,n,o,a,s;t.exports=AFRAME.registerComponent("movement-controls",{dependencies:["rotation"],schema:{enabled:{default:!0},controls:{default:["gamepad","trackpad","keyboard","touch"]},speed:{default:.3,min:0},fly:{default:!1},constrainToNavMesh:{default:!1},camera:{default:"[movement-controls] [camera]",type:"selector"}},init:function(){var e=this.el;this.velocityCtrl=null,this.velocity=new THREE.Vector3,this.heading=new THREE.Quaternion,this.navGroup=null,this.navNode=null,e.sceneEl.hasLoaded?this.injectControls():e.sceneEl.addEventListener("loaded",this.injectControls.bind(this))},update:function(e){var t=this.el,r=this.data,i=t.sceneEl.systems.nav;t.sceneEl.hasLoaded&&this.injectControls(),i&&r.constrainToNavMesh!==e.constrainToNavMesh&&(r.constrainToNavMesh?i.addAgent(this):i.removeAgent(this))},injectControls:function(){for(var e,t=this.data,r=0;r<t.controls.length;r++)e=t.controls[r]+"-controls",this.el.components[e]||this.el.setAttribute(e,"")},updateNavLocation:function(){this.navGroup=null,this.navNode=null},tick:(o=new THREE.Vector3,a=new THREE.Vector3,s=new THREE.Vector3,function(e,t){if(t){var r=this.el,i=this.data;if(i.enabled){this.updateVelocityCtrl();var n=this.velocityCtrl,l=this.velocity;if(n)if(t/1e3>.2?l.set(0,0,0):this.updateVelocity(t),i.constrainToNavMesh&&!1!==n.isNavMeshConstrained){if(l.lengthSq()<1e-5)return;o.copy(r.object3D.position),a.copy(l).multiplyScalar(t/1e3).add(o);var c=r.sceneEl.systems.nav;this.navGroup=null===this.navGroup?c.getGroup(o):this.navGroup,this.navNode=this.navNode||c.getNode(o,this.navGroup),this.navNode=c.clampStep(o,a,this.navGroup,this.navNode,s),r.object3D.position.copy(s)}else r.hasAttribute("velocity")?r.setAttribute("velocity",l):(r.object3D.position.x+=l.x*t/1e3,r.object3D.position.y+=l.y*t/1e3,r.object3D.position.z+=l.z*t/1e3)}}}),updateVelocityCtrl:function(){var e=this.data;if(e.enabled){for(var t=0,r=e.controls.length;t<r;t++){var i=this.el.components[e.controls[t]+"-controls"];if(i&&i.isVelocityActive())return void(this.velocityCtrl=i)}this.velocityCtrl=null}},updateVelocity:(i=new THREE.Vector2,n=new THREE.Quaternion,function(e){var t=void 0,r=this.el,o=this.velocityCtrl,a=this.velocity,s=this.data;if(o){if(!o.getVelocityDelta){if(o.getVelocity)return void a.copy(o.getVelocity());if(o.getPositionDelta)return void a.copy(o.getPositionDelta(e).multiplyScalar(1e3/e));throw new Error("Incompatible movement controls: ",o)}t=o.getVelocityDelta(e)}if(r.hasAttribute("velocity")&&!s.constrainToNavMesh&&a.copy(this.el.getAttribute("velocity")),t&&s.enabled){var l=s.camera;n.copy(l.object3D.quaternion),n.premultiply(r.object3D.quaternion),t.applyQuaternion(n);var c=t.length();s.fly?(a.copy(t),a.multiplyScalar(16.66667*this.data.speed)):(i.set(t.x,t.z),i.setLength(c*this.data.speed*16.66667),a.x=i.x,a.z=i.y)}})})},{}],17:[function(e,t,r){"use strict";t.exports=AFRAME.registerComponent("touch-controls",{schema:{enabled:{default:!0},reverseEnabled:{default:!0}},init:function(){this.dVelocity=new THREE.Vector3,this.bindMethods(),this.direction=0},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){var e=this.el.sceneEl,t=e.canvas;t?(t.addEventListener("touchstart",this.onTouchStart),t.addEventListener("touchend",this.onTouchEnd)):e.addEventListener("render-target-loaded",this.addEventListeners.bind(this))},removeEventListeners:function(){var e=this.el.sceneEl&&this.el.sceneEl.canvas;e&&(e.removeEventListener("touchstart",this.onTouchStart),e.removeEventListener("touchend",this.onTouchEnd))},isVelocityActive:function(){return this.data.enabled&&!!this.direction},getVelocityDelta:function(){return this.dVelocity.z=this.direction,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this)},onTouchStart:function(e){this.direction=-1,this.data.reverseEnabled&&2===e.touches.length&&(this.direction=1),e.preventDefault()},onTouchEnd:function(e){this.direction=0,e.preventDefault()}})},{}],18:[function(e,t,r){"use strict";t.exports=AFRAME.registerComponent("trackpad-controls",{schema:{enabled:{default:!0},enableNegX:{default:!0},enablePosX:{default:!0},enableNegZ:{default:!0},enablePosZ:{default:!0},mode:{default:"touch",oneOf:["swipe","touch","press"]}},init:function(){this.dVelocity=new THREE.Vector3,this.zVel=0,this.xVel=0,this.bindMethods()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){var e=this.data,t=this.el.sceneEl;switch(t.addEventListener("axismove",this.onAxisMove),e.mode){case"swipe":case"touch":t.addEventListener("trackpadtouchstart",this.onTouchStart),t.addEventListener("trackpadtouchend",this.onTouchEnd);break;case"press":t.addEventListener("trackpaddown",this.onTouchStart),t.addEventListener("trackpadup",this.onTouchEnd)}},removeEventListeners:function(){var e=this.el.sceneEl;e.removeEventListener("axismove",this.onAxisMove),e.removeEventListener("trackpadtouchstart",this.onTouchStart),e.removeEventListener("trackpadtouchend",this.onTouchEnd),e.removeEventListener("trackpaddown",this.onTouchStart),e.removeEventListener("trackpadup",this.onTouchEnd)},isVelocityActive:function(){return this.data.enabled&&this.isMoving},getVelocityDelta:function(){return this.dVelocity.z=this.isMoving?-this.zVel:1,this.dVelocity.x=this.isMoving?this.xVel:1,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onAxisMove=this.onAxisMove.bind(this)},onTouchStart:function(e){switch(this.data.mode){case"swipe":this.canRecordAxis=!0,this.startingAxisData=[];break;case"touch":case"press":this.isMoving=!0}e.preventDefault()},onTouchEnd:function(e){"swipe"==this.data.mode&&(this.startingAxisData=[]),this.isMoving=!1,e.preventDefault()},onAxisMove:function(e){switch(this.data.mode){case"swipe":return this.handleSwipeAxis(e);case"touch":case"press":return this.handleTouchAxis(e)}},handleSwipeAxis:function(e){var t=this.data,r=e.detail.axis;if(0===this.startingAxisData.length&&this.canRecordAxis&&(this.canRecordAxis=!1,this.startingAxisData[0]=r[0],this.startingAxisData[1]=r[1]),this.startingAxisData.length>0){var i=0,n=0;t.enableNegX&&r[0]<this.startingAxisData[0]&&(i=-1),t.enablePosX&&r[0]>this.startingAxisData[0]&&(i=1),t.enablePosZ&&r[1]>this.startingAxisData[1]&&(n=-1),t.enableNegZ&&r[1]<this.startingAxisData[1]&&(n=1);var o=Math.abs(this.startingAxisData[1]-r[1]);Math.abs(this.startingAxisData[0]-r[0])>o?(this.zVel=0,this.xVel=i,this.isMoving=!0):(this.xVel=0,this.zVel=n,this.isMoving=!0)}},handleTouchAxis:function(e){var t=this.data,r=e.detail.axis,i=0,n=0;t.enableNegX&&r[0]<0&&(i=-1),t.enablePosX&&r[0]>0&&(i=1),t.enablePosZ&&r[1]>0&&(n=-1),t.enableNegZ&&r[1]<0&&(n=1),Math.abs(r[0])>Math.abs(r[1])?(this.zVel=0,this.xVel=i):(this.xVel=0,this.zVel=n)}})},{}],19:[function(e,t,r){"use strict";var i={once:THREE.LoopOnce,repeat:THREE.LoopRepeat,pingpong:THREE.LoopPingPong};function n(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")}t.exports=AFRAME.registerComponent("animation-mixer",{schema:{clip:{default:"*"},duration:{default:0},clampWhenFinished:{default:!1,type:"boolean"},crossFadeDuration:{default:0},loop:{default:"repeat",oneOf:Object.keys(i)},repetitions:{default:1/0,min:0},timeScale:{default:1}},init:function(){var e=this;this.model=null,this.mixer=null,this.activeActions=[];var t=this.el.getObject3D("mesh");t?this.load(t):this.el.addEventListener("model-loaded",function(t){e.load(t.detail.model)})},load:function(e){if(this.el==e.el){var t=this.el;this.model=e,this.mixer=new THREE.AnimationMixer(e),this.mixer.addEventListener("loop",function(e){t.emit("animation-loop",{action:e.action,loopDelta:e.loopDelta})}),this.mixer.addEventListener("finished",function(e){t.emit("animation-finished",{action:e.action,direction:e.direction})}),this.data.clip&&this.update({})}},remove:function(){this.mixer&&this.mixer.stopAllAction()},update:function(e){if(e){var t=this.data,r=AFRAME.utils.diff(t,e);if("clip"in r)return this.stopAction(),void(t.clip&&this.playAction());this.activeActions.forEach(function(e){"duration"in r&&t.duration&&e.setDuration(t.duration),"clampWhenFinished"in r&&(e.clampWhenFinished=t.clampWhenFinished),("loop"in r||"repetitions"in r)&&e.setLoop(i[t.loop],t.repetitions),"timeScale"in r&&e.setEffectiveTimeScale(t.timeScale)})}},stopAction:function(){for(var e=this.data,t=0;t<this.activeActions.length;t++)e.crossFadeDuration?this.activeActions[t].fadeOut(e.crossFadeDuration):this.activeActions[t].stop();this.activeActions.length=0},playAction:function(){if(this.mixer){var e=this.model,t=this.data,r=e.animations||(e.geometry||{}).animations||[];if(r.length)for(var o,a,s=(o=t.clip,new RegExp("^"+o.split(/\*+/).map(n).join(".*")+"$")),l=0;a=r[l];l++)if(a.name.match(s)){var c=this.mixer.clipAction(a,e);c.enabled=!0,c.clampWhenFinished=t.clampWhenFinished,t.duration&&c.setDuration(t.duration),1!==t.timeScale&&c.setEffectiveTimeScale(t.timeScale),c.setLoop(i[t.loop],t.repetitions).fadeIn(t.crossFadeDuration).play(),this.activeActions.push(c)}}},tick:function(e,t){this.mixer&&!isNaN(t)&&(this.mixer.update(t/1e3),this.model.animationSlices&&this.model.animationSlices[0].index&&this.model.animationSlices[this.model.animationSlices[0].index]&&(this.mixer._actions[0].time>this.model.animationSlices[this.model.animationSlices[0].index].timeEnd||this.mixer._actions[0].time<this.model.animationSlices[this.model.animationSlices[0].index].timeStart)&&(this.mixer._actions[0].time=this.model.animationSlices[this.model.animationSlices[0].index].timeStart))}})},{}],20:[function(e,t,r){"use strict";THREE.ColladaLoader=e("../../lib/ColladaLoader"),t.exports.Component=AFRAME.registerComponent("collada-model-legacy",{schema:{type:"asset"},init:function(){this.model=null,this.loader=new THREE.ColladaLoader},update:function(){var e=this,t=this.el,r=this.data,i=this.el.sceneEl.systems.renderer;r&&(this.remove(),this.loader.load(r,function(r){e.model=r.scene,e.model.traverse(function(e){if(e.isMesh){var t=e.material;t.color&&i.applyColorCorrection(t.color),t.map&&i.applyColorCorrection(t.map),t.emissive&&i.applyColorCorrection(t.emissive),t.emissiveMap&&i.applyColorCorrection(t.emissiveMap)}}),t.setObject3D("mesh",e.model),t.emit("model-loaded",{format:"collada",model:e.model})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},{"../../lib/ColladaLoader":3}],21:[function(e,t,r){"use strict";THREE.FBXLoader=e("../../lib/FBXLoader"),t.exports=AFRAME.registerComponent("fbx-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){var e=this.data;if(e.src){this.remove();var t=new THREE.FBXLoader;e.crossorigin&&t.setCrossOrigin(e.crossorigin),t.load(e.src,this.load.bind(this))}},load:function(e){let t=new THREE.Vector3(1,1,1);!function(e,t){if(e["LastSaved|ApplicationName"])switch(e["LastSaved|ApplicationName"].value){case"3ds Max":e.OriginalUnitScaleFactor?t.multiplyScalar(e.OriginalUnitScaleFactor):t.multiplyScalar(100);break;case"Maya":e.OriginalUnitScaleFactor&&t.multiplyScalar(e.OriginalUnitScaleFactor)}}(e,t),e.scale.copy(t.multiplyScalar(.01)),this.model=e,this.el.setObject3D("mesh",e),this.el.emit("model-loaded",{format:"fbx",model:e})},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},{"../../lib/FBXLoader":4}],22:[function(e,t,r){"use strict";var i,n=e("../../lib/fetch-script")(),o=(i=void 0,function(){return i=i||n("https://cdn.jsdelivr.net/gh/mrdoob/three.js@r86/examples/js/loaders/GLTFLoader.js")});t.exports=AFRAME.registerComponent("gltf-model-legacy",{schema:{type:"model"},init:function(){var e=this;this.model=null,this.loader=null,this.loaderPromise=o().then(function(){e.loader=new THREE.GLTFLoader,e.loader.setCrossOrigin("Anonymous")})},update:function(){var e=this,t=this,r=this.el,i=this.data;i&&(this.remove(),this.loaderPromise.then(function(){e.loader.load(i,function(e){t.model=e.scene,t.model.animations=e.animations,r.setObject3D("mesh",t.model),r.emit("model-loaded",{format:"gltf",model:t.model})})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},{"../../lib/fetch-script":8}],23:[function(e,t,r){"use strict";e("./animation-mixer"),e("./collada-model-legacy"),e("./fbx-model"),e("./gltf-model-legacy"),e("./object-model")},{"./animation-mixer":19,"./collada-model-legacy":20,"./fbx-model":21,"./gltf-model-legacy":22,"./object-model":24}],24:[function(e,t,r){"use strict";t.exports=AFRAME.registerComponent("object-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){var e=this,t=void 0,r=this.data;r.src&&(this.remove(),t=new THREE.ObjectLoader,r.crossorigin&&t.setCrossOrigin(r.crossorigin),t.load(r.src,function(t){t.traverse(function(e){e instanceof THREE.SkinnedMesh&&e.material&&(e.material.skinning=!!(e.geometry&&e.geometry.bones||[]).length)}),e.load(t)}))},load:function(e){this.model=e,this.el.setObject3D("mesh",e),this.el.emit("model-loaded",{format:"json",model:e})},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},{}],25:[function(e,t,r){"use strict";t.exports=AFRAME.registerComponent("checkpoint",{schema:{offset:{default:{x:0,y:0,z:0},type:"vec3"}},init:function(){this.active=!1,this.targetEl=null,this.fire=this.fire.bind(this),this.offset=new THREE.Vector3},update:function(){this.offset.copy(this.data.offset)},play:function(){this.el.addEventListener("click",this.fire)},pause:function(){this.el.removeEventListener("click",this.fire)},remove:function(){this.pause()},fire:function(){var e=this.el.sceneEl.querySelector("[checkpoint-controls]");if(!e)throw new Error("No `checkpoint-controls` component found.");e.components["checkpoint-controls"].setCheckpoint(this.el)},getOffset:function(){return this.offset.copy(this.data.offset)}})},{}],26:[function(e,t,r){"use strict";function i(e,t,r,i){e&&(t=t||[],e.traverse(function(e){var n;e.isMesh&&((n=e.material)?Array.isArray(n)?n:n.materials?n.materials:[n]:[]).forEach(function(e){(!e||"envMap"in e)&&(t.length&&-1===t.indexOf(e.name)||(e.envMap=r,e.reflectivity=i,e.needsUpdate=!0))})}))}t.exports=AFRAME.registerComponent("cube-env-map",{multiple:!0,schema:{path:{default:""},extension:{default:"jpg",oneOf:["jpg","png"]},format:{default:"RGBFormat",oneOf:["RGBFormat","RGBAFormat"]},enableBackground:{default:!1},reflectivity:{default:1,min:0,max:1},materials:{default:[]}},init:function(){var e=this,t=this.data;this.texture=(new THREE.CubeTextureLoader).load([t.path+"posx."+t.extension,t.path+"negx."+t.extension,t.path+"posy."+t.extension,t.path+"negy."+t.extension,t.path+"posz."+t.extension,t.path+"negz."+t.extension]),this.texture.format=THREE[t.format],this.object3dsetHandler=function(){var t=e.el.getObject3D("mesh"),r=e.data;i(t,r.materials,e.texture,r.reflectivity)},this.el.addEventListener("object3dset",this.object3dsetHandler)},update:function(e){var t=this.data,r=this.el.getObject3D("mesh"),n=[],o=[];if(t.materials.length&&(e.materials?(n=t.materials.filter(function(t){return!e.materials.includes(t)}),o=e.materials.filter(function(e){return!t.materials.includes(e)})):n=t.materials),n.length&&i(r,n,this.texture,t.reflectivity),o.length&&i(r,o,null,1),e.materials&&t.reflectivity!==e.reflectivity){var a=t.materials.filter(function(t){return e.materials.includes(t)});a.length&&i(r,a,this.texture,t.reflectivity)}this.data.enableBackground&&!e.enableBackground?this.setBackground(this.texture):!this.data.enableBackground&&e.enableBackground&&this.setBackground(null)},remove:function(){this.el.removeEventListener("object3dset",this.object3dsetHandler);var e=this.el.getObject3D("mesh"),t=this.data;i(e,t.materials,null,1),t.enableBackground&&this.setBackground(null)},setBackground:function(e){this.el.sceneEl.object3D.background=e}})},{}],27:[function(e,t,r){"use strict";t.exports=AFRAME.registerComponent("grab",{init:function(){this.system=this.el.sceneEl.systems.physics,this.GRABBED_STATE="grabbed",this.grabbing=!1,this.hitEl=null,this.physics=this.el.sceneEl.systems.physics,this.constraint=null,this.onHit=this.onHit.bind(this),this.onGripOpen=this.onGripOpen.bind(this),this.onGripClose=this.onGripClose.bind(this)},play:function(){var e=this.el;e.addEventListener("hit",this.onHit),e.addEventListener("gripdown",this.onGripClose),e.addEventListener("gripup",this.onGripOpen),e.addEventListener("trackpaddown",this.onGripClose),e.addEventListener("trackpadup",this.onGripOpen),e.addEventListener("triggerdown",this.onGripClose),e.addEventListener("triggerup",this.onGripOpen)},pause:function(){var e=this.el;e.removeEventListener("hit",this.onHit),e.removeEventListener("gripdown",this.onGripClose),e.removeEventListener("gripup",this.onGripOpen),e.removeEventListener("trackpaddown",this.onGripClose),e.removeEventListener("trackpadup",this.onGripOpen),e.removeEventListener("triggerdown",this.onGripClose),e.removeEventListener("triggerup",this.onGripOpen)},onGripClose:function(){this.grabbing=!0},onGripOpen:function(){var e=this.hitEl;this.grabbing=!1,e&&(e.removeState(this.GRABBED_STATE),this.hitEl=void 0,this.system.removeConstraint(this.constraint),this.constraint=null)},onHit:function(e){var t=e.detail.el;t&&!t.is(this.GRABBED_STATE)&&this.grabbing&&!this.hitEl&&(t.addState(this.GRABBED_STATE),this.hitEl=t,this.constraint=new CANNON.LockConstraint(this.el.body,t.body),this.system.addConstraint(this.constraint))}})},{}],28:[function(e,t,r){"use strict";e("./checkpoint"),e("./cube-env-map"),e("./grab"),e("./jump-ability"),e("./kinematic-body"),e("./mesh-smooth"),e("./normal-material"),e("./sphere-collider")},{"./checkpoint":25,"./cube-env-map":26,"./grab":27,"./jump-ability":29,"./kinematic-body":30,"./mesh-smooth":31,"./normal-material":32,"./sphere-collider":33}],29:[function(e,t,r){"use strict";t.exports=AFRAME.registerComponent("jump-ability",{dependencies:["velocity"],schema:{on:{default:"keydown:Space gamepadbuttondown:0"},playerHeight:{default:1.764},maxJumps:{default:1},distance:{default:5},debug:{default:!1}},init:function(){this.velocity=0,this.numJumps=0;var e=this.beginJump.bind(this),t=this.data.on.split(" ");this.bindings={};for(var r=0;r<t.length;r++)this.bindings[t[r]]=e,this.el.addEventListener(t[r],e);this.bindings.collide=this.onCollide.bind(this),this.el.addEventListener("collide",this.bindings.collide)},remove:function(){for(var e in this.bindings)this.bindings.hasOwnProperty(e)&&(this.el.removeEventListener(e,this.bindings[e]),delete this.bindings[e]);this.el.removeEventListener("collide",this.bindings.collide),delete this.bindings.collide},beginJump:function(){if(this.numJumps<this.data.maxJumps){var e=this.data,t=Math.sqrt(-2*e.distance*-24.8),r=this.el.getAttribute("velocity");this.el.setAttribute("velocity",{x:r.x,y:t,z:r.z}),this.numJumps++,this.el.emit("jumpstart")}},onCollide:function(){this.numJumps>0&&this.el.emit("jumpend"),this.numJumps=0}})},{}],30:[function(e,t,r){"use strict";var i,n,o,a;t.exports=AFRAME.registerComponent("kinematic-body",{dependencies:["velocity"],schema:{mass:{default:5},radius:{default:1.3},linearDamping:{default:.05},enableSlopes:{default:!0},enableJumps:{default:!1}},init:function(){this.system=this.el.sceneEl.systems.physics,this.system.addComponent(this);var e=this.el,t=this.data,r=(new CANNON.Vec3).copy(e.object3D.getWorldPosition(new THREE.Vector3));this.body=new CANNON.Body({material:this.system.getMaterial("staticMaterial"),position:r,mass:t.mass,linearDamping:t.linearDamping,fixedRotation:!0}),this.body.addShape(new CANNON.Sphere(t.radius),new CANNON.Vec3(0,t.radius,0)),this.body.el=this.el,this.el.body=this.body,this.system.addBody(this.body),e.hasAttribute("wasd-controls")&&console.warn("[kinematic-body] Not compatible with wasd-controls, use movement-controls.")},remove:function(){this.system.removeBody(this.body),this.system.removeComponent(this),delete this.el.body},beforeStep:function(e,t){if(t){var r=this.el,i=this.data,n=this.body;i.enableJumps||n.velocity.set(0,0,0),n.position.copy(r.getAttribute("position"))}},step:(i=new THREE.Vector3,n=new THREE.Vector3,o=new THREE.Vector3,a=new THREE.Vector3,function(e,t){if(t){var r=this.body,s=this.data,l=void 0,c=-1/0,u=void 0,d=this.system.getContacts();t=Math.min(t,1e3*this.system.data.maxInterval),a.set(0,0,0),i.copy(this.el.getAttribute("velocity")),r.velocity.copy(i);for(var h,f=0;h=d[f];f++)if(h.enabled){if(r.id===h.bi.id)h.ni.negate(o);else{if(r.id!==h.bj.id)continue;o.copy(h.ni)}r.velocity.dot(o)<-1e-6&&o.y<=.5?i.projectOnPlane(o):o.y>.5&&(l=r.id===h.bi.id?Math.abs(h.rj.y+h.bj.position.y):Math.abs(h.ri.y+h.bi.position.y))>c&&(c=l,a.copy(o),u=r.id===h.bi.id?h.bj:h.bi)}n.copy(i).normalize(),u&&(!s.enableJumps||n.y<.5)?(s.enableSlopes?a.y<1-1e-6&&a.copy(this.raycastToGround(u,a)):a.set(0,1,0),i.projectOnPlane(a)):this.system.driver.world&&i.add(this.system.driver.world.gravity.scale(4*t/1e3)),r.velocity.copy(i),this.el.setAttribute("velocity",r.velocity),this.el.setAttribute("position",r.position)}}),raycastToGround:function(e,t){var r,i=void 0,n=this.body.position,o=this.body.position.clone();return(i=new CANNON.Ray(n,o))._updateDirection(),i.intersectBody(e),i.hasHit?(r=i.result.hitNormalWorld,Math.abs(r.y)>Math.abs(t.y)?r:t):t}})},{}],31:[function(e,t,r){"use strict";t.exports=AFRAME.registerComponent("mesh-smooth",{init:function(){this.el.addEventListener("model-loaded",function(e){e.detail.model.traverse(function(e){e.isMesh&&e.geometry.computeVertexNormals()})})}})},{}],32:[function(e,t,r){"use strict";t.exports=AFRAME.registerComponent("normal-material",{init:function(){this.material=new THREE.MeshNormalMaterial({flatShading:!0}),this.applyMaterial=this.applyMaterial.bind(this),this.el.addEventListener("object3dset",this.applyMaterial)},remove:function(){this.el.removeEventListener("object3dset",this.applyMaterial)},applyMaterial:function(){var e=this;this.el.object3D.traverse(function(t){t.isMesh&&(t.material=e.material)})}})},{}],33:[function(e,t,r){"use strict";var i,n,o,a,s,l;t.exports=AFRAME.registerComponent("sphere-collider",{schema:{objects:{default:""},state:{default:"collided"},radius:{default:.05},watch:{default:!0}},init:function(){this.observer=null,this.els=[],this.collisions=[],this.handleHit=this.handleHit.bind(this),this.handleHitEnd=this.handleHitEnd.bind(this)},remove:function(){this.pause()},play:function(){var e=this.el.sceneEl;this.data.watch&&(this.observer=new MutationObserver(this.update.bind(this,null)),this.observer.observe(e,{childList:!0,subtree:!0}))},pause:function(){this.observer&&(this.observer.disconnect(),this.observer=null)},update:function(){var e=this.data,t=void 0;t=e.objects?this.el.sceneEl.querySelectorAll(e.objects):this.el.sceneEl.children,this.els=Array.prototype.slice.call(t)},tick:(i=new THREE.Vector3,n=new THREE.Vector3,o=new THREE.Vector3,a=new THREE.Vector3,s=new THREE.Box3,l=new Map,function(){var e,t=this.el,r=this.data,c=t.getObject3D("mesh"),u=[],d=void 0;c&&(l.clear(),t.object3D.getWorldPosition(i),t.object3D.getWorldScale(o),d=r.radius*(e=o,Math.max.apply(null,e.toArray())),this.els.forEach(function(e){var t,r,o,c;e.isEntity&&(r=e.getObject3D("mesh"))&&(s.setFromObject(r).getSize(a),c=Math.max(a.x,a.y,a.z)/2,t=Math.sqrt(2*c*c),s.getCenter(n),t&&(o=i.distanceTo(n))<t+d&&(u.push(e),l.set(e,o)))}),u.sort(function(e,t){return l.get(e)>l.get(t)?1:-1}).forEach(this.handleHit),0===u.length&&t.emit("hit",{el:null}),this.collisions.filter(function(e){return!l.has(e)}).forEach(this.handleHitEnd),this.collisions=u)}),handleHit:function(e){e.emit("hit"),e.addState(this.data.state),this.el.emit("hit",{el:e})},handleHitEnd:function(e){e.emit("hitend"),e.removeState(this.data.state),this.el.emit("hitend",{el:e})}})},{}],34:[function(e,t,r){"use strict";e("./nav-mesh"),e("./nav-agent"),e("./system")},{"./nav-agent":35,"./nav-mesh":36,"./system":37}],35:[function(e,t,r){"use strict";var i,n,o;t.exports=AFRAME.registerComponent("nav-agent",{schema:{destination:{type:"vec3"},active:{default:!1},speed:{default:2}},init:function(){this.system=this.el.sceneEl.systems.nav,this.system.addAgent(this),this.group=null,this.path=[],this.raycaster=new THREE.Raycaster},remove:function(){this.system.removeAgent(this)},update:function(){this.path.length=0},updateNavLocation:function(){this.group=null,this.path=[]},tick:(i=new THREE.Vector3,n=new THREE.Vector3,o=new THREE.Vector3,function(e,t){var r=this.el,a=this.data,s=this.raycaster,l=a.speed*t/1e3;if(a.active){if(!this.path.length){var c=this.el.object3D.position;this.group=this.group||this.system.getGroup(c),this.path=this.system.getPath(c,i.copy(a.destination),this.group)||[],r.emit("navigation-start")}if(!this.path.length)return console.warn("[nav] Unable to find path to %o.",a.destination),this.el.setAttribute("nav-agent",{active:!1}),void r.emit("navigation-end");var u=r.object3D.position,d=this.path[0];n.subVectors(d,u);var h=void 0;if(n.length()<l){if(this.path.shift(),!this.path.length)return this.el.setAttribute("nav-agent",{active:!1}),void r.emit("navigation-end");o.copy(u),h=this.path[0]}else o.copy(n.setLength(l)).add(u),h=d;h.y=u.y,r.object3D.lookAt(h),s.ray.origin.copy(o),s.ray.origin.y+=1.5,s.ray.direction.y=-1;var f=s.intersectObject(this.system.getNavMesh());f.length?(n.subVectors(f[0].point,u),u.add(n.setLength(l))):u.copy(o)}})})},{}],36:[function(e,t,r){"use strict";t.exports=AFRAME.registerComponent("nav-mesh",{init:function(){this.system=this.el.sceneEl.systems.nav,this.hasLoadedNavMesh=!1,this.el.addEventListener("object3dset",this.loadNavMesh.bind(this))},play:function(){this.hasLoadedNavMesh||this.loadNavMesh()},loadNavMesh:function(){var e=this.el.getObject3D("mesh"),t=this.el.sceneEl.object3D;if(e){var r=void 0;if(e.traverse(function(e){e.isMesh&&(r=e)}),r){var i=r.geometry.isBufferGeometry?(new THREE.Geometry).fromBufferGeometry(r.geometry):r.geometry.clone();t.updateMatrixWorld(),i.applyMatrix(r.matrixWorld),this.system.setNavMeshGeometry(i),this.hasLoadedNavMesh=!0}}}})},{}],37:[function(e,t,r){"use strict";var i=e("three-pathfinding").Pathfinding,n=new i,o="level";t.exports=AFRAME.registerSystem("nav",{init:function(){this.navMesh=null,this.agents=new Set},setNavMeshGeometry:function(e){this.navMesh=new THREE.Mesh(e),n.setZoneData(o,i.createZone(e)),Array.from(this.agents).forEach(function(e){return e.updateNavLocation()})},getNavMesh:function(){return this.navMesh},addAgent:function(e){this.agents.add(e)},removeAgent:function(e){this.agents.delete(e)},getPath:function(e,t,r){return this.navMesh?n.findPath(e,t,o,r):null},getGroup:function(e){return this.navMesh?n.getGroup(o,e):null},getNode:function(e,t){return this.navMesh?n.getClosestNode(e,o,t,!0):null},clampStep:function(e,t,r,i,a){return this.navMesh?i?n.clampStep(e,t,i,o,r,a):(a.copy(t),this.getNode(t,r)):(a.copy(t),null)}})},{"three-pathfinding":11}],38:[function(e,t,r){"use strict";t.exports=AFRAME.registerPrimitive("a-grid",{defaultComponents:{geometry:{primitive:"plane",width:75,height:75},rotation:{x:-90,y:0,z:0},material:{src:"url(https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v1.16.3/assets/grid.png)",repeat:"75 75"}},mappings:{width:"geometry.width",height:"geometry.height",src:"material.src"}})},{}],39:[function(e,t,r){"use strict";var i=e("../../lib/hex-grid.min.js"),n=e("../../lib/default-hex-grid");t.exports.Primitive=AFRAME.registerPrimitive("a-hexgrid",{defaultComponents:{hexgrid:{}},mappings:{src:"hexgrid.src"}}),t.exports.Component=AFRAME.registerComponent("hexgrid",{dependencies:["material"],schema:{src:{type:"asset"}},init:function(){var e=this,t=this.data;t.src?fetch(t.src).then(function(e){return e.json()}).then(function(t){return e.addMesh(t)}):this.addMesh(n)},addMesh:function(e){var t=new i.HexGrid;t.fromJSON(e);var r=new i.Board(t);r.generateTilemap(),this.el.setObject3D("mesh",r.group),this.addMaterial()},addMaterial:function(){var e=(this.el.components.material||{}).material;e&&this.el.object3D.traverse(function(t){t.isMesh&&(t.material=e)})},remove:function(){this.el.removeObject3D("mesh")}})},{"../../lib/default-hex-grid":7,"../../lib/hex-grid.min.js":9}],40:[function(e,t,r){"use strict";t.exports.Primitive=AFRAME.registerPrimitive("a-ocean",{defaultComponents:{ocean:{},rotation:{x:-90,y:0,z:0}},mappings:{width:"ocean.width",depth:"ocean.depth",density:"ocean.density",amplitude:"ocean.amplitude",amplitudeVariance:"ocean.amplitudeVariance",speed:"ocean.speed",speedVariance:"ocean.speedVariance",color:"ocean.color",opacity:"ocean.opacity"}}),t.exports.Component=AFRAME.registerComponent("ocean",{schema:{width:{default:10,min:0},depth:{default:10,min:0},density:{default:10},amplitude:{default:.1},amplitudeVariance:{default:.3},speed:{default:1},speedVariance:{default:2},color:{default:"#7AD2F7",type:"color"},opacity:{default:.8}},play:function(){var e=this.el,t=this.data,r=e.components.material,i=new THREE.PlaneGeometry(t.width,t.depth,t.density,t.density);i.mergeVertices(),this.waves=[];for(var n,o=0,a=i.vertices.length;o<a;o++)n=i.vertices[o],this.waves.push({z:n.z,ang:Math.random()*Math.PI*2,amp:t.amplitude+Math.random()*t.amplitudeVariance,speed:(t.speed+Math.random()*t.speedVariance)/1e3});r||((r={}).material=new THREE.MeshPhongMaterial({color:t.color,transparent:t.opacity<1,opacity:t.opacity,shading:THREE.FlatShading})),this.mesh=new THREE.Mesh(i,r.material),e.setObject3D("mesh",this.mesh)},remove:function(){this.el.removeObject3D("mesh")},tick:function(e,t){if(t){for(var r,i,n=this.mesh.geometry.vertices,o=0;r=n[o];o++)i=this.waves[o],r.z=i.z+Math.sin(i.ang)*i.amp,i.ang+=i.speed*t;this.mesh.geometry.verticesNeedUpdate=!0}}})},{}],41:[function(e,t,r){"use strict";t.exports.Primitive=AFRAME.registerPrimitive("a-tube",{defaultComponents:{tube:{}},mappings:{path:"tube.path",segments:"tube.segments",radius:"tube.radius","radial-segments":"tube.radialSegments",closed:"tube.closed"}}),t.exports.Component=AFRAME.registerComponent("tube",{schema:{path:{default:[]},segments:{default:64},radius:{default:1},radialSegments:{default:8},closed:{default:!1}},init:function(){var e=this.el,t=this.data,r=e.components.material;if(t.path.length){var i=new THREE.CatmullRomCurve3(t.path.map(function(e){return e=e.split(" "),new THREE.Vector3(Number(e[0]),Number(e[1]),Number(e[2]))})),n=new THREE.TubeGeometry(i,t.segments,t.radius,t.radialSegments,t.closed);r||((r={}).material=new THREE.MeshPhongMaterial),this.mesh=new THREE.Mesh(n,r.material),this.el.setObject3D("mesh",this.mesh)}else console.error("[a-tube] `path` property expected but not found.")},update:function(e){Object.keys(e).length&&(this.remove(),this.init())},remove:function(){this.mesh&&this.el.removeObject3D("mesh")}})},{}],42:[function(e,t,r){"use strict";e("./a-grid"),e("./a-hexgrid"),e("./a-ocean"),e("./a-tube")},{"./a-grid":38,"./a-hexgrid":39,"./a-ocean":40,"./a-tube":41}]},{},[1]),function(){var e;e="undefined"!=typeof window?window:self;let t=0;var r=function(){++t>3?console.log("VRFunc.js: integrateTick, integrateCount=",t,", too many times"):e.AFRAME&&e.THREE?(console.log("VRFunc.js: integrateTick, scope=",e,t),function(){AFRAME.registerComponent("initvrscene",{init:function(){this.el}}),AFRAME.registerComponent("cursor-listener",{init:function(){this.el.addEventListener("click",function(e){if(e.preventDefault(),e.target==e.currentTarget&&this.object3D.behav){let e=!1;for(let t=0;t<this.object3D.behav.length;t++)"CloseAndResetChildren"==this.object3D.behav[t].simple_behav&&(e=!0);for(let t=0;t<this.object3D.behav.length;t++)"CloseAndResetChildren"!=this.object3D.behav[t].simple_behav&&vrController.triggerEvent(this.object3D.behav[t],e)}},!1),this.el.addEventListener("fusing",function(e){if(e.preventDefault(),e.target==e.currentTarget&&this.object3D.behav){delay=1e3*this.object3D.behav[0].display+5;let e=document.getElementById("cursor_main");e.setAttribute("cursor","fuseTimeout:"+delay),e.setAttribute("animation__mouseenter","dur: "+delay)}},!1)}});var e=function(){this.GLRenderer=null,this.scene2D=null,this.camera2D=null,this.light=null,this.vrScene=null,this.publishVRProjs=null,this.VRSceneResult=null,this.makarVRscenes={},this.makarObjects=[],this.FUNCTION_ENABLED=!1,this.clock=new THREE.Clock,this.delta=this.time=0};e.prototype.setupFunction=function(){if(!this.FUNCTION_ENABLED){this.FUNCTION_ENABLED=!0;var e=this;this.loadAssets=function(t){let r=document.createElement("a-assets");r.setAttribute("id","makarAssets"),r.setAttribute("timeout","100"),e.vrScene.appendChild(r),e.makarObjects.push(r)},this.loadScene=function(t,r){if(null==e.VRSceneResult[t].scenes[r])console.log("VRFunc.js: VRController: _loadScene: error, [valid sceneIndex]=",e.VRSceneResult[t].scenes.length,r);else{if(e.makarObjects){for(let t=0;t<e.makarObjects.length;t++){e.makarObjects[t].remove()}e.makarObjects.length=0}e.loadAssets(),e.loadSceneObjects(t,r),setTimeout(function(){e.loadSky(t,r)},500)}},this.loadSky=function(t,r){switch(e.VRSceneResult[t].scenes[r].scene_skybox_main_type){case"spherical_image":case"image":var i=document.createElement("a-sky");"DefaultResource/Spherical_Image/SphericalImage.png"==e.VRSceneResult[t].scenes[r].scene_skybox_url?i.setAttribute("material",{src:"https://s3-ap-northeast-1.amazonaws.com/makar.webar.defaultobject/makar_default_objects/2D/Spherical_Image/SphericalImage.png"}):i.setAttribute("material",{src:e.VRSceneResult[t].scenes[r].scene_skybox_url}),i.setAttribute("radius",2e3),i.setAttribute("id","sky"),e.vrScene.appendChild(i),e.makarObjects.push(i);break;case"spherical_video":let n=document.getElementById("makarAssets");i=document.createElement("a-videosphere");let o=document.createElement("video");o.src=e.VRSceneResult[t].scenes[r].scene_skybox_url,o.playsInline=!0,o.autoplay=!0,o.setAttribute("crossorigin","anonymous"),o.setAttribute("id",e.VRSceneResult[t].scenes[r].scene_id),o.setAttribute("autoplay","true"),n.appendChild(o),i.setAttribute("src","#"+e.VRSceneResult[t].scenes[r].scene_id),i.setAttribute("radius",2e3),i.setAttribute("id","sky"),e.vrScene.appendChild(i),e.makarObjects.push(i),console.log("VRFunc.js: _loadSky: aSky=",i)}},this.loadSceneObjects=function(t,r){if(!userProjResDict)return console.log("%cVRFunc.js: _loadSceneObjects: error userProjResDict not exist, return -1","color:red"),-1;let i=e.VRSceneResult[t].scenes[r].scene_objs;for(let n=0;n<i.length;n++){let o=(new THREE.Vector3).fromArray(i[n].transform[0].split(",").map(function(e){return Number(e)})),a=(new THREE.Vector3).fromArray(i[n].transform[1].split(",").map(function(e){return Number(e)})),s=(new THREE.Vector3).fromArray(i[n].transform[2].split(",").map(function(e){return Number(e)}));switch(i[n].main_type){case"camera":let l=document.getElementById("camera_cursor");a.multiply(new THREE.Vector3(-1,-1,0)).add(new THREE.Vector3(0,180,0)),l.setAttribute("rotation",a);break;case"image":let c=i[n];userProjResDict[c.res_id]?c.res_url==userProjResDict[c.res_id].res_url?e.loadTexture(c,o,a,s):console.log("%cVRFunc.js: _loadSceneObjects: image res_url is different from userProjResDict!","color:red",n,c,userProjResDict[c.res_id]):console.log("%cVRFunc.js: _loadSceneObjects: image res_id not exist!","color:red",n);break;case"audio":"mp3"!=i[n].sub_type&&"wav"!=i[n].sub_type&&"ogg"!=i[n].sub_type||!i[n].res_url||e.loadAudio(i[n]);break;case"video":"mp4"==i[n].sub_type&&i[n].res_url&&e.loadVideo(i[n],o,a,s);break;case"model":userProjResDict[i[n].res_id]?i[n].res_url==userProjResDict[i[n].res_id].res_url?setTimeout(function(){e.loadGLTFModel(i[n],o,a,s)},1):i[n].res_url_fbx==userProjResDict[i[n].res_id].res_url_fbx?setTimeout(function(){e.loadFBXModel(i[n],o,a,s)},1):console.log("%cVRFunc.js: _loadSceneObjects: model res_url_fbx is different from userProjResDict!","color:red",n,c,userProjResDict[c.res_id]):console.log("%cVRFunc.js: _loadSceneObjects: model res_id not exist!","color:red",n);break;default:console.log("VRFunc.js: _loadSceneObjects: default",n,e.VRSceneResult[t].scenes[r].scene_objs[n])}}},this.loadTexture=function(t,r,n,o){(new THREE.TextureLoader).load(t.res_url,function(a){let s=t.res_url.split(".").length,l=t.res_url.split(".")[s-1];if("jpg"==l||"jpeg"==l||"png"==l)var c=document.createElement("a-plane");else if("gif"==l)c=document.createElement("a-entity");c.setAttribute("id",t.obj_id),c.setAttribute("makarVRIndex",i),c.setAttribute("cursor-listener",!0),"jpg"!=l&&"jpeg"!=l&&"png"!=l||c.setAttribute("src",t.res_url);let u=!1;if(t.behav)for(let e=0;e<t.behav.length;e++)"TransparentVideo"!=t.behav[e].simple_behav&&"TransparentImage"!=t.behav[e].simple_behav||(u=!0,chromaKey=t.behav[e].chromakey,slope=t.behav[e].slope,threshold=t.behav[e].threshold);if(u){let e=chromaKey.split(","),r=new THREE.Color(parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]));"jpg"==l||"jpeg"==l||"png"==l?c.setAttribute("material","shader: chromaKey; color: #"+r.getHexString()+";transparent: true; _slope: "+parseFloat(slope)+"; _threshold: "+parseFloat(threshold)+";"):"gif"==l&&(c.setAttribute("geometry","primitive: plane"),c.setAttribute("material","shader:gif;  src: url("+t.res_url+"); opacity: 1"))}else"jpg"==l||"jpeg"==l||"png"==l?c.setAttribute("material","side:double; opacity: 1.0; transparent: true; "):"gif"==l&&(c.setAttribute("geometry","primitive: plane"),c.setAttribute("material","shader:gif;  src: url("+t.res_url+"); opacity: 1"));if(t.behav?1==t.behav.length&&u?c.setAttribute("class","unclickable"):c.setAttribute("class","clickable"):c.setAttribute("class","unclickable"),e.setTransform(c,r,n,o),e.makarObjects.push(c),c.addEventListener("loaded",function(e){if(e.target==e.currentTarget){console.log("VRFunc.js: loadTexture: loaded target same"),c.object3D.children[0].scale.set(.01*a.image.width,.01*a.image.height,1);let e=new THREE.Vector3;e.set(0,Math.PI,0),c.object3D.children[0].rotation.setFromVector3(e),c.object3D.makarObject=!0,t.behav&&(c.object3D.behav=t.behav)}else console.log("VRFunc.js: loadTexture: loaded target different")}),t.obj_parent_id){c.setAttribute("visible",!1),c.setAttribute("class","unclickable");let e=setInterval(function(){let r=document.getElementById(t.obj_parent_id);r&&r.object3D.children.length>0&&(r.appendChild(c),window.clearInterval(e))},1)}else e.vrScene.appendChild(c);console.log("VRFunc.js: VRController: loadTexture,obj=",t)},void 0,function(e){console.error("An error happened. loadTexture, err=",e)})},this.loadGLTFModel=function(t,r,n,o){let a=document.getElementById("makarAssets"),s=document.createElement("a-asset-item");s.setAttribute("id",t.obj_id+"_"+t.res_id),s.setAttribute("src",t.res_url),a.appendChild(s);let l=document.createElement("a-entity");if(t.res_url){if(l.setAttribute("gltf-model","#"+t.obj_id+"_"+t.res_id),l.setAttribute("animation-mixer",""),t.behav?l.setAttribute("class","clickable"):l.setAttribute("class","unclickable"),l.setAttribute("id",t.obj_id),l.setAttribute("makarVRIndex",i),l.setAttribute("cursor-listener",!0),e.setTransform(l,r,n,o),e.makarObjects.push(l),t.obj_parent_id){l.setAttribute("visible",!1),l.setAttribute("class","unclickable");let e=setInterval(function(){let r=document.getElementById(t.obj_parent_id);r&&r.object3D.children.length>0&&(r.appendChild(l),window.clearInterval(e))},1)}else e.vrScene.appendChild(l);l.addEventListener("model-loaded",function(e){e.target==e.currentTarget&&(l.object3D.makarObject=!0,t.behav&&(l.object3D.behav=t.behav))})}},this.loadFBXModel=function(t,r,n,o){let a=document.createElement("a-entity");if(t.res_url_fbx){if(a.setAttribute("fbx-model","src:"+t.res_url_fbx),a.setAttribute("animation-mixer",""),t.behav?a.setAttribute("class","clickable"):a.setAttribute("class","unclickable"),a.setAttribute("id",t.obj_id),a.setAttribute("makarVRIndex",i),a.setAttribute("cursor-listener",!0),e.setTransform(a,r,n,o),e.makarObjects.push(a),t.obj_parent_id){a.setAttribute("visible",!1),a.setAttribute("class","unclickable");let e=setInterval(function(){let r=document.getElementById(t.obj_parent_id);r&&r.object3D.children.length>0&&(r.appendChild(a),window.clearInterval(e))},1)}else e.vrScene.appendChild(a);a.addEventListener("model-loaded",function(e){e.target==e.currentTarget&&(a.object3D.makarObject=!0,t.behav&&(a.object3D.behav=t.behav))})}},this.loadAudio=function(t){console.log("audio loaded");let r=document.getElementById("makarAssets"),i=document.createElement("audio");i.setAttribute("id",t.obj_id+"_"+t.res_id),i.setAttribute("src",t.res_url),i.setAttribute("crossorigin","anonymous"),i.setAttribute("loop",!0),i.setAttribute("preload","auto"),r.appendChild(i),i.onloadedmetadata=function(){let r=document.createElement("a-entity");if(r.setAttribute("sound","src: #"+t.obj_id+"_"+t.res_id+"; autoplay: true; loop: true; volume: 1; positional: false"),r.setAttribute("id",t.obj_id),e.makarObjects.push(r),t.obj_parent_id){r.setAttribute("sound","autoplay: false"),r.setAttribute("visible",!1),r.setAttribute("class","unclickable");let e=setInterval(function(){let i=document.getElementById(t.obj_parent_id);i&&i.object3D.children.length>0&&(i.appendChild(r),window.clearInterval(e))},1)}else e.vrScene.appendChild(r);r.addEventListener("loaded",function(e){e.target==e.currentTarget&&(r.object3D.makarObject=!0,t.behav&&(r.object3D.behav=t.behav))})}},this.loadVideo=function(t,r,i,n){let o=document.getElementById("makarAssets");var a;(a=document.createElement("video")).src=t.res_url,a.playsInline=!0,a.autoplay=!0,a.loop=!0,a.setAttribute("crossorigin","anonymous"),a.setAttribute("id",t.obj_id+"_"+t.res_id),o.appendChild(a),window.Browser&&(null!=window.Browser.name&&"safari"!=window.Browser.name||(a.muted=!0)),a.onloadedmetadata=function(){var o,s;a.videoWidth>=a.videoHeight?(o=1,s=1*a.videoHeight/a.videoWidth):(o=1*a.videoWidth/a.videoHeight,s=1);let l=document.createElement("a-video"),c=!1;if(t.behav)for(let e=0;e<t.behav.length;e++)"TransparentVideo"==t.behav[e].simple_behav&&(c=!0,chromaKey=t.behav[e].chromakey,slope=t.behav[e].slope,threshold=t.behav[e].threshold);if(c){let e=chromaKey.split(",");var u=new THREE.Color(parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]));l.setAttribute("material","shader: chromaKey; color: #"+u.getHexString()+";transparent: true; _slope: "+parseFloat(slope)+"; _threshold: "+parseFloat(threshold)+";")}else l.setAttribute("material","side:double; opacity: 1.0; transparent: true; ");if(t.behav?1==t.behav.length&&c?l.setAttribute("class","unclickable"):l.setAttribute("class","clickable"):l.setAttribute("class","unclickable"),l.setAttribute("cursor-listener",!0),l.setAttribute("id",t.obj_id),l.setAttribute("src","#"+t.obj_id+"_"+t.res_id),e.setTransform(l,r,i,n),l.addEventListener("loaded",function(e){if(e.target==e.currentTarget){l.object3D.children[0].scale.multiply(new THREE.Vector3(o,s,1));let e=new THREE.Vector3;e.set(0,Math.PI,0),l.object3D.children[0].rotation.setFromVector3(e),l.object3D.makarObject=!0,t.behav&&(l.object3D.behav=t.behav)}}),e.makarObjects.push(l),t.obj_parent_id){l.setAttribute("visible",!1),l.setAttribute("class","unclickable"),a.autoplay=!1;let e=setInterval(function(){let r=document.getElementById(t.obj_parent_id);r&&r.object3D.children.length>0&&(r.appendChild(l),window.clearInterval(e))},1)}else e.vrScene.appendChild(l)}},this.setTransform=function(e,t,r,i){t.multiply(new THREE.Vector3(-1,1,1)),e.setAttribute("position",t),r.multiply(new THREE.Vector3(1,-1,-1)),e.setAttribute("rotation",r),e.setAttribute("scale",i)},this.checkAnimation=function(e,t){e.mixer&&e.mixer.update(t),e.animationSlices&&e.animationSlices[0].index&&e.animationSlices[e.animationSlices[0].index]&&(e.mixer._actions[0].time>e.animationSlices[e.animationSlices[0].index].timeEnd||e.mixer._actions[0].time<e.animationSlices[e.animationSlices[0].index].timeStart)&&(e.mixer._actions[0].time=e.animationSlices[e.animationSlices[0].index].timeStart)}}},e.prototype.triggerEvent=function(e,t,r,i,n){if(this.FUNCTION_ENABLED){switch(e.simple_behav){case"PhoneCall":console.log("VRFunc.js: triggerEvent: PhoneCall: event=",e);let r=window.document.getElementById("phoneCall");r.href="tel:"+e.phone,r.click();break;case"SendEmail":console.log("VRFunc.js: triggerEvent: SendEmail: event=",e);let i=window.document.getElementById("sendEmail");i.href="mailto:"+e.mail_to,i.click();break;case"OpenWebPage":console.log("VRFunc.js: triggerEvent: OpenWebPage: event=",e,e.url);let n=window.document.getElementById("openWebBrowser");n.href=e.url,n.click(),console.log("VRFunc.js: triggerEvent: OpenWebPage: webTag=",n);break;case"SceneChange":console.log("VRFunc.js: triggerEvent: SceneChange: event=",e),sceneID=e.scene_id;for(let e=0;e<VRSceneResult.length;e++)for(let t=0;t<VRSceneResult[e].scenes.length;t++)VRSceneResult[e].scenes[t].scene_id==sceneID&&window.activeVRScenes(e,t);break;case"ShowImage":console.log("VRFunc.js: triggerEvent: ShowImage: event=",e),obj_id=e.obj_id,target=document.getElementById(obj_id),target.getAttribute("visible")?(target.setAttribute("visible",!1),target.setAttribute("class","unclickable"),target.object3D.traverse(function(e){if("Group"==e.type){if("a-video"==e.el.localName){let t=e.el.getAttribute("src");if(null!=t){t=t.split("#").pop();let e=document.getElementById(t);e instanceof HTMLElement&&e.pause()}}e.el.getAttribute("sound")&&e.el.components.sound.pauseSound()}}),t&&target.object3D.traverse(function(e){"Group"==e.type&&(e.el.setAttribute("visible",!1),e.el.setAttribute("class","unclickable"))})):(target.setAttribute("visible",!0),target.object3D.behav&&target.setAttribute("class","clickable"),target.object3D.traverse(function(e){if("Group"==e.type&&e.el.getAttribute("visible")){if("a-video"==e.el.localName){let t=e.el.getAttribute("src");if(null!=t){t=t.split("#").pop();let e=document.getElementById(t);e instanceof HTMLElement&&e.play()}}e.el.getAttribute("sound")&&e.el.components.sound.playSound()}}));break;case"ShowModel":console.log("VRFunc.js: triggerEvent: ShowModel: event=",e),obj_id=e.obj_id,target=document.getElementById(obj_id),target.getAttribute("visible")?(target.setAttribute("visible",!1),target.setAttribute("class","unclickable"),target.object3D.traverse(function(e){if("Group"==e.type){if("a-video"==e.el.localName){let t=e.el.getAttribute("src");if(null!=t){t=t.split("#").pop();let e=document.getElementById(t);e instanceof HTMLElement&&e.pause()}}e.el.getAttribute("sound")&&e.el.components.sound.pauseSound()}}),t&&target.object3D.traverse(function(e){"Group"==e.type&&(e.el.setAttribute("visible",!1),e.el.setAttribute("class","unclickable"))})):(target.setAttribute("visible",!0),target.object3D.behav&&target.setAttribute("class","clickable"),target.object3D.traverse(function(e){if("Group"==e.type&&e.el.getAttribute("visible")){if("a-video"==e.el.localName){let t=e.el.getAttribute("src");if(null!=t){t=t.split("#").pop();let e=document.getElementById(t);e instanceof HTMLElement&&e.play()}}e.el.getAttribute("sound")&&e.el.components.sound.playSound()}}));break;case"PlayMusic":console.log("VRFunc.js: triggerEvent: PlayMusic: event=",e),obj_id=e.obj_id,target=document.getElementById(obj_id),target.getAttribute("visible")?(target.setAttribute("visible",!1),target.setAttribute("class","unclickable"),target.components.sound.pauseSound()):(target.setAttribute("visible",!0),target.object3D.behav&&target.setAttribute("class","clickable"),target.components.sound.playSound());break;case"ShowVideo":if(console.log("VRFunc.js: triggerEvent: ShowVideo: event=",e),obj_id=e.obj_id,target=document.getElementById(obj_id),target.getAttribute("visible")){target.setAttribute("visible",!1),target.setAttribute("class","unclickable");let e=target.getAttribute("src");if(null!=e){e=e.split("#").pop();let t=document.getElementById(e);t instanceof HTMLElement&&t.pause()}target.object3D.traverse(function(e){if("Group"==e.type){if("a-video"==e.el.localName){let t=e.el.getAttribute("src");if(null!=t){t=t.split("#").pop();let e=document.getElementById(t);e instanceof HTMLElement&&e.pause()}}e.el.getAttribute("sound")&&e.el.components.sound.pauseSound()}}),t&&target.object3D.traverse(function(e){"Group"==e.type&&(e.el.setAttribute("visible",!1),e.el.setAttribute("class","unclickable"))})}else{target.setAttribute("visible",!0);let e=target.getAttribute("src");if(null!=e){e=e.split("#").pop();let t=document.getElementById(e);t instanceof HTMLElement&&t.play()}target.object3D.behav&&target.setAttribute("class","clickable"),target.object3D.traverse(function(e){if("Group"==e.type&&e.el.getAttribute("visible")){if("a-video"==e.el.localName){let t=e.el.getAttribute("src");if(null!=t){t=t.split("#").pop();let e=document.getElementById(t);e instanceof HTMLElement&&e.play()}}e.el.getAttribute("sound")&&e.el.components.sound.playSound()}})}break;default:console.log("VRFunc.js: triggerEvent: default: event=",e)}}},e.prototype.update=function(){if(this.FUNCTION_ENABLED){var e=this;this.delta=1*this.clock.getDelta(),this.time=1*this.clock.elapsedTime;for(let t=0;t<e.makarObjects.length;t++){let r=e.makarObjects[t];r.object3D&&r.object3D.makarObject&&r.object3D.children&&r.object3D.children[0]&&e.checkAnimation(r.object3D.children[0],this.delta)}setTimeout(function(){e.update()},this.vrScene.delta)}};var t=function(){if("undefined"!=typeof checkHost){if("yet"==checkHost)setTimeout(t,50);else if("correct"==checkHost)console.log("VRFunc.js: _checkHost_tick correct");else if("fail"==checkHost){for(;document.body.firstChild;)document.body.removeChild(document.body.firstChild);var e=document.createElement("div");e.innerHTML="<br>The host of webVR seems unauthorized,<br> please contact MIFLY ",e.style.fontSize="18px",e.style.margin="5px",e.style.fontWeight="700",document.body.append(e)}}else console.log("VRFunc.js: checkHost = undefined, something ERROR.")};t(),Module.checkMifly(),window.showVRProjList=function(){let e,t=window.serverUrl,r=document.getElementById("uid");e=r?r.value:window.makarID,document.getElementById("panel").className="",getVRSceneByUserID(t,e,function(e){let t=document.getElementById("projs"),r=t.rows.proj_snapshot,i=t.rows.proj_name,n=r.children.length,o=i.children.length;for(let e=0;e<n;e++)r.deleteCell(0);for(let e=0;e<o;e++)i.deleteCell(0);let a=e;if("string"==typeof e)console.log("VRFunc.js: _showVRProjList: _getVRSceneByUserID: callback, str=",e),document.getElementById("pUserInfo").innerHTML=a,document.getElementById("pUserInfo").style.color="red";else{document.getElementById("pUserInfo").innerHTML="",document.getElementById("pUserInfo").style.color="white";for(let t=0;t<e.length;t++){i.insertCell(t).innerHTML=window.publishVRProjs.result[t].proj_name;let e=r.insertCell(t),n=document.createElement("img");n.src=window.publishVRProjs.result[t].snapshot_url,n.width=150,n.height=150;let o=function(e){document.getElementById("home").style.display="none",document.getElementById("panel").className="collapsed",activeVRScenes(t)};n.onclick=function(){o(this)},e.appendChild(n)}}})},window.activeVRScenes=function(r,i=0){let n=document.getElementsByTagName("video");if(n.length>0)for(let e=0;e<n.length;e++)n[e].pause(),n[e].removeAttribute("src"),n[e].load();document.getElementById("vrDiv")&&document.getElementById("vrDiv").remove();let o,a=document.createElement("a-scene");a.setAttribute("id","vrscene"),a.setAttribute("embedded",""),(o=document.createElement("div")).style.position="relative",o.setAttribute("id","vrDiv"),o.style.width=document.documentElement.clientWidth+"px",o.style.height=Math.round(document.documentElement.clientHeight-56)+"px",o.style.top="56px",window.onresize=function(){o.style.width=document.documentElement.clientWidth+"px",o.style.height=Math.round(document.documentElement.clientHeight-56)+"px"},document.body.appendChild(o),o.appendChild(a),a.hasLoaded?l():a.addEventListener("loaded",l),a.addEventListener("enter-vr",function(){}),a.addEventListener("renderstart",function(){});let s=new e;function l(){function e(e){document.getElementById("panel").className="collapsed"}a.children[2].attributes,a.canvas.addEventListener("touchstart",e,!1),a.canvas.addEventListener("mousedown",e,!1),s.setupFunction();let n=new THREE.Vector2;a.renderer.getSize(n),vrscene.renderer.sortObjects=!0,s.vrScene=a;let l=document.createElement("a-entity");l.setAttribute("id","cursor_main"),l.setAttribute("cursor","fuse: true; fuseTimeout: 5"),l.setAttribute("raycaster","objects: .clickable"),l.setAttribute("animation__mouseenter","property: geometry.thetaLength; delay: 5; startEvents: mouseenter; dur: 5; from: 0.5; to: 360"),l.setAttribute("animation__mouseleave","property: geometry.thetaLength; startEvents: mouseleave; dur: 100; from: 360; to: 0.5"),l.setAttribute("geometry","primitive: ring; radiusOuter: 0.04; radiusInner: 0.02; thetaLength: 360; thetaStart: 0;"),l.setAttribute("position","0 0 -1"),l.setAttribute("material","color: red; shader: flat; ");let c=document.createElement("a-entity");c.setAttribute("id","cursor_default"),c.setAttribute("geometry","primitive: ring; radiusOuter: 0.04; radiusInner: 0.02; thetaLength: 360; thetaStart: 0;"),c.setAttribute("position","0 0 -1.001"),c.setAttribute("material","color: #2ADD2A; shader: flat; ");let u=document.createElement("a-camera");u.setAttribute("look-controls",""),u.setAttribute("id","aCamera"),u.setAttribute("position",{x:0,y:0,z:0}),u.setAttribute("fov",60),u.setAttribute("near",.3),u.setAttribute("far",1e4),u.appendChild(l),u.appendChild(c);let d=document.createElement("a-entity");d.setAttribute("id","camera_cursor"),d.setAttribute("position",{x:0,y:0,z:0}),d.setAttribute("rotation","0 0 0"),d.appendChild(u),a.appendChild(d);let h=document.createElement("a-light");h.setAttribute("id","lightEntity"),h.setAttribute("type","ambient"),h.setAttribute("color","#fff"),h.setAttribute("ground-color","#fff"),h.setAttribute("intensity",2),a.appendChild(h),a.addEventListener("camera-set-active",function(e){o=document.getElementById("vrDiv"),a.camera.aspect=o.clientWidth/o.clientHeight,a.camera.updateProjectionMatrix()}),s.loadScene(r,i),t(),Module.checkMifly()}s.VRSceneResult=VRSceneResult,s.publishVRProjs=publishVRProjs,window.vrController=s}}(),window.addEventListener("keyup",function(e){13===e.keyCode&&e.preventDefault()})):setTimeout(function(){r(t)},500)};"undefined"!=typeof window&&r(t),console.log("VRFunc done, window innerWH",window.innerWidth,window.innerHeight)}();